!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.apgl=e():t.apgl=e()}(this,(()=>(()=>{var t={49:t=>{t.exports="varying highp vec2 v_tex_coord;\n\nuniform sampler2D u_sampler;\nuniform lowp vec3 u_bb_color;\n\nvoid main() {\n    lowp vec4 tex_color = texture2D(u_sampler, v_tex_coord);\n    gl_FragColor = vec4(u_bb_color, tex_color.a); // mix(vec4(1.0, 0.0, 0.0, 0.5), vec4(u_bb_color, 1.0), tex_color.a);\n}"},955:t=>{t.exports="uniform mat4 u_matrix;\n\nattribute vec3 a_pos;    // Has position, zoom, and corner info\nattribute vec2 a_tex_coord;\nuniform lowp float u_bb_size;\nuniform lowp float u_map_aspect;\nuniform lowp float u_zoom;\nuniform highp float u_map_bearing;\nuniform lowp float u_bb_width;  // Normalized by texture width\nuniform lowp float u_bb_height; // Normalized by texture height\nuniform highp float u_bb_mag_bin_size;\n//uniform highp float u_bb_max_mag;\nuniform highp float u_bb_mag_wrap;\n\nuniform sampler2D u_u_sampler;\nuniform sampler2D u_v_sampler;\n\nvarying highp vec2 v_tex_coord;\n\nmat4 scalingMatrix(float x_scale, float y_scale, float z_scale) {\n    return mat4(x_scale, 0.0,     0.0,     0.0,\n                0.0,     y_scale, 0.0,     0.0,\n                0.0,     0.0,     z_scale, 0.0,\n                0.0,     0.0,     0.0,     1.0);\n}\n\nmat4 rotationZMatrix(float angle) {\n    float s = sin(angle);\n    float c = cos(angle);\n\n    return mat4( c,  s,  0., 0.,\n                -s,  c,  0., 0.,\n                 0., 0., 1., 0.,\n                 0., 0., 0., 1.);\n}\n\nmat4 rotationXMatrix(float angle) {\n    float s = sin(angle);\n    float c = cos(angle);\n\n    return mat4( 1.,  0., 0., 0.,\n                 0.,  c,  s,  0.,\n                 0., -s,  c,  0.,\n                 0.,  0., 0., 1.);\n}\n\nvoid main() {\n    vec4 pivot_pos = u_matrix * vec4(a_pos.xy, 0.0, 1.0);\n    highp float zoom_corner = a_pos.z;\n    lowp float min_zoom = floor(zoom_corner / 4.0);\n    lowp float corner = mod(zoom_corner, 4.0);\n\n    highp float u = texture2D(u_u_sampler, a_tex_coord).r;\n    highp float v = texture2D(u_v_sampler, a_tex_coord).r;\n\n    lowp float bb_aspect = u_bb_width / u_bb_height;\n    lowp float ang = atan(v, u) - 3.141592654 / 2.0;\n    highp float mag = length(vec2(u, v));\n    mag = floor(mag / u_bb_mag_bin_size + 0.5) * u_bb_mag_bin_size;\n\n    vec4 offset = vec4(0.0, 0.0, 0.0, 0.0);\n    vec2 texcoord = vec2(0.0, 0.0);\n    \n    if (u_zoom >= min_zoom) {\n        vec2 tex_loc = vec2(mod(mag, u_bb_mag_wrap) / u_bb_mag_bin_size * u_bb_width, floor(mag / u_bb_mag_wrap) * u_bb_height);\n\n        if (corner < 0.5) {\n            offset = vec4(-u_bb_size, u_bb_size, 0., 0.);\n            texcoord = tex_loc;\n        }\n        else if (corner < 1.5) {\n            offset = vec4(u_bb_size, u_bb_size, 0., 0.);\n            texcoord = tex_loc + vec2(u_bb_width, 0.0);\n        }\n        else if (corner < 2.5) {\n            offset = vec4(-u_bb_size, -u_bb_size * (2. / bb_aspect - 1.), 0., 0.);\n            texcoord = tex_loc + vec2(0.0, u_bb_height);\n        }\n        else if (corner < 3.5) {\n            offset = vec4(u_bb_size, -u_bb_size * (2. / bb_aspect - 1.), 0., 0.);\n            texcoord = tex_loc + vec2(u_bb_width, u_bb_height);\n        }\n\n        mat4 barb_rotation = rotationZMatrix(ang + radians(u_map_bearing));\n        mat4 map_stretch_matrix = scalingMatrix(1.0, 1. / u_map_aspect, 1.0);\n        offset = map_stretch_matrix * barb_rotation * offset;\n    }\n\n    gl_Position = pivot_pos + offset;\n    v_tex_coord = texcoord;\n}"},884:t=>{t.exports="#extension GL_OES_standard_derivatives : enable\n#define MAX_N_CONTOURS 40\n\nvarying highp vec2 v_tex_coord;\nvarying highp float v_grid_cell_size;\nvarying highp float v_map_scale_fac;\n\nuniform sampler2D u_fill_sampler;\nuniform highp float u_contour_interval;\nuniform highp float u_contour_levels[MAX_N_CONTOURS];\nuniform int u_num_contours;\nuniform lowp float u_line_cutoff;\nuniform lowp vec3 u_color;\nuniform lowp vec2 u_step_size;\nuniform lowp float u_zoom_fac;\n\nvoid main() {\n    highp float field_val = texture2D(u_fill_sampler, v_tex_coord).r;\n\n    // Find the gradient magnitude of the grid (the y component divides by 2 to cheat for high latitudes)\n    lowp vec2 ihat = vec2(u_step_size.x, 0.0);\n    lowp vec2 jhat = vec2(0.0, u_step_size.y);\n    highp float fv_xp1 = texture2D(u_fill_sampler, v_tex_coord + ihat).r;\n    highp float fv_xm1 = texture2D(u_fill_sampler, v_tex_coord - ihat).r;\n    highp float fv_yp1 = texture2D(u_fill_sampler, v_tex_coord + jhat).r;\n    highp float fv_ym1 = texture2D(u_fill_sampler, v_tex_coord - jhat).r;\n    highp float fwidth_field = sqrt(((fv_xp1 - fv_xm1) * (fv_xp1 - fv_xm1) + (fv_yp1 - fv_ym1) * (fv_yp1 - fv_ym1)) / (5e5 * v_grid_cell_size));\n\n    //gl_FragColor = vec4(fwidth_field, fwidth_field, fwidth_field, 1.0);\n    lowp float plot_val;\n\n    if (u_num_contours > 0) {\n        highp float min_contour_diff = u_contour_levels[1] - u_contour_levels[0];\n        bool assigned_contour = false;\n        highp float low_contour;\n        highp float high_contour;\n        highp float highest_contour;\n\n        for (int ncnt = 0; ncnt < MAX_N_CONTOURS; ncnt++) {\n            if (ncnt >= u_num_contours) { break; }\n\n            min_contour_diff = min(min_contour_diff, u_contour_levels[ncnt + 1] - u_contour_levels[ncnt]);\n\n            if (u_contour_levels[ncnt] < field_val && field_val < u_contour_levels[ncnt + 1]) {\n                assigned_contour = true;\n\n                low_contour = u_contour_levels[ncnt];\n                high_contour = u_contour_levels[ncnt + 1];\n            }\n\n            highest_contour = u_contour_levels[ncnt];\n        }\n\n        if (!assigned_contour) {\n            if (field_val < u_contour_levels[0]) {\n                plot_val = (u_contour_levels[0] - field_val) / min_contour_diff;\n            }\n            else if (field_val > highest_contour) {\n                plot_val = (field_val - highest_contour) / min_contour_diff;\n            }\n        }\n        else {\n            plot_val = min(field_val - low_contour, high_contour - field_val) / min_contour_diff;\n        }\n    }\n    else {\n        plot_val = fract(field_val / u_contour_interval);\n        if (plot_val > 0.5) plot_val = 1.0 - plot_val;\n    }\n\n    plot_val = plot_val / (max(0.001, fwidth_field / (u_zoom_fac * 0.125)));\n\n    if (plot_val > u_line_cutoff) discard;\n\n    gl_FragColor = vec4(u_color, 1. - (plot_val * plot_val / (u_line_cutoff * u_line_cutoff)));\n}"},192:t=>{t.exports="uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute float a_grid_cell_size;\nattribute vec2 a_tex_coord;\n\nvarying highp vec2 v_tex_coord;\nvarying highp float v_grid_cell_size;\nvarying highp float v_map_scale_fac;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    v_tex_coord = a_tex_coord;\n    v_grid_cell_size = a_grid_cell_size;\n\n    // Figure out the latitude from the position vector\n    highp float lat = 2. * atan(exp(a_pos.y / 6371229.0)) - 3.1414592654 / 2.;\n    v_map_scale_fac = cos(lat);\n}"},824:t=>{t.exports="varying highp vec2 v_tex_coord;\n\nuniform sampler2D u_fill_sampler;\nuniform sampler2D u_cmap_sampler;\nuniform sampler2D u_cmap_nonlin_sampler;\nuniform highp float u_cmap_min;\nuniform highp float u_cmap_max;\nuniform highp float u_opacity;\nuniform int u_n_index;\n\nvoid main() {\n    lowp float index_buffer = 1. / (2. * float(u_n_index));\n    highp float fill_val = texture2D(u_fill_sampler, v_tex_coord).r;\n    lowp float normed_val = (fill_val - u_cmap_min) / (u_cmap_max - u_cmap_min);\n    \n    if (normed_val < 0.0 || normed_val > 1.0) {\n        discard;\n    }\n\n    normed_val = index_buffer + normed_val * (1. - 2. * index_buffer); // Chop off the half pixels on either end of the texture\n    highp float nonlin_val = texture2D(u_cmap_nonlin_sampler, vec2(normed_val, 0.5)).r;\n    lowp vec4 color = texture2D(u_cmap_sampler, vec2(nonlin_val, 0.5));\n    color.a = color.a * u_opacity;\n    gl_FragColor = color;\n}"},370:t=>{t.exports="uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_tex_coord;\n\nvarying highp vec2 v_tex_coord;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    v_tex_coord = a_tex_coord;\n}"},714:t=>{t.exports="#define MAX_N_COLORS 24\n\nvarying highp vec2 v_tex_coord;\n\nuniform sampler2D u_fill_sampler;\nuniform lowp vec4 u_colors[MAX_N_COLORS];\nuniform int u_num_colors;\nuniform highp float u_opacity;\n\nvoid main() {\n    highp float fill_val = texture2D(u_fill_sampler, v_tex_coord).r;\n    \n    if (fill_val < 0.5) {\n        discard;\n    }\n\n    lowp vec4 color = vec4(0., 0., 0., 0.);\n\n    for (int nclr = 0; nclr < MAX_N_COLORS ; nclr++) {\n        if (nclr >= u_num_colors || fill_val < 0.99) { break; }\n\n        lowp float mem_active = mod(fill_val, 2.);\n        color = mix(color, u_colors[nclr], mem_active);\n        fill_val = floor(fill_val / 2.);\n    }\n\n    color.a = color.a * u_opacity;\n    gl_FragColor = color;\n}"},431:t=>{t.exports="uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_tex_coord;\n\nvarying highp vec2 v_tex_coord;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    v_tex_coord = a_tex_coord;\n}"},559:t=>{t.exports="varying highp vec2 v_tex_coord;\n\nuniform sampler2D u_sampler;\n\nvoid main() {\n    if (v_tex_coord.x > 1.0) {\n        discard;\n    }\n\n    lowp vec4 tex_color = texture2D(u_sampler, v_tex_coord);\n    gl_FragColor = tex_color;\n}"},319:t=>{t.exports="uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute float a_min_zoom;\nattribute vec2 a_extrusion;\nattribute vec2 a_offset;\nattribute vec2 a_tex_coord;\nuniform lowp float u_offset_scale;\nuniform lowp float u_map_aspect;\nuniform lowp float u_zoom;\nuniform lowp float u_line_width;\nuniform highp float u_map_bearing;\n//uniform highp float u_map_pitch;\n\nvarying highp vec2 v_tex_coord;\n\nmat4 scalingMatrix(float x_scale, float y_scale, float z_scale) {\n    return mat4(x_scale, 0.0,     0.0,     0.0,\n                0.0,     y_scale, 0.0,     0.0,\n                0.0,     0.0,     z_scale, 0.0,\n                0.0,     0.0,     0.0,     1.0);\n}\n\nmat4 rotationZMatrix(float angle) {\n    float s = sin(angle);\n    float c = cos(angle);\n\n    return mat4( c,  s,  0., 0.,\n                -s,  c,  0., 0.,\n                    0., 0., 1., 0.,\n                    0., 0., 0., 1.);\n}\n\nmat4 rotationXMatrix(float angle) {\n    float s = sin(angle);\n    float c = cos(angle);\n\n    return mat4( 1.,  0., 0., 0.,\n                    0.,  c,  s,  0.,\n                    0., -s,  c,  0.,\n                    0.,  0., 0., 1.);\n}\n\nvoid main() {\n    vec4 center_pos = u_matrix * vec4(a_pos.xy, 0.0, 1.0);\n    vec4 offset = vec4(0.0, 0.0, 0.0, 0.0);\n    \n    if (u_zoom >= a_min_zoom) {\n        vec2 offset_2d = a_offset + u_line_width * a_extrusion;\n\n        mat4 rotation_matrix = rotationZMatrix(radians(u_map_bearing));\n        mat4 map_stretch_matrix = scalingMatrix(u_offset_scale, u_offset_scale / u_map_aspect, 1.);\n        offset = map_stretch_matrix * rotation_matrix * vec4(offset_2d, 0., 0.);\n    }\n\n    gl_Position = center_pos + offset;\n    v_tex_coord = a_tex_coord;\n}"}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={exports:{}};return t[r](a,a.exports,n),a.exports}n.m=t,n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.u=t=>t+".autumnplot-gl.js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");r.length&&(t=r[r.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.b=document.baseURI||self.location.href;var r={};return(()=>{"use strict";n.r(r),n.d(r,{Barbs:()=>lt,ColorMap:()=>$,Contour:()=>j,ContourFill:()=>et,Grid:()=>Ut,Hodographs:()=>Tt,LambertGrid:()=>zt,MultiPlotLayer:()=>Bt,Paintball:()=>_t,PlateCarreeGrid:()=>Ht,PlotComponent:()=>g,PlotLayer:()=>St,RawProfileField:()=>$t,RawScalarField:()=>Wt,RawVectorField:()=>Xt,colormaps:()=>Vt,makeColorBar:()=>Mt,makePaintballKey:()=>Ot});const t=Symbol("Comlink.proxy"),e=Symbol("Comlink.endpoint"),o=Symbol("Comlink.releaseProxy"),a=Symbol("Comlink.thrown"),i=t=>"object"==typeof t&&null!==t||"function"==typeof t,c=new Map([["proxy",{canHandle:e=>i(e)&&e[t],serialize(t){const{port1:e,port2:n}=new MessageChannel;return l(t,e),[n,[n]]},deserialize:t=>(t.start(),u(t))}],["throw",{canHandle:t=>i(t)&&a in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function l(e,n=self){n.addEventListener("message",(function r(o){if(!o||!o.data)return;const{id:i,type:c,path:u}=Object.assign({path:[]},o.data),f=(o.data.argumentList||[]).map(m);let _;try{const n=u.slice(0,-1).reduce(((t,e)=>t[e]),e),r=u.reduce(((t,e)=>t[e]),e);switch(c){case"GET":_=r;break;case"SET":n[u.slice(-1)[0]]=m(o.data.value),_=!0;break;case"APPLY":_=r.apply(n,f);break;case"CONSTRUCT":_=function(e){return Object.assign(e,{[t]:!0})}(new r(...f));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;l(e,n),_=function(t,e){return d.set(t,e),t}(t,[t])}break;case"RELEASE":_=void 0;break;default:return}}catch(t){_={value:t,[a]:0}}Promise.resolve(_).catch((t=>({value:t,[a]:0}))).then((t=>{const[e,o]=p(t);n.postMessage(Object.assign(Object.assign({},e),{id:i}),o),"RELEASE"===c&&(n.removeEventListener("message",r),s(n))}))})),n.start&&n.start()}function s(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function u(t,e){return _(t,[],e)}function f(t){if(t)throw new Error("Proxy has been released and is not useable")}function _(t,n=[],r=function(){}){let a=!1;const i=new Proxy(r,{get(e,r){if(f(a),r===o)return()=>v(t,{type:"RELEASE",path:n.map((t=>t.toString()))}).then((()=>{s(t),a=!0}));if("then"===r){if(0===n.length)return{then:()=>i};const e=v(t,{type:"GET",path:n.map((t=>t.toString()))}).then(m);return e.then.bind(e)}return _(t,[...n,r])},set(e,r,o){f(a);const[i,c]=p(o);return v(t,{type:"SET",path:[...n,r].map((t=>t.toString())),value:i},c).then(m)},apply(r,o,i){f(a);const c=n[n.length-1];if(c===e)return v(t,{type:"ENDPOINT"}).then(m);if("bind"===c)return _(t,n.slice(0,-1));const[l,s]=h(i);return v(t,{type:"APPLY",path:n.map((t=>t.toString())),argumentList:l},s).then(m)},construct(e,r){f(a);const[o,i]=h(r);return v(t,{type:"CONSTRUCT",path:n.map((t=>t.toString())),argumentList:o},i).then(m)}});return i}function h(t){const e=t.map(p);return[e.map((t=>t[0])),(n=e.map((t=>t[1])),Array.prototype.concat.apply([],n))];var n}const d=new WeakMap;function p(t){for(const[e,n]of c)if(n.canHandle(t)){const[r,o]=n.serialize(t);return[{type:"HANDLER",name:e,value:r},o]}return[{type:"RAW",value:t},d.get(t)||[]]}function m(t){switch(t.type){case"HANDLER":return c.get(t.name).deserialize(t.value);case"RAW":return t.value}}function v(t,e,n){return new Promise((r=>{const o=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");t.addEventListener("message",(function e(n){n.data&&n.data.id&&n.data.id===o&&(t.removeEventListener("message",e),r(n.data))})),t.start&&t.start(),t.postMessage(Object.assign({id:o},e),n)}))}var b=u(new Worker(new URL(n.p+n.u(110),n.b))),g=function(){};function y(t){return t.getParameter(t.VERSION).includes("WebGL 2.0")}var w=function(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},x=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,a=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},E=function(t,e){e=void 0===e?"float":e;var n=t.match(/#([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?/i);if(null===n)throw"Got '".concat(t,"' in hex2rgba, which does not look like a hex color");var r=n.slice(1).filter((function(t){return void 0!==t})).map((function(t){return parseInt(t,16)}));return"float"==e&&(r=r.map((function(t){return t/255}))),void 0===r[3]?[r[0],r[1],r[2],1]:[r[0],r[1],r[2],r[3]]},R=function(t,e){var n=x(E(t,e),4),r=n[0],o=n[1],a=n[2];return n[3],[r,o,a]},T=function(t,e){var n=x(t,3);return function(t,e){var n=t;return"float"==(e=void 0===e?"float":e)&&(n=n.map((function(t){return Math.round(255*t)}))),"#"+n.map((function(t){return t.toString(16).padStart(2,"0").toUpperCase()})).join("")}([n[0],n[1],n[2],0],e).slice(0,-2)},A=function(t){var e,n=x(t,3),r=n[0],o=n[1],a=n[2],i=Math.max(r,o,a),c=i-Math.min(r,o,a);return 0==c?e=0:i==r?e=(o-a)/c*60%6:i==o?e=60*((a-r)/c+2):i==a&&(e=60*((r-o)/c+4)),[e,0==i?0:c/i,i]},G=function(t){var e,n,r,o=x(t,3),a=o[0],i=o[1],c=o[2],l=c*i,s=l*(1-Math.abs(a/60%2-1)),u=c-l;return 0<=a&&a<60?(e=l,n=s,r=0):60<=a&&a<120?(e=s,n=l,r=0):120<=a&&a<180?(e=0,n=l,r=s):180<=a&&a<240?(e=0,n=s,r=l):240<=a&&a<300?(e=s,n=0,r=l):300<=a&&a<360&&(e=l,n=0,r=s),[e+u,n+u,r+u]};function S(t,e,n){for(var r=1,o=n;t%o!=0||e%o!=0;)r+=1,o/=2;return r}function B(){var t,e,n,r=[];for(t=0;t<arguments.length;t++)r[t]=arguments[t];return w(this,(function(t){switch(t.label){case 0:e=r.map((function(t){return t[Symbol.iterator]()})),t.label=1;case 1:return(n=e.map((function(t){return t.next()}))).some((function(t){return t.done}))?[3,3]:[4,n.map((function(t){return t.value}))];case 2:return t.sent(),[3,1];case 3:return[2]}}))}class N{constructor(t,e,n,r){const o={Float32Array:t.FLOAT,Uint8Array:t.UNSIGNED_BYTE};this.gl=t,this.n_coords_per_vert=n,this.dtype=o[e.constructor.name],this.n_verts=e.length/n,this.draw_mode=r;const a=t.createBuffer();if(null===a)throw"Could not create WebGL buffer";this.buffer=a,t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)}bindToProgram(t){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer),this.gl.enableVertexAttribArray(t),this.gl.vertexAttribPointer(t,this.n_coords_per_vert,this.dtype,!1,0,0)}}class I{constructor(t,e){this.gl=t;const n=t.createTexture();if(null===n)throw"Could not create WebGL texture";this.texture=n,this.tex_num=null,this.setImageData(e);const r=void 0===e.mag_filter?t.LINEAR:e.mag_filter;t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,r)}setImageData(t){const e=this.gl;e.bindTexture(e.TEXTURE_2D,this.texture);const n=function(t){return t.getParameter(t.VERSION).includes("WebGL 2.0")}(e)?function(t,e,n){switch(n){case t.UNSIGNED_BYTE:switch(e){case t.RGBA8:case t.RGB5_A1:case t.RGBA4:case t.SRGB8_ALPHA8:return t.RGBA;case t.RGBA8UI:return t.RGBA_INTEGER;case t.RGB8:case t.RGB565:case t.SRGB8:return t.RGB;case t.RGB8UI:return t.RGB_INTEGER;case t.RG8:return t.RG;case t.RG8UI:return t.RG_INTEGER;case t.R8:return t.RED;case t.R8UI:return t.RED_INTEGER;case t.RGBA:return t.RGBA;case t.RGB:return t.RGB;case t.LUMINANCE_ALPHA:return t.LUMINANCE_ALPHA;case t.LUMINANCE:return t.LUMINANCE;case t.ALPHA:return t.ALPHA}break;case t.BYTE:switch(e){case t.RGBA8_SNORM:return t.RGBA;case t.RGBA8I:return t.RGBA_INTEGER;case t.RGB8_SNORM:return t.RGB;case t.RGB8I:return t.RGB_INTEGER;case t.RG8_SNORM:return t.RG;case t.RG8I:return t.RG_INTEGER;case t.R8_SNORM:return t.RED;case t.R8I:return t.RED_INTEGER}break;case t.UNSIGNED_SHORT_4_4_4_4:switch(e){case t.RGBA4:case t.RGBA:return t.RGBA}break;case t.UNSIGNED_SHORT_5_5_5_1:switch(e){case t.RGB5_A1:case t.RGBA:return t.RGBA}break;case t.UNSIGNED_INT_2_10_10_10_REV:switch(e){case t.RGB10_A2:case t.RGB5_A1:return t.RGBA;case t.RGB10_A2UI:return t.RGBA_INTEGER}break;case t.HALF_FLOAT:switch(e){case t.RGBA16F:return t.RGBA;case t.RGB16F:case t.R11F_G11F_B10F:case t.RGB9_E5:return t.RGB;case t.RG16F:return t.RG;case t.R16F:return t.RED}break;case t.FLOAT:switch(e){case t.RGBA32F:case t.RGBA16F:return t.RGBA;case t.RGB32F:case t.RGB16F:case t.R11F_G11F_B10F:case t.RGB9_E5:return t.RGB;case t.RG32F:case t.RG16F:return t.RG;case t.R32F:case t.R16F:return t.RED;case t.DEPTH_COMPONENT32F:return t.DEPTH_COMPONENT}break;case t.UNSIGNED_SHORT:switch(e){case t.RGBA16UI:return t.RGBA_INTEGER;case t.RGB16UI:return t.RGB_INTEGER;case t.RG16UI:return t.RG_INTEGER;case t.R16UI:return t.RED_INTEGER;case t.DEPTH_COMPONENT16:return t.DEPTH_COMPONENT}break;case t.SHORT:switch(e){case t.RGBA16I:return t.RGBA_INTEGER;case t.RGB16I:return t.RGB_INTEGER;case t.RG16I:return t.RG_INTEGER;case t.R16I:return t.RED_INTEGER}break;case t.UNSIGNED_INT:switch(e){case t.RGBA32UI:return t.RGBA_INTEGER;case t.RGB32UI:return t.RGB_INTEGER;case t.RG32UI:return t.RG_INTEGER;case t.R32UI:return t.RED_INTEGER;case t.DEPTH_COMPONENT24:case t.DEPTH_COMPONENT16:return t.DEPTH_COMPONENT}break;case t.INT:switch(e){case t.RGBA32I:return t.RGBA_INTEGER;case t.RGB32I:return t.RGB_INTEGER;case t.RG32I:return t.RG_INTEGER;case t.R32I:return t.RED_INTEGER}break;case t.UNSIGNED_SHORT_5_6_5:switch(e){case t.RGB565:case t.RGB:return t.RGB}break;case t.UNSIGNED_INT_10F_11F_11F_REV:if(e===t.R11F_G11F_B10F)return t.RGB;break;case t.UNSIGNED_INT_5_9_9_9_REV:if(e===t.RGB9_E5)return t.RGB;break;case t.UNSIGNED_INT_24_8:if(e===t.DEPTH24_STENCIL8)return t.DEPTH_STENCIL;break;case t.FLOAT_32_UNSIGNED_INT_24_8_REV:if(e===t.DEPTH32F_STENCIL8)return t.DEPTH_STENCIL;break;default:throw"Unknown format in getWebGL2InternalFormat"}throw"Invalid combination of internal format and data type"}(e,t.format,t.type):t.format;void 0!==t.width&&void 0!==t.height?e.texImage2D(e.TEXTURE_2D,0,t.format,t.width,t.height,0,n,t.type,t.image):e.texImage2D(e.TEXTURE_2D,0,t.format,n,t.type,t.image)}bindToProgram(t,e){this.activate(e),this.gl.uniform1i(t,e)}activate(t){this.tex_num=t,this.gl.activeTexture(this.gl.TEXTURE0+this.tex_num),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture)}deactivate(){null!==this.tex_num&&(this.gl.activeTexture(this.gl.TEXTURE0+this.tex_num),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.tex_num=null)}delete(){this.gl.deleteTexture(this.texture),this.tex_num=null}}class M{constructor(t,e,n){this.gl=t,this.prog=((t,e,n)=>{const r=t.createShader(t.VERTEX_SHADER);if(null===r)throw"Could not create vertex shader";if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){const e=t.getShaderInfoLog(r);console.log("Vertex shader compiler log: "+e)}const o=t.createShader(t.FRAGMENT_SHADER);if(null===o)throw"Could not create fragment shader";if(t.shaderSource(o,n),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS)){const e=t.getShaderInfoLog(o);console.log("Fragment shader compiler log: "+e)}const a=t.createProgram();if(null===a)throw"Could not create shader program";if(t.attachShader(a,r),t.attachShader(a,o),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS)){const e=t.getProgramInfoLog(a);console.log("Linker log: "+e)}return a})(t,e,n),this.attributes={},this.uniforms={},this.n_verts=null,this.draw_mode=null;const r=t=>{const e=t.indexOf("//");return e>=0&&(t=t.slice(0,e)),t};e=e.split("\n").map(r).join("\n"),n=n.split("\n").map(r).join("\n");for(const n of e.matchAll(/attribute +([\w ]+?) +([\w_]+);[\s]*$/gm)){const[e,r,o]=n;this.attributes[o]={type:r,location:t.getAttribLocation(this.prog,o)}}for(const n of e.matchAll(/uniform +([\w ]+?) +([\w_]+)(?:[\s]*\[.*\])?;[\s]*$/gm)){const[e,r,o]=n,a=r.split(" "),i=t.getUniformLocation(this.prog,o);if(null===i)throw`Could not get vertex shader uniform location for '${o}'`;this.uniforms[o]={type:a[a.length-1],location:i}}for(const e of n.matchAll(/uniform +([\w ]+?) +([\w_]+)(?:[\s]*\[.*\])?;[\s]*$/gm)){const[n,r,o]=e,a=r.split(" "),i=t.getUniformLocation(this.prog,o);if(null===i)throw`Could not get fragment shader uniform location for '${o}'`;this.uniforms[o]={type:a[a.length-1],location:i}}}use(t,e,n){this.gl.useProgram(this.prog),this.draw_mode=null,this.n_verts=null,void 0!==t&&this.bindAttributes(t),void 0!==e&&this.setUniforms(e),void 0!==n&&this.bindTextures(n)}bindAttributes(t){Object.entries(t).forEach((([t,e])=>{if(void 0===this.attributes[t])return void console.warn(`Skipping attribute buffer provided for '${t}' because the attribute was not found in the program.`);if(this.n_verts=null===this.n_verts?e.n_verts:this.n_verts,this.draw_mode=null===this.draw_mode?e.draw_mode:this.draw_mode,this.draw_mode!=e.draw_mode)throw`Unexpected draw mode for attribute buffer ${t} (expected ${this.draw_mode}, got ${e.draw_mode}).`;if(this.n_verts!=e.n_verts)throw`Unexpected number of vertices for attribute buffer ${t} (expected ${this.n_verts}, got ${e.n_verts}).`;const{type:n,location:r}=this.attributes[t];e.bindToProgram(r)}))}setUniforms(t){Object.entries(t).forEach((([t,e])=>{if(void 0===this.uniforms[t])return void console.warn(`Skipping uniform value provided for '${t}' because the uniform was not found in the program.`);const{type:n,location:r}=this.uniforms[t];if("int"===n&&"number"==typeof e)this.gl.uniform1i(r,e);else if("float"===n&&"number"==typeof e)this.gl.uniform1f(r,e);else if("float"===n&&e instanceof Array)this.gl.uniform1fv(r,e);else if("vec2"===n&&e instanceof Array)this.gl.uniform2fv(r,e);else if("vec3"===n&&e instanceof Array)this.gl.uniform3fv(r,e);else if("vec4"===n&&e instanceof Array)this.gl.uniform4fv(r,e);else{if(!("mat4"===n&&e instanceof Array))throw`Could not figure out uniform function for type '${n}' and value '${String(e)}'`;this.gl.uniformMatrix4fv(r,!1,e)}}))}bindTextures(t){Object.entries(t).forEach((([t,e],n)=>{if(void 0===this.uniforms[t])return void console.warn(`Skipping texture provided for sampler '${t}' because the sampler was not found in the program.`);const{type:r,location:o}=this.uniforms[t];e.bindToProgram(o,n)}))}draw(){if(null===this.draw_mode||null===this.n_verts)throw"Cannot draw without binding attribute buffers";this.gl.drawArrays(this.draw_mode,0,this.n_verts)}}class O{constructor(t,e){this.gl=t,this.framebuffer=e}clear(t){const e=this.gl;if(null===e)throw"Register WebGL drawing context using registerGLContext() first";e.clearColor(...t),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),e.clear(e.COLOR_BUFFER_BIT)}renderTo(t,e,n,r){const o=this.gl;if(null===o)throw"Register WebGL drawing context using registerGLContext() first";o.bindFramebuffer(o.FRAMEBUFFER,this.framebuffer),o.viewport(t,e,n,r)}copyToTexture(t,e,n,r,o){const a=this.gl;if(null===a)throw"Register WebGL drawing context using registerGLContext() first";a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer),t.activate(0),a.copyTexImage2D(a.TEXTURE_2D,0,a.RGBA,e,n,r,o,0)}}new class extends O{constructor(){super(null,null)}registerGLContext(t){this.gl=t}};var P,L=(P=function(t,e){return P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},P(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}P(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),C=function(){return C=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},C.apply(this,arguments)},D=n(192),F=n(884);const j=function(t){function e(e,n){var r=t.call(this)||this;r.field=e,r.interval=n.interval||1,r.levels=n.levels||[];var o=E(n.color||"#000000");return r.color=[o[0],o[1],o[2]],r.thinner=n.thinner||function(){return 1},r.gl_elems=null,r}return L(e,t),e.prototype.onAdd=function(t,e){return n=this,r=void 0,a=function(){var n,r,o,a,i,c,l,s,u,f,_;return function(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(h){switch(h.label){case 0:return e.getExtension("OES_texture_float"),e.getExtension("OES_texture_float_linear"),e.getExtension("OES_standard_derivatives"),n=new M(e,D,F),[4,this.field.grid.getWGLBuffers(e)];case 1:return r=h.sent(),o=r.vertices,a=r.texcoords,i=r.cellsize,c=o,l=a,s=i,u=y(e)?e.R32F:e.LUMINANCE,f={format:u,type:e.FLOAT,width:this.field.grid.ni,height:this.field.grid.nj,image:this.field.data,mag_filter:e.LINEAR},_=new I(e,f),this.gl_elems={map:t,program:n,vertices:c,texcoords:l,grid_cell_size:s,fill_texture:_},[2]}}))},new((o=void 0)||(o=Promise))((function(t,e){function i(t){try{l(a.next(t))}catch(t){e(t)}}function c(t){try{l(a.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(i,c)}l((a=a.apply(n,r||[])).next())}));var n,r,o,a},e.prototype.render=function(t,e){if(null!==this.gl_elems){var n=this.gl_elems,r=n.map.getZoom(),o=this.thinner(r)*this.interval,a=.5/o,i=[.25/this.field.grid.ni,.25/this.field.grid.nj],c=Math.pow(2,r),l={u_contour_interval:o,u_line_cutoff:a,u_color:this.color,u_step_size:i,u_zoom_fac:c,u_matrix:e,u_num_contours:0,u_contour_levels:[0]};this.levels.length>0&&(l=C(C({},l),{u_num_contours:this.levels.length,u_contour_levels:this.levels})),n.program.use({a_pos:n.vertices,a_grid_cell_size:n.grid_cell_size,a_tex_coord:n.texcoords},l,{u_fill_sampler:n.fill_texture}),t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),n.program.draw()}},e}(g),k=JSON.parse('{"g":[20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140],"O":["#e6f4ff","#dbf0fe","#d1ebfe","#c6e7fd","#bce3fd","#b1dffc","#a7dbfc","#9cd6fb","#92d2fb","#87cefa","#84c2f6","#81b7f1","#7eabed","#7ba0e8","#7994e4","#7688df","#737ddb","#7071d6","#6d66d2","#6a5acd","#7660cf","#8366d0","#8f6cd2","#9c72d3","#a878d5","#b47ed6","#c184d8","#cd8ad9","#da90db","#e696dc","#e390d9","#e08ad6","#dd84d3","#da7ed0","#d778cd","#d472ca","#d16cc7","#ce66c4","#cb60c1","#c85abe","#c453ba","#c04cb6","#bc45b2","#b83eae","#b437aa","#b030a6","#ac29a2","#a8229e","#a41b9a","#a01496","#a41080","#a80e75","#ac0e75","#b00c6a","#b4085f","#b80649","#bc043e","#c00233","#c80028","#c80028","#ca042a","#cc082c","#d00c2c","#d21432","#d41834","#d41834","#d61c36","#da243a","#dc283c","#de2c3e","#e03040","#e23442","#e43844","#e63c46","#e84048","#ea444a","#ec484c","#ee4c4e","#f05050","#f16052","#f27054","#f38056","#f49058","#f5a05a","#f6b05c","#f7c05e","#f8d060","#f9e062","#faf064","#f7eb61","#f4e65e","#f1e15b","#eedc58","#ebd755","#e8d252","#e5cd4f","#e2c84c","#dfc349","#dcbe46","#d9b943","#d6b440","#d3af3d","#d0aa3a","#cda537","#caa034","#c79b31","#c4962e","#c1912b","#be8c28","#bb8725","#b88222","#b57d1f","#b2781c","#af7319","#ac6e16","#a96913","#a66410","#a35f0d","#a05a0a","#a05a0a"]}'),U=JSON.parse('{"g":[20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80],"O":["#f0f8ff","#dbf0fe","#c6e7fd","#b1dffc","#9cd6fb","#87cefa","#81b7f1","#7ba0e8","#7688df","#7071d6","#6a5acd","#8366d0","#9c72d3","#b47ed6","#cd8ad9","#e696dc","#e08ad6","#da7ed0","#d472ca","#ce66c4","#c85abe","#c04cb6","#b83eae","#b030a6","#a8229e","#a01496","#a81080","#b00c6a","#b8043e","#c80028","#c80028","#d01030","#d41834","#d82038","#dc283c","#e03040","#e43844","#e84048","#ec484c","#f05050","#f27054","#f49058","#f6b05c","#f8d060","#faf064","#f4e65e","#eedc58","#e8d252","#e2c84c","#dcbe46","#d6b440","#d0aa3a","#caa034","#c4962e","#be8c28","#b88222","#b2781c","#ac6e16","#a66410","#a05a0a"]}'),H=JSON.parse('{"g":[0,100,200,300,400,500,600,700,800,900,1000,1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,3100,3200,3300,3400,3500,3600,3700,3800,3900,4000,4100,4200,4300,4400,4500,4600,4700,4800,4900,5000,5100,5200,5300,5400,5500,5600,5700,5800,5900,6000,6500,7000,7500,8000,8500,9000,9500,10000],"O":["#ffffff","#f0f0f0","#e1e1e1","#d2d2d2","#c3c3c3","#a5a5a5","#969696","#878787","#787878","#696969","#37536a","#436075","#506d80","#5c7a8b","#698796","#7594a2","#82a1ad","#8eaeb8","#9bbbc3","#a7c8ce","#e9dd96","#e8d186","#e7c575","#e6b865","#e5ac54","#e5a044","#e49433","#e38723","#e27b12","#e16f02","#dc4110","#d33b17","#ca351e","#c12e25","#b8282c","#af2234","#a61c3b","#9d1542","#940f49","#8b0950","#73088a","#7e1894","#8a289f","#9538a9","#a148b3","#ac59be","#b869c8","#c379d2","#cf89dd","#da99e7","#e9bec3","#e3b0b7","#dda3ac","#d795a0","#d18894","#ca7a89","#c46d7d","#be5f71","#b85266","#b2445a","#893d48","#8f4752","#96525b","#9c5c65","#a2676f","#a97178","#af7c82","#b6868b"]}'),z=JSON.parse('{"g":[-60,-59,-58,-57,-56,-55,-54,-53,-52,-51,-50,-49,-48,-47,-46,-45,-44,-43,-42,-41,-40,-39,-38,-37,-36,-35,-34,-33,-32,-31,-30,-29,-28,-27,-26,-25,-24,-23,-22,-21,-20,-19,-18,-17,-16,-15,-14,-13,-12,-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120],"O":["#235877","#2a5f7c","#316782","#396e87","#40768c","#477d91","#4e8497","#558c9c","#5d93a1","#649ba6","#6ba2ac","#72a9b1","#79b1b6","#81b8bb","#88c0c1","#8fc7c6","#96cecb","#9dd6d0","#a5ddd6","#ace5db","#b3ece0","#b3ece0","#b1e7df","#b0e1dd","#aedcdc","#add7da","#abd2d9","#aaccd8","#a8c7d6","#a7c2d5","#a5bcd4","#a4b7d2","#a2b2d1","#9fa7ce","#9ea2cd","#9c9dcb","#9c9dcb","#9b97ca","#9992c8","#988dc7","#9688c6","#9582c4","#9278c2","#9073c0","#8f6dbf","#8d68bd","#8c63bc","#8a5dbb","#8958b9","#8753b8","#864eb6","#8448b5","#8343b4","#813eb2","#8038b1","#7e33b0","#7d33ae","#7b29ad","#7a23ab","#781eaa","#a037af","#a443b3","#a74fb7","#ab5cbb","#af68bf","#b374c3","#b680c7","#ba8dcc","#be99d0","#c1a5d4","#c5b1d8","#c9bddc","#cdcae0","#d0d6e4","#d4e2e8","#deecf2","#d1e2ee","#c5d9ea","#b8cfe6","#acc5e3","#9fbbdf","#92b2db","#86a8d7","#799ed3","#6c94cf","#608bcb","#5381c7","#4777c4","#3a6dc0","#2d64bc","#215ab8","#1450b4","#0f4455","#1c4e5a","#2a585f","#376363","#456d68","#52776d","#5f8172","#6d8c77","#7a967c","#88a080","#95aa85","#a3b58a","#b0bf8f","#bdc994","#cbd399","#d8de9d","#e6e8a2","#f3f2a7","#f8eea2","#f0e199","#e8d591","#e1c888","#d9bc80","#d1af77","#c9a36f","#c19666","#ba8a5e","#b27d55","#aa714d","#a26444","#9b583c","#8b3f2b","#833222","#7b261a","#7b261a","#741911","#6c0d09","#640000","#5f0000","#630507","#670a0e","#6c0f15","#70141c","#741824","#781d2b","#7d2232","#812739","#852c40","#73372d","#7a4036","#80493f","#875349","#8e5c52","#94655b","#9b6e64","#a88177","#af8a80","#b69389","#bd9c92","#c3a69c","#caafa5","#d1b8ae","#d7c1b7","#decac0","#e5d4ca","#ebddd3","#f2e6dc","#e8dfd6","#e0d7cf","#d8d0c8","#d0c8c0","#c8c0b9","#c0b9b2","#b7b1ab","#afa9a4","#a7a29c","#9f9a95","#97938e","#8f8b87","#878380","#7f7c78","#777471","#6f6c6a","#666563","#5e5d5c","#565554","#4e4e4d","#464646"]}'),W=JSON.parse('{"g":[-40,-39,-38,-37,-36,-35,-34,-33,-32,-31,-30,-29,-28,-27,-26,-25,-24,-23,-22,-21,-20,-19,-18,-17,-16,-15,-14,-13,-12,-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90],"O":["#986d4d","#966c4c","#946b4c","#926a4b","#90694b","#8e684a","#8c664a","#8a6549","#886448","#866348","#846247","#826147","#806046","#7e5f46","#7c5e45","#7a5d44","#785b44","#765a43","#745943","#725842","#715742","#6f5641","#6d5540","#6b5440","#69533f","#67523f","#65503e","#634f3d","#614e3d","#5f4d3c","#5d4c3c","#5b4b3b","#594a3b","#57493a","#554839","#534739","#514538","#4f4438","#4d4337","#4b4237","#494136","#4d4334","#514738","#564c3c","#5a5041","#5e5545","#625949","#675e4d","#6b6251","#6f6755","#746b5a","#78705e","#7c7462","#807966","#857d6a","#89826f","#8d8673","#928b77","#968f7b","#9a947f","#9e9883","#a39d88","#a7a18c","#aba690","#afaa94","#b8b39c","#b8b39c","#bcb8a1","#c1bca5","#c9c5ad","#c9cab1","#d2ceb6","#d2ceb6","#d6d3ba","#dfdcc2","#e3e0c6","#e7e5ca","#ebe9cf","#f0eed3","#f4f2d7","#e6f5e6","#d7f0d7","#c8eac8","#b9e5b9","#aadfaa","#9bda9b","#8cd48c","#7dcf7d","#6ec96e","#5fc45f","#30ae30","#2ca32c","#279927","#238e23","#1e831e","#1a791a","#156e15","#116311","#0c590c","#084e08","#61a3af","#5896a0","#508992","#477b83","#3e6e74","#366166","#2d5457","#244648","#1c393a","#132c2b","#66669a","#605e94","#59568e","#534e88","#4d4682","#463e7c","#403676","#3a2e70","#33266a","#2d1e64","#724071","#784573","#7d4b75","#835076","#885678","#8e5b7a","#93617c","#99667d","#9e6c7f","#a47181"]}');var X=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,a=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},$=function(){function t(t,e){if(t.length!=e.length+1)throw"Mismatch between number of levels (".concat(t.length,") and number of colors (").concat(e.length,"; expected ").concat(t.length-1,")");this.levels=t,this.colors=e.map((function(t){return"object"==typeof(e=t)&&"color"in e&&"opacity"in e?t:{color:t,opacity:1};var e}))}return t.prototype.getColors=function(){return this.colors.map((function(t){return t.color}))},t.prototype.getOpacities=function(){return this.colors.map((function(t){return t.opacity}))},t.prototype.withOpacity=function(e){var n=this,r=this.colors.map((function(t,r){return{color:t.color,opacity:e(n.levels[r],n.levels[r+1])}}));return new t(this.levels,r)},t.diverging=function(e,n,r,o,a){for(var i,c,l=[],s=[],u=(o-r)/(a-1),f=(o+r)/2,_=[0,0,.9],h=A(R(e)),d=A(R(n)),p=0;p<a;p++){var m=r+p*u,v=void 0,b=void 0,g=void 0,y=void 0;m<f?(y=(f-m)/(f-r),v=(i=X([h[0],_[1]+(h[1]-_[1])*y,_[2]+(h[2]-_[2])*y],3))[0],b=i[1],g=i[2]):m>=f&&(y=(m-f)/(o-f),v=(c=X([d[0],_[1]+(d[1]-_[1])*y,_[2]+(d[2]-_[2])*y],3))[0],b=c[1],g=c[2]);var w=T(G([v,b,g]));l.push({color:w,opacity:Math.min(2*y,1)})}for(var x=0;x<=a;x++){var E=(o-r)/a;s.push(r+x*E)}return new t(s,l)},t}(),V=new $(k.g,k.O).withOpacity((function(t,e){return Math.min((e-20)/10,1)})),Z=new $(U.g,U.O).withOpacity((function(t,e){return Math.min((e-20)/10,1)})),Y=new $(H.g,H.O).withOpacity((function(t,e){return Math.min(e/1e3,1)})),J=new $(z.g,z.O),K=new $(W.g,W.O),q=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Q=n(370),tt=n(824);const et=function(t){function e(e,n){var r=t.call(this)||this;r.field=e,r.cmap=n.cmap,r.opacity=n.opacity||1,r.cmap_image=function(t){var e=document.createElement("canvas");e.width=t.colors.length,e.height=1;var n=e.getContext("2d");return t.colors.forEach((function(t,e){if(null===n)throw"Could not get rendering context for colormap image canvas";n.fillStyle=t.color+Math.round(255*t.opacity).toString(16),n.fillRect(e,0,1,1)})),e}(r.cmap);for(var o=r.cmap.levels,a=o.length-1,i=[],c=0;c<101;c++)i.push(c/100);var l=o.map((function(t,e){return e/a})),s=o.map((function(t){return(t-o[0])/(o[a]-o[0])})),u=i.map((function(t){var e;for(e=0;!(s[e]<=t&&t<=s[e+1]);e++);var n=(t-s[e])/(s[e+1]-s[e]);return l[e]*(1-n)+l[e+1]*n}));return r.index_map=new Float32Array(u),r.gl_elems=null,r}return q(e,t),e.prototype.onAdd=function(t,e){return n=this,r=void 0,a=function(){var t,n,r,o,a,i,c,l,s,u,f,_,h;return function(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(d){switch(d.label){case 0:return e.getExtension("OES_texture_float"),e.getExtension("OES_texture_float_linear"),t=new M(e,Q,tt),[4,this.field.grid.getWGLBuffers(e)];case 1:return n=d.sent(),r=n.vertices,o=n.texcoords,a=r,i=o,c=y(e)?e.R32F:e.LUMINANCE,l={format:c,type:e.FLOAT,width:this.field.grid.ni,height:this.field.grid.nj,image:this.field.data,mag_filter:e.LINEAR},s=new I(e,l),u={format:e.RGBA,type:e.UNSIGNED_BYTE,image:this.cmap_image,mag_filter:e.NEAREST},f=new I(e,u),_={format:c,type:e.FLOAT,width:this.index_map.length,height:1,image:this.index_map,mag_filter:e.LINEAR},h=new I(e,_),this.gl_elems={program:t,vertices:a,texcoords:i,fill_texture:s,cmap_texture:f,cmap_nonlin_texture:h},[2]}}))},new((o=void 0)||(o=Promise))((function(t,e){function i(t){try{l(a.next(t))}catch(t){e(t)}}function c(t){try{l(a.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(i,c)}l((a=a.apply(n,r||[])).next())}));var n,r,o,a},e.prototype.render=function(t,e){if(null!==this.gl_elems){var n=this.gl_elems;n.program.use({a_pos:n.vertices,a_tex_coord:n.texcoords},{u_cmap_min:this.cmap.levels[0],u_cmap_max:this.cmap.levels[this.cmap.levels.length-1],u_matrix:e,u_opacity:this.opacity,u_n_index:this.index_map.length},{u_fill_sampler:n.fill_texture,u_cmap_sampler:n.cmap_texture,u_cmap_nonlin_sampler:n.cmap_nonlin_texture}),t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),n.program.draw()}},e}(g);var nt=n(955),rt=n(49),ot=function(){function t(t,e,n,r,o,a,i,c){this.spec=a,this.color=i,this.size_multiplier=c,this.program=new M(t,nt,rt),this.vertices=null,this.texcoords=null;var l,s,u,f,_=Math.log2(n),h=Math.max(_+1-r,0),d=Math.pow(2,h),p=e.getThinnedField(d,d).toEarthRelative(),m=p.u,v=p.v;l=this,s=void 0,f=function(){var e,o,a;return function(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(i){switch(i.label){case 0:return[4,p.grid.getWGLBillboardBuffers(t,n/d,r)];case 1:return e=i.sent(),o=e.vertices,a=e.texcoords,this.vertices=o,this.texcoords=a,[2]}}))},new((u=void 0)||(u=Promise))((function(t,e){function n(t){try{o(f.next(t))}catch(t){e(t)}}function r(t){try{o(f.throw(t))}catch(t){e(t)}}function o(e){var o;e.done?t(e.value):(o=e.value,o instanceof u?o:new u((function(t){t(o)}))).then(n,r)}o((f=f.apply(l,s||[])).next())}));var b=y(t)?t.R32F:t.LUMINANCE,g={format:b,type:t.FLOAT,width:m.grid.ni,height:m.grid.nj,image:m.data,mag_filter:t.NEAREST},w={format:b,type:t.FLOAT,width:v.grid.ni,height:v.grid.nj,image:v.data,mag_filter:t.NEAREST};this.texture=new I(t,o),this.u_texture=new I(t,g),this.v_texture=new I(t,w)}return t.prototype.render=function(t,e,n,r,o,a){var i=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,a=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i}(n,2),c=i[0],l=i[1];if(null!==this.vertices&&null!==this.texcoords){var s=this.spec.BB_HEIGHT*(l/c)*this.size_multiplier,u=this.spec.BB_WIDTH/this.spec.BB_TEX_WIDTH,f=this.spec.BB_HEIGHT/this.spec.BB_TEX_HEIGHT;this.program.use({a_pos:this.vertices,a_tex_coord:this.texcoords},{u_bb_size:s,u_bb_width:u,u_bb_height:f,u_bb_mag_bin_size:this.spec.BB_MAG_BIN_SIZE,u_bb_mag_wrap:this.spec.BB_MAG_WRAP,u_bb_color:this.color,u_matrix:e,u_map_aspect:l/c,u_zoom:r,u_map_bearing:o},{u_sampler:this.texture,u_u_sampler:this.u_texture,u_v_sampler:this.v_texture}),t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),this.program.draw()}},t}(),at=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),it={BB_WIDTH:85,BB_HEIGHT:256,BB_TEX_WIDTH:1024,BB_TEX_HEIGHT:1024,BB_MAG_MAX:235,BB_MAG_WRAP:60,BB_MAG_BIN_SIZE:5},ct=null;const lt=function(t){function e(e,n){var r=t.call(this)||this;r.fields=e;var o=E(n.color||"#000000");return r.color=[o[0],o[1],o[2]],r.thin_fac=n.thin_fac||1,r.gl_elems=null,r}return at(e,t),e.prototype.onAdd=function(t,e){return n=this,r=void 0,a=function(){var n,r,o;return function(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(a){return e.getExtension("OES_texture_float"),e.getExtension("OES_texture_float_linear"),n=t.getMaxZoom(),null===ct&&(ct=function(){var t=document.createElement("canvas");function e(t,e,n,r){var o=it.BB_WIDTH/2-4,a=o/2;if(r<2.5)t.beginPath(),t.arc(e,n,o/2,0,2*Math.PI),t.stroke();else{var i=0,c=r,l=0,s=Math.floor((c+2.5)/50);l+=s*o/2+a+(s-1)*a/2,c-=50*s;var u=Math.floor((c+2.5)/10);l+=u*a,c-=10*u,l+=Math.floor((c+2.5)/5)*a,r<7.5&&(l+=a),l=Math.max(120,l),t.beginPath(),t.moveTo(e,n),t.lineTo(e,n+l),c=r,i=n+l;for(var f=!1,_=!0;c>47.5;)f&&(i+=a/2),_||t.moveTo(e,i),t.lineTo(e-o,i),t.lineTo(e,i-o/2),i-=o/2+a,c-=50,f=!0,_=!1;for(;c>7.5;)_||t.moveTo(e,i),t.lineTo(e-o,i+o/2),i-=a,c-=10,_=!1;for(r<7.5&&(i-=a);c>2.5;)t.moveTo(e,i),t.lineTo(e-o/2,i+o/4),c-=5;t.stroke()}}t.width=it.BB_TEX_WIDTH,t.height=it.BB_TEX_HEIGHT;var n=t.getContext("2d");if(null===n)throw"Could not get rendering context for the wind barb canvas";n.lineWidth=8,n.miterLimit=4;for(var r=0;r<=it.BB_MAG_MAX;r+=it.BB_MAG_BIN_SIZE)e(n,r%it.BB_MAG_WRAP/it.BB_MAG_BIN_SIZE*it.BB_WIDTH+it.BB_WIDTH/2,Math.floor(r/it.BB_MAG_WRAP)*it.BB_HEIGHT+it.BB_WIDTH/2,r);return t}()),r={format:e.RGBA,type:e.UNSIGNED_BYTE,image:ct,mag_filter:e.NEAREST},o=new ot(e,this.fields,this.thin_fac,n,r,it,this.color,.1),this.gl_elems={map:t,barb_billboards:o},[2]}))},new((o=void 0)||(o=Promise))((function(t,e){function i(t){try{l(a.next(t))}catch(t){e(t)}}function c(t){try{l(a.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(i,c)}l((a=a.apply(n,r||[])).next())}));var n,r,o,a},e.prototype.render=function(t,e){if(null!==this.gl_elems){var n=this.gl_elems,r=n.map.getZoom(),o=n.map.getCanvas().width,a=n.map.getCanvas().height,i=n.map.getBearing(),c=n.map.getPitch();n.barb_billboards.render(t,e,[o,a],r,i,c)}},e}(g);var st=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ut=n(431),ft=n(714);const _t=function(t){function e(e,n){var r=t.call(this)||this;r.field=e;var o=void 0!==(n=void 0!==n?n:{}).colors?function(t,e,n){if(n||2===arguments.length)for(var r,o=0,a=e.length;o<a;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,a=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i}(n.colors),!1):["#000000"];return r.colors=o.reverse().map((function(t){return E(t)})).flat(),r.opacity=void 0!==n.opacity?n.opacity:1,r.gl_elems=null,r}return st(e,t),e.prototype.onAdd=function(t,e){return n=this,r=void 0,a=function(){var t,n,r,o,a,i,c,l,s;return function(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(u){switch(u.label){case 0:return e.getExtension("OES_texture_float"),t=new M(e,ut,ft),[4,this.field.grid.getWGLBuffers(e)];case 1:return n=u.sent(),r=n.vertices,o=n.texcoords,a=r,i=o,c=y(e)?e.R32F:e.LUMINANCE,l={format:c,type:e.FLOAT,width:this.field.grid.ni,height:this.field.grid.nj,image:this.field.data,mag_filter:e.NEAREST},s=new I(e,l),this.gl_elems={program:t,vertices:a,fill_texture:s,texcoords:i},[2]}}))},new((o=void 0)||(o=Promise))((function(t,e){function i(t){try{l(a.next(t))}catch(t){e(t)}}function c(t){try{l(a.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(i,c)}l((a=a.apply(n,r||[])).next())}));var n,r,o,a},e.prototype.render=function(t,e){if(null!==this.gl_elems){var n=this.gl_elems;n.program.use({a_pos:n.vertices,a_tex_coord:n.texcoords},{u_matrix:e,u_opacity:this.opacity,u_colors:this.colors,u_num_colors:this.colors.length/4},{u_fill_sampler:n.fill_texture}),t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),n.program.draw()}},e}(g);var ht=n(319),dt=n(559),pt=function(){function t(t,e,n,r,o){this.width=r,this.scale=o,this.program=new M(t,ht,dt),this.origin=new N(t,e.origin,2,t.TRIANGLE_STRIP),this.offset=new N(t,e.verts,2,t.TRIANGLE_STRIP),this.extrusion=new N(t,e.extrusion,2,t.TRIANGLE_STRIP),this.min_zoom=new N(t,e.zoom,1,t.TRIANGLE_STRIP),this.texture=new I(t,n),this.texcoords=new N(t,e.texcoords,2,t.TRIANGLE_STRIP)}return t.prototype.render=function(t,e,n,r,o,a){var i=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,a=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i}(n,2),c=i[0],l=i[1];this.program.use({a_pos:this.origin,a_offset:this.offset,a_extrusion:this.extrusion,a_min_zoom:this.min_zoom,a_tex_coord:this.texcoords},{u_offset_scale:this.scale*(l/c),u_line_width:this.width,u_matrix:e,u_map_aspect:l/c,u_zoom:r,u_map_bearing:o},{u_sampler:this.texture}),t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),this.program.draw()},t}();function mt(t){var e,n,r=function(t){var e=Math.sin(t);return Math.tan(Math.PI/4-t/2)*Math.pow((1+i*e)/(1-i*e),i/2)},o=function(t){var e=Math.sin(t);return Math.cos(t)/Math.sqrt(1-i*i*e*e)},a=6378137,i=Math.sqrt(.006694379990197619),c=Math.PI/180,l=t.lon_0,s=t.lat_0,u=t.lat_std;u=Array.isArray(u)&&u[0]==u[1]?u[0]:u,l*=c;var f=r(s*=c);if(Array.isArray(u)){var _=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,a=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i}(u,2),h=_[0],d=_[1];d*=c;var p=r(h*=c),m=r(d),v=o(h),b=o(d);n=Math.log(v/b)/Math.log(p/m),e=v/(n*Math.pow(p,n))}else h=u,p=r(h*=c),v=o(h),n=Math.sin(h),e=v/(n*Math.pow(p,n));var g=a*e*Math.pow(f,n),y=i*i,w=y*y,x=w*y,E=x*y,R=y/2+5*w/24+3*x/120-73*E/2016,T=7*w/24+29*x/120+233*E/6720,A=7*x/30+81*E/280,G=4729*E/20160;return function(t,o,i){return(i=void 0===i?{inverse:!1}:i).inverse?(s=t,u=o,f=Math.atan2(s,g-u)/n+l,_=Math.hypot(s,g-u)*Math.sign(n),h=Math.pow(_/(a*e),1/n),d=Math.PI/2-2*Math.atan(h),p=Math.sin(2*d),m=Math.cos(2*d),[f/c,(d+p*(R+m*(T+m*(A+G*m))))/c]):function(t,o){t*=c;var i=r(o*=c),s=a*e*Math.pow(i,n),u=n*(t-l);return[s*Math.sin(u),g-s*Math.cos(u)]}(t,o);var s,u,f,_,h,d,p,m}}var vt=function(){function t(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: (".concat(t,", ").concat(e,")"));if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return t.prototype.toMercatorCoord=function(){return{x:(e=this.lng,(180+e)/360),y:(t=this.lat,(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360)};var t,e},t}(),bt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,a=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},yt=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,a=e.length;o<a;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},wt={BB_WIDTH:256,BB_HEIGHT:256,BB_TEX_WIDTH:256,BB_TEX_HEIGHT:256,BB_MAG_MAX:1e3,BB_MAG_WRAP:1e3,BB_MAG_BIN_SIZE:1e3},xt=null,Et=[{bounds:[0,1],color:"#ffffcc"},{bounds:[1,3],color:"#a1dab4"},{bounds:[3,6],color:"#41b6c4"},{bounds:[6,9],color:"#225ea8"}],Rt=null;const Tt=function(t){function e(e,n){var r=t.call(this)||this;n=n||{},r.profile_field=e;var o=E(n.bgcolor||"#000000");return r.bgcolor=[o[0],o[1],o[2]],r.thin_fac=n.thin_fac||1,r.gl_elems=null,r}return bt(e,t),e.prototype.onAdd=function(t,e){return n=this,r=void 0,a=function(){var n,r,o,a,i,c,l,s,u,f,_,h,d=this;return function(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(p){switch(p.label){case 0:return n=(wt.BB_TEX_WIDTH-2)/(40*wt.BB_TEX_WIDTH),r=140,null===xt&&(xt=function(){var t=document.createElement("canvas");t.width=wt.BB_TEX_WIDTH,t.height=wt.BB_TEX_HEIGHT;var e=t.getContext("2d");if(null===e)throw"Could not get rendering context for the hodograph background canvas";e.lineWidth=4;for(var n=wt.BB_TEX_WIDTH/4;n<=wt.BB_TEX_WIDTH/2;n+=wt.BB_TEX_WIDTH/4)e.beginPath(),e.arc(wt.BB_TEX_WIDTH/2,wt.BB_TEX_WIDTH/2,n-2,0,2*Math.PI),e.stroke();var r=wt.BB_TEX_WIDTH/2,o=wt.BB_TEX_WIDTH/2;return e.beginPath(),e.moveTo(r,o),e.lineTo(r+10,o+20),e.lineTo(r-10,o+20),e.lineTo(r,o),e.fill(),t}()),o={format:e.RGBA,type:e.UNSIGNED_BYTE,image:xt,mag_filter:e.NEAREST},a=t.getMaxZoom(),i=new ot(e,this.profile_field.getStormMotionGrid(),this.thin_fac,a,o,wt,this.bgcolor,.004*r),[4,b.makePolyLines(this.profile_field.profiles.map((function(t){var e=new vt(t.lon,t.lat).toMercatorCoord(),n=S(t.jlat,t.ilon,d.thin_fac),r=Math.max.apply(Math,yt([],gt(Et.map((function(t){return Math.max.apply(Math,yt([],gt(t.bounds),!1))}))),!1));return{verts:yt([],gt(t.u),!1).map((function(e,n){return[e-t.smu,t.v[n]-t.smv]})),origin:[e.x,e.y],zoom:n,texcoords:yt([],gt(t.z),!1).map((function(t){return[t/r,.5]}))}})))];case 1:return c=p.sent(),null===Rt&&(Rt=function(){var t=document.createElement("canvas");t.width=Math.max.apply(Math,yt([],gt(Et.map((function(t){return Math.max.apply(Math,yt([],gt(t.bounds),!1))}))),!1)),t.height=1;var e=t.getContext("2d");return Et.forEach((function(t){if(null===e)throw"Could not get rendering context for the hodograph height texture canvas";var n=gt(t.bounds,2),r=n[0],o=n[1];e.fillStyle=t.color,e.fillRect(r,0,o-r,1)})),t}()),l={format:e.RGBA,type:e.UNSIGNED_BYTE,image:Rt,mag_filter:e.NEAREST},s=new pt(e,c,l,1.5,n*r),[4,b.makePolyLines(this.profile_field.profiles.map((function(t){var e=new vt(t.lon,t.lat).toMercatorCoord(),n=S(t.jlat,t.ilon,d.thin_fac),r=Math.hypot(t.smu,t.smv),o=Math.PI/2-Math.atan2(-t.smv,-t.smu);return{verts:[[2*Math.sin(o),2*Math.cos(o)],[r*Math.sin(o),r*Math.cos(o)]],origin:[e.x,e.y],zoom:n,texcoords:[[.5,.5],[.5,.5]]}})))];case 2:return u=p.sent(),(f=this.bgcolor.map((function(t){return 255*t}))).push(255),_={format:e.RGBA,type:e.UNSIGNED_BYTE,width:1,height:1,image:new Uint8Array(f),mag_filter:e.NEAREST},h=new pt(e,u,_,1,n*r),this.gl_elems={map:t,bg_billboard:i,hodo_line:s,sm_line:h},[2]}}))},new((o=void 0)||(o=Promise))((function(t,e){function i(t){try{l(a.next(t))}catch(t){e(t)}}function c(t){try{l(a.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(i,c)}l((a=a.apply(n,r||[])).next())}));var n,r,o,a},e.prototype.render=function(t,e){if(null!==this.gl_elems){var n=this.gl_elems,r=n.map.getZoom(),o=n.map.getCanvas().width,a=n.map.getCanvas().height,i=n.map.getBearing(),c=n.map.getPitch();n.hodo_line.render(t,e,[o,a],r,i,c),n.sm_line.render(t,e,[o,a],r,i,i),n.bg_billboard.render(t,e,[o,a],r,i,c)}},e}(g);var At=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gt=function(t){this.type="custom",this.id=t},St=function(t){function e(e,n){var r=t.call(this,e)||this;return r.field=n,r}return At(e,t),e.prototype.onAdd=function(t,e){this.field.onAdd(t,e)},e.prototype.render=function(t,e){this.field.render(t,e)},e}(Gt),Bt=function(t){function e(e){var n=t.call(this,e)||this;return n.fields={},n.field_key=null,n.map=null,n.gl=null,n}return At(e,t),e.prototype.onAdd=function(t,e){var n=this;this.map=t,this.gl=e,Object.values(this.fields).forEach((function(r){r.onAdd(t,e).then((function(t){n._repaintIfNecessary(null)}))})),this._repaintIfNecessary(null)},e.prototype.render=function(t,e){null!==this.map&&null!==this.gl&&null!==this.field_key&&this.fields.hasOwnProperty(this.field_key)&&null!==this.fields[this.field_key]&&this.fields[this.field_key].render(t,e)},e.prototype.setActiveKey=function(t){var e=this.field_key;this.field_key=t,this._repaintIfNecessary(e)},e.prototype.getKeys=function(){return Object.keys(this.fields)},e.prototype.addField=function(t,e){var n=this;this.field_key,null!==this.map&&null!==this.gl&&null!==t&&t.onAdd(this.map,this.gl).then((function(t){n._repaintIfNecessary(null)})),this.fields[e]=t,null===this.field_key&&(this.field_key=e)},e.prototype._repaintIfNecessary=function(t){null!==this.map&&t!==this.field_key&&this.map.triggerRepaint()},e}(Gt),Nt=function(){return Nt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Nt.apply(this,arguments)},It=function(t,e,n){var r=document.createElementNS("http://www.w3.org/2000/svg",t);return void 0!==e&&Object.entries(e).forEach((function(t){var e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,a=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i}(t,2),n=e[0],o=e[1];r.setAttribute(n,o.toString())})),void 0!==n&&n.appendChild(r),r};function Mt(t,e){var n=e.label||"",r=e.ticks||t.levels,o=e.orientation||"vertical",a=e.fontface||"sans-serif",i=e.tick_direction||("vertical"==o?"left":"bottom");if("vertical"==o&&("top"==i||"bottom"==i)||"horizontal"==o&&("left"==i||"right"==i))throw"tick_direction of '".concat(i," doesn't match an orientation of ").concat(o);var c,l,s,u,f,_,h=function(t){return t.toString().length},d=h(r[0]),p=h(r[r.length-1]),m=600,v=m/9,b="horizontal"==o?6*Math.max(d,p):5;"vertical"==o?(c=m,l=v,s="left"==i?53.66666666666667:3,u=b,f=10,_=m-2*b):(l=m,c=v-6,s=b,u="bottom"==i?3:47.66666666666667,_=10,f=m-2*b);var g,y=t.colors.length,w=It("svg",{width:l,height:c}),x=It("g",{},w);g="vertical"==o?"left"==i?{"text-anchor":"end",transform:"translate(".concat(s,", ").concat(u,")")}:{transform:"translate(".concat(s+f,", ").concat(u,")")}:"bottom"==i?{"text-anchor":"middle",transform:"translate(".concat(s,", ").concat(u+_,")")}:{"text-anchor":"middle",transform:"translate(".concat(s,", ").concat(u,")")};var E,R=It("g",g,w);return t.colors.forEach((function(t,e){It("rect",Nt(Nt({},"vertical"==o?{x:s,y:u+_*(1-(e+1)/y),width:f,height:_/y}:{x:s+f*e/y,y:u,width:f/y,height:_}),{fill:t.color,opacity:t.opacity}),x)})),r.forEach((function(e){var n=t.levels.indexOf(e),r="vertical"==o?{transform:"translate(0, ".concat(_*(1-n/y),")")}:{transform:"translate(".concat(f*n/y,", 0)")},c=It("g",r,R);It("line",Nt(Nt({},"vertical"==o?"left"==i?{x2:-6}:{x2:6}:"bottom"==i?{y2:6}:{y2:-6}),{stroke:"#000000","stroke-width":1.5}),c),It("text",Nt(Nt({},"vertical"==o?"left"==i?{x:-9,dy:"0.32em"}:{x:9,dy:"0.32em"}:"bottom"==i?{y:9,dy:"0.8em"}:{y:-9,dy:"0em"}),{fill:"#000000",style:"font-family: ".concat(a,";")}),c).textContent=e.toString()})),It("rect",{x:s,y:u,width:f,height:_,stroke:"#000000","stroke-width":1.5,fill:"none"},w),E="vertical"==o?"left"==i?{transform:"translate(15, ".concat(c/2,") rotate(-90)")}:{transform:"translate(".concat(l-6,", ").concat(c/2,") rotate(-90)")}:"bottom"==i?{transform:"translate(".concat(l/2,", ").concat(c-5,")")}:{transform:"translate(".concat(l/2,", 15)")},It("text",Nt(Nt({},E),{fill:"#000000","text-anchor":"middle",style:"font-family: ".concat(a,";")}),w).textContent=n,w}function Ot(t,e,n){if(t.length!=e.length)throw"Mismatch between the number of colors (".concat(t.length,") and the number of labels (").concat(e.length,")");var r=void 0===(n=void 0===n?{}:n).n_cols?1:n.n_cols,o=void 0===n.fontface?"sans-serif":n.fontface,a=Math.ceil(t.length/r),i=It("svg",{width:123*r+5*(r+1),height:20*a+5*(a+1)}),c=It("g",{},i);return t.forEach((function(t,n){var r=e[n],i=n%a,l=Math.floor(n/a),s=1;"string"!=typeof t&&(s=t.opacity,t=t.color);var u=5+128*l,f=5+25*i;It("rect",{x:u,y:f,fill:t,opacity:s,width:20,height:20},c),It("text",Nt(Nt({},{x:u+20+3,y:f+10,dy:"0.32em"}),{fill:"#000000",style:"font-size: 0.8em; font-family: ".concat(o,";")}),c).textContent=r})),i}var Pt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lt=function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{l(r.next(t))}catch(t){a(t)}}function c(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,c)}l((r=r.apply(t,e||[])).next())}))},Ct=function(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=e.call(t,i)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},Dt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,a=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},Ft=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,a=e.length;o<a;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},jt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},kt=function(){function t(t){this.cached_value=null,this.compute_value=t}return t.prototype.getValue=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return null===this.cached_value&&(this.cached_value=this.compute_value.apply(this,Ft([],Dt(t),!1))),this.cached_value},t}(),Ut=function(){function t(t,e,n,r){var o=this;this.type=t,this.is_conformal=e,this.ni=n,this.nj=r,this._buffer_cache=new kt((function(t){var e=Math.max(Math.floor(o.ni/50),20),n=Math.max(Math.floor(o.nj/50),20);return function(t,e,n){return Lt(this,void 0,void 0,(function(){var r,o,a,i,c,l,s,u,f,_,h;return Ct(this,(function(d){switch(d.label){case 0:return r=1/(2*(n=void 0!==n?n:e).ni),o=1/(2*n.nj),a=e.ni*e.nj/(n.ni*n.nj),i=e.getCoords(),c=i.lats,l=i.lons,[4,b.makeDomainVerticesAndTexCoords(c,l,e.ni,e.nj,r,o)];case 1:for(s=d.sent(),u=0;u<s.grid_cell_size.length;u++)s.grid_cell_size[u]*=a;return f=new N(t,s.vertices,2,t.TRIANGLE_STRIP),_=new N(t,s.tex_coords,2,t.TRIANGLE_STRIP),h=new N(t,s.grid_cell_size,1,t.TRIANGLE_STRIP),[2,{vertices:f,texcoords:_,cellsize:h}]}}))}))}(t,o.copy({ni:e,nj:n}),o)})),this._billboard_buffer_cache=new kt((function(t,e,n){return function(t,e,n,r){return Lt(this,void 0,void 0,(function(){var o,a,i,c,l,s;return Ct(this,(function(u){switch(u.label){case 0:return o=e.getCoords(),a=o.lats,i=o.lons,[4,b.makeBBElements(a,i,e.ni,e.nj,n,r)];case 1:return c=u.sent(),l=new N(t,c.pts,3,t.TRIANGLE_STRIP),s=new N(t,c.tex_coords,2,t.TRIANGLE_STRIP),[2,{vertices:l,texcoords:s}]}}))}))}(t,o,e,n)}))}return t.prototype.getWGLBuffers=function(t){return Lt(this,void 0,void 0,(function(){return Ct(this,(function(e){switch(e.label){case 0:return[4,this._buffer_cache.getValue(t)];case 1:return[2,e.sent()]}}))}))},t.prototype.getWGLBillboardBuffers=function(t,e,n){return Lt(this,void 0,void 0,(function(){return Ct(this,(function(r){switch(r.label){case 0:return[4,this._billboard_buffer_cache.getValue(t,e,n)];case 1:return[2,r.sent()]}}))}))},t}(),Ht=function(t){function e(e,n,r,o,a,i){var c=t.call(this,"latlon",!0,e,n)||this;return c.ll_lon=r,c.ll_lat=o,c.ur_lon=a,c.ur_lat=i,c._ll_cache=new kt((function(){for(var t=(c.ur_lon-c.ll_lon)/(c.ni-1),e=(c.ur_lat-c.ll_lat)/(c.nj-1),n=new Float32Array(c.ni*c.nj),r=new Float32Array(c.ni*c.nj),o=0;o<c.ni;o++)for(var a=0;a<c.nj;a++){var i=o+a*c.ni;n[i]=c.ll_lon+o*t,r[i]=c.ll_lat+a*e}return{lons:n,lats:r}})),c}return Pt(e,t),e.prototype.copy=function(t){return new e(void 0!==(t=void 0!==t?t:{}).ni?t.ni:this.ni,void 0!==t.nj?t.nj:this.nj,void 0!==t.ll_lon?t.ll_lon:this.ll_lon,void 0!==t.ll_lat?t.ll_lat:this.ll_lat,void 0!==t.ur_lon?t.ur_lon:this.ur_lon,void 0!==t.ur_lat?t.ur_lat:this.ur_lat)},e.prototype.getCoords=function(){return this._ll_cache.getValue()},e.prototype.transform=function(t,e,n){return[t,e]},e.prototype.getThinnedGrid=function(t,n){var r=(this.ur_lon-this.ll_lon)/this.ni,o=(this.ur_lat-this.ll_lat)/this.nj,a=Math.ceil(this.ni/t),i=Math.ceil(this.nj/n),c=(this.ni-1)%t,l=(this.nj-1)%n;return new e(a,i,this.ll_lon,this.ll_lat,this.ur_lon-c*r,this.ur_lat-l*o)},e}(Ut),zt=function(t){function e(e,n,r,o,a,i,c,l,s){var u=t.call(this,"lcc",!0,e,n)||this;return u.lon_0=r,u.lat_0=o,u.lat_std=a,u.ll_x=i,u.ll_y=c,u.ur_x=l,u.ur_y=s,u.lcc=mt({lon_0:r,lat_0:o,lat_std:a}),u._ll_cache=new kt((function(){for(var t=new Float32Array(u.ni*u.nj),e=new Float32Array(u.ni*u.nj),n=0;n<u.ni;n++)for(var r=u.ll_x+(u.ur_x-u.ll_x)*n/(u.ni-1),o=0;o<u.nj;o++){var a=u.ll_y+(u.ur_y-u.ll_y)*o/(u.nj-1),i=Dt(u.lcc(r,a,{inverse:!0}),2),c=i[0],l=i[1],s=n+o*u.ni;t[s]=c,e[s]=l}return{lons:t,lats:e}})),u}return Pt(e,t),e.prototype.copy=function(t){var n=void 0!==(t=void 0!==t?t:{}).ni?t.ni:this.ni,r=void 0!==t.nj?t.nj:this.nj,o=void 0!==t.ll_x?t.ll_x:this.ll_x,a=void 0!==t.ll_y?t.ll_y:this.ll_y,i=void 0!==t.ur_x?t.ur_x:this.ur_x,c=void 0!==t.ur_y?t.ur_y:this.ur_y;return new e(n,r,this.lon_0,this.lat_0,this.lat_std,o,a,i,c)},e.prototype.getCoords=function(){return this._ll_cache.getValue()},e.prototype.transform=function(t,e,n){var r="inverse"in(n=void 0===n?{}:n)&&n.inverse;return this.lcc(t,e,{inverse:r})},e.prototype.getThinnedGrid=function(t,n){var r=(this.ur_x-this.ll_x)/this.ni,o=(this.ur_y-this.ll_y)/this.nj,a=Math.ceil(this.ni/t),i=Math.ceil(this.nj/n),c=(this.ni-1)%t,l=(this.nj-1)%n,s=this.ll_x,u=this.ll_y,f=this.ur_x-c*r,_=this.ur_y-l*o;return new e(a,i,this.lon_0,this.lat_0,this.lat_std,s,u,f,_)},e}(Ut),Wt=function(){function t(t,e){if(this.grid=t,this.data=e,t.ni*t.nj!=e.length)throw"Data size (".concat(e.length,") doesn't match the grid dimensions (").concat(t.ni," x ").concat(t.nj,"; expected ").concat(t.ni*t.nj," points)")}return t.prototype.getThinnedField=function(e,n){for(var r=this.grid.getThinnedGrid(e,n),o=new Float32Array(r.ni*r.nj),a=0;a<r.ni;a++)for(var i=0;i<r.nj;i++){var c=a*e+this.grid.ni*i*n;o[a+r.ni*i]=this.data[c]}return new t(r,o)},t.aggregateFields=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];function o(t,e){var n,r,o,a,i,c;return Ct(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,7]),n=jt(t),r=n.next(),l.label=1;case 1:return r.done?[3,4]:(o=r.value,[4,e(o)]);case 2:l.sent(),l.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return a=l.sent(),i={error:a},[3,7];case 6:try{r&&!r.done&&(c=n.return)&&c.call(n)}finally{if(i)throw i.error}return[7];case 7:return[2]}}))}var a=B.apply(void 0,Ft([],Dt(n.map((function(t){return t.data}))),!1)),i=new Float32Array(o(a,(function(t){return e.apply(void 0,Ft([],Dt(t),!1))})));return new t(n[0].grid,i)},t}(),Xt=function(){function t(t,e,n,r){var o=this;r=void 0===r?{}:r,this.u=new Wt(t,e),this.v=new Wt(t,n),this.relative_to=void 0===r.relative_to?"grid":r.relative_to,this._rotate_cache=new kt((function(){for(var t=o.u.grid,e=t.getCoords(),n=new Float32Array(e.lats.length),r=new Float32Array(e.lats.length),a=0;a<e.lats.length;a++){var i=e.lons[a],c=e.lats[a],l=o.u.data[a],s=o.v.data[a],u=Dt(t.transform(i,c),2),f=u[0],_=u[1],h=Dt(t.transform(i+.01,c),2),d=h[0],p=h[1],m=Math.hypot(f-d,_-p),v=(d-f)/m,b=(p-_)/m,g=void 0,y=void 0;if(t.is_conformal)g=-b,y=v;else{var w=Dt(t.transform(i,c+.01),2),x=w[0],E=w[1],R=Math.hypot(f-x,_-E);g=(x-f)/R,y=(E-_)/R}n[a]=v*l+b*s,r[a]=g*l+y*s}return{u:new Wt(t,n),v:new Wt(t,r)}}))}return t.prototype.getThinnedField=function(e,n){var r=this.u.getThinnedField(e,n),o=this.v.getThinnedField(e,n);return new t(r.grid,r.data,o.data,{relative_to:this.relative_to})},Object.defineProperty(t.prototype,"grid",{get:function(){return this.u.grid},enumerable:!1,configurable:!0}),t.prototype.toEarthRelative=function(){var e,n;if("earth"==this.relative_to)e=this.u,n=this.v;else{var r=this._rotate_cache.getValue();e=r.u,n=r.v}return new t(e.grid,e.data,n.data,{relative_to:"earth"})},t}(),$t=function(){function t(t,e){this.profiles=e,this.grid=t}return t.prototype.getStormMotionGrid=function(){var t=this,e=new Float32Array(this.grid.ni*this.grid.nj),n=new Float32Array(this.grid.ni*this.grid.nj);return this.profiles.forEach((function(r){var o=r.ilon+t.grid.ni*r.jlat;e[o]=r.smu,n[o]=r.smv})),new Xt(this.grid,e,n,{relative_to:"grid"})},t}(),Vt={bluered:function(t,e,n){return $.diverging("#0000ff","#ff0000",t,e,n)},redblue:function(t,e,n){return $.diverging("#ff0000","#0000ff",t,e,n)},pw_speed500mb:V,pw_speed850mb:Z,pw_cape:Y,pw_t2m:J,pw_td2m:K}})(),r})()));
//# sourceMappingURL=autumnplot-gl.js.map
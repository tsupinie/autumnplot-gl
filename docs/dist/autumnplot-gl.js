!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.apgl=e():t.apgl=e()}(this,(()=>(()=>{var t={49:t=>{t.exports="varying highp vec2 v_tex_coord;\n\nuniform sampler2D u_sampler;\nuniform lowp vec3 u_bb_color;\n\nvoid main() {\n    lowp vec4 tex_color = texture2D(u_sampler, v_tex_coord);\n    gl_FragColor = vec4(u_bb_color, tex_color.a); // mix(vec4(1.0, 0.0, 0.0, 0.5), vec4(u_bb_color, 1.0), tex_color.a);\n}"},955:t=>{t.exports="uniform mat4 u_matrix;\n\nattribute vec3 a_pos;    // Has position, zoom, and corner info\nattribute vec2 a_tex_coord;\nuniform lowp float u_bb_size;\nuniform lowp float u_map_aspect;\nuniform lowp float u_zoom;\nuniform highp float u_map_bearing;\nuniform lowp float u_bb_width;  // Normalized by texture width\nuniform lowp float u_bb_height; // Normalized by texture height\nuniform highp float u_bb_mag_bin_size;\n//uniform highp float u_bb_max_mag;\nuniform highp float u_bb_mag_wrap;\n\nuniform sampler2D u_u_sampler;\nuniform sampler2D u_v_sampler;\n\nvarying highp vec2 v_tex_coord;\n\nmat4 scalingMatrix(float x_scale, float y_scale, float z_scale) {\n    return mat4(x_scale, 0.0,     0.0,     0.0,\n                0.0,     y_scale, 0.0,     0.0,\n                0.0,     0.0,     z_scale, 0.0,\n                0.0,     0.0,     0.0,     1.0);\n}\n\nmat4 rotationZMatrix(float angle) {\n    float s = sin(angle);\n    float c = cos(angle);\n\n    return mat4( c,  s,  0., 0.,\n                -s,  c,  0., 0.,\n                 0., 0., 1., 0.,\n                 0., 0., 0., 1.);\n}\n\nmat4 rotationXMatrix(float angle) {\n    float s = sin(angle);\n    float c = cos(angle);\n\n    return mat4( 1.,  0., 0., 0.,\n                 0.,  c,  s,  0.,\n                 0., -s,  c,  0.,\n                 0.,  0., 0., 1.);\n}\n\nvoid main() {\n    vec4 pivot_pos = u_matrix * vec4(a_pos.xy, 0.0, 1.0);\n    highp float zoom_corner = a_pos.z;\n    lowp float min_zoom = floor(zoom_corner / 4.0);\n    lowp float corner = mod(zoom_corner, 4.0);\n\n    highp float u = texture2D(u_u_sampler, a_tex_coord).r;\n    highp float v = texture2D(u_v_sampler, a_tex_coord).r;\n\n    lowp float bb_aspect = u_bb_width / u_bb_height;\n    lowp float ang = atan(v, u) - 3.141592654 / 2.0;\n    highp float mag = length(vec2(u, v));\n    mag = floor(mag / u_bb_mag_bin_size + 0.5) * u_bb_mag_bin_size;\n\n    vec4 offset = vec4(0.0, 0.0, 0.0, 0.0);\n    vec2 texcoord = vec2(0.0, 0.0);\n    \n    if (u_zoom >= min_zoom) {\n        vec2 tex_loc = vec2(mod(mag, u_bb_mag_wrap) / u_bb_mag_bin_size * u_bb_width, floor(mag / u_bb_mag_wrap) * u_bb_height);\n\n        if (corner < 0.5) {\n            offset = vec4(-u_bb_size, u_bb_size, 0., 0.);\n            texcoord = tex_loc;\n        }\n        else if (corner < 1.5) {\n            offset = vec4(u_bb_size, u_bb_size, 0., 0.);\n            texcoord = tex_loc + vec2(u_bb_width, 0.0);\n        }\n        else if (corner < 2.5) {\n            offset = vec4(-u_bb_size, -u_bb_size * (2. / bb_aspect - 1.), 0., 0.);\n            texcoord = tex_loc + vec2(0.0, u_bb_height);\n        }\n        else if (corner < 3.5) {\n            offset = vec4(u_bb_size, -u_bb_size * (2. / bb_aspect - 1.), 0., 0.);\n            texcoord = tex_loc + vec2(u_bb_width, u_bb_height);\n        }\n\n        mat4 barb_rotation = rotationZMatrix(ang + radians(u_map_bearing));\n        mat4 map_stretch_matrix = scalingMatrix(1.0, 1. / u_map_aspect, 1.0);\n        offset = map_stretch_matrix * barb_rotation * offset;\n    }\n\n    gl_Position = pivot_pos + offset;\n    v_tex_coord = texcoord;\n}"},884:t=>{t.exports="#extension GL_OES_standard_derivatives : enable\n#define MAX_N_CONTOURS 40\n\nvarying highp vec2 v_tex_coord;\nvarying highp float v_grid_cell_size;\nvarying highp float v_map_scale_fac;\n\nuniform sampler2D u_fill_sampler;\nuniform highp float u_contour_interval;\nuniform highp float u_contour_levels[MAX_N_CONTOURS];\nuniform int u_num_contours;\nuniform lowp float u_line_cutoff;\nuniform lowp vec3 u_color;\nuniform lowp vec2 u_step_size;\nuniform lowp float u_zoom_fac;\n\nvoid main() {\n    highp float field_val = texture2D(u_fill_sampler, v_tex_coord).r;\n\n    lowp vec2 grid_point = fract(v_tex_coord / u_step_size + vec2(0.5, 0.5));\n    highp vec2 grid_sw = v_tex_coord - grid_point * u_step_size;\n\n    lowp vec2 ihat = vec2(u_step_size.x, 0.0);\n    lowp vec2 jhat = vec2(0.0, u_step_size.y);\n    highp float fv_sw = texture2D(u_fill_sampler, grid_sw).r;\n    highp float fv_se = texture2D(u_fill_sampler, grid_sw + ihat).r;\n    highp float fv_nw = texture2D(u_fill_sampler, grid_sw + jhat).r;\n    highp float fv_ne = texture2D(u_fill_sampler, grid_sw + ihat + jhat).r;\n\n    highp float dfdx = mix(fv_se, fv_ne, grid_point.y) - mix(fv_sw, fv_nw, grid_point.y);\n    highp float dfdy = mix(fv_nw, fv_ne, grid_point.x) - mix(fv_sw, fv_se, grid_point.x);\n    highp float fwidth_field = sqrt((dfdx * dfdx + dfdy * dfdy) / (5e5 * v_grid_cell_size));\n\n    lowp float plot_val;\n\n    if (u_num_contours > 0) {\n        highp float min_contour_diff = u_contour_levels[1] - u_contour_levels[0];\n        bool assigned_contour = false;\n        highp float low_contour;\n        highp float high_contour;\n        highp float highest_contour;\n\n        for (int ncnt = 0; ncnt < MAX_N_CONTOURS; ncnt++) {\n            if (ncnt >= u_num_contours) { break; }\n\n            min_contour_diff = min(min_contour_diff, u_contour_levels[ncnt + 1] - u_contour_levels[ncnt]);\n\n            if (u_contour_levels[ncnt] < field_val && field_val < u_contour_levels[ncnt + 1]) {\n                assigned_contour = true;\n\n                low_contour = u_contour_levels[ncnt];\n                high_contour = u_contour_levels[ncnt + 1];\n            }\n\n            highest_contour = u_contour_levels[ncnt];\n        }\n\n        if (!assigned_contour) {\n            if (field_val < u_contour_levels[0]) {\n                plot_val = (u_contour_levels[0] - field_val) / min_contour_diff;\n            }\n            else if (field_val > highest_contour) {\n                plot_val = (field_val - highest_contour) / min_contour_diff;\n            }\n        }\n        else {\n            plot_val = min(field_val - low_contour, high_contour - field_val) / min_contour_diff;\n        }\n    }\n    else {\n        plot_val = fract(field_val / u_contour_interval);\n        if (plot_val > 0.5) plot_val = 1.0 - plot_val;\n    }\n\n    plot_val = plot_val / (max(0.001, fwidth_field / (u_zoom_fac * 0.125)));\n\n    if (plot_val > u_line_cutoff) discard;\n\n    gl_FragColor = vec4(u_color, 1. - (plot_val * plot_val / (u_line_cutoff * u_line_cutoff)));\n}"},192:t=>{t.exports="uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute float a_grid_cell_size;\nattribute vec2 a_tex_coord;\n\nvarying highp vec2 v_tex_coord;\nvarying highp float v_grid_cell_size;\nvarying highp float v_map_scale_fac;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    v_tex_coord = a_tex_coord;\n    v_grid_cell_size = a_grid_cell_size;\n\n    // Figure out the latitude from the position vector\n    highp float lat = 2. * atan(exp(a_pos.y / 6371229.0)) - 3.1414592654 / 2.;\n    v_map_scale_fac = cos(lat);\n}"},824:t=>{t.exports="varying highp vec2 v_tex_coord;\n\nuniform sampler2D u_fill_sampler;\nuniform sampler2D u_cmap_sampler;\nuniform sampler2D u_cmap_nonlin_sampler;\nuniform highp float u_cmap_min;\nuniform highp float u_cmap_max;\nuniform highp float u_opacity;\nuniform int u_n_index;\n\nvoid main() {\n    lowp float index_buffer = 1. / (2. * float(u_n_index));\n    highp float fill_val = texture2D(u_fill_sampler, v_tex_coord).r;\n    lowp float normed_val = (fill_val - u_cmap_min) / (u_cmap_max - u_cmap_min);\n    \n    if (normed_val < 0.0 || normed_val > 1.0) {\n        discard;\n    }\n\n    normed_val = index_buffer + normed_val * (1. - 2. * index_buffer); // Chop off the half pixels on either end of the texture\n    highp float nonlin_val = texture2D(u_cmap_nonlin_sampler, vec2(normed_val, 0.5)).r;\n    lowp vec4 color = texture2D(u_cmap_sampler, vec2(nonlin_val, 0.5));\n    color.a = color.a * u_opacity;\n    gl_FragColor = color;\n}"},370:t=>{t.exports="uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_tex_coord;\n\nvarying highp vec2 v_tex_coord;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    v_tex_coord = a_tex_coord;\n}"},714:t=>{t.exports="#define MAX_N_COLORS 24\n\nvarying highp vec2 v_tex_coord;\n\nuniform sampler2D u_fill_sampler;\nuniform lowp vec4 u_colors[MAX_N_COLORS];\nuniform int u_num_colors;\nuniform highp float u_opacity;\n\nvoid main() {\n    highp float fill_val = texture2D(u_fill_sampler, v_tex_coord).r;\n    \n    if (fill_val < 0.5) {\n        discard;\n    }\n\n    lowp vec4 color = vec4(0., 0., 0., 0.);\n\n    for (int nclr = 0; nclr < MAX_N_COLORS ; nclr++) {\n        if (nclr >= u_num_colors || fill_val < 0.99) { break; }\n\n        lowp float mem_active = mod(fill_val, 2.);\n        color = mix(color, u_colors[nclr], mem_active);\n        fill_val = floor(fill_val / 2.);\n    }\n\n    color.a = color.a * u_opacity;\n    gl_FragColor = color;\n}"},431:t=>{t.exports="uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_tex_coord;\n\nvarying highp vec2 v_tex_coord;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    v_tex_coord = a_tex_coord;\n}"},559:t=>{t.exports="varying highp vec2 v_tex_coord;\n\nuniform sampler2D u_sampler;\n\nvoid main() {\n    if (v_tex_coord.x > 1.0) {\n        discard;\n    }\n\n    lowp vec4 tex_color = texture2D(u_sampler, v_tex_coord);\n    gl_FragColor = tex_color;\n}"},319:t=>{t.exports="uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute float a_min_zoom;\nattribute vec2 a_extrusion;\nattribute vec2 a_offset;\nattribute vec2 a_tex_coord;\nuniform lowp float u_offset_scale;\nuniform lowp float u_map_aspect;\nuniform lowp float u_zoom;\nuniform lowp float u_line_width;\nuniform highp float u_map_bearing;\n//uniform highp float u_map_pitch;\n\nvarying highp vec2 v_tex_coord;\n\nmat4 scalingMatrix(float x_scale, float y_scale, float z_scale) {\n    return mat4(x_scale, 0.0,     0.0,     0.0,\n                0.0,     y_scale, 0.0,     0.0,\n                0.0,     0.0,     z_scale, 0.0,\n                0.0,     0.0,     0.0,     1.0);\n}\n\nmat4 rotationZMatrix(float angle) {\n    float s = sin(angle);\n    float c = cos(angle);\n\n    return mat4( c,  s,  0., 0.,\n                -s,  c,  0., 0.,\n                    0., 0., 1., 0.,\n                    0., 0., 0., 1.);\n}\n\nmat4 rotationXMatrix(float angle) {\n    float s = sin(angle);\n    float c = cos(angle);\n\n    return mat4( 1.,  0., 0., 0.,\n                    0.,  c,  s,  0.,\n                    0., -s,  c,  0.,\n                    0.,  0., 0., 1.);\n}\n\nvoid main() {\n    vec4 center_pos = u_matrix * vec4(a_pos.xy, 0.0, 1.0);\n    vec4 offset = vec4(0.0, 0.0, 0.0, 0.0);\n    \n    if (u_zoom >= a_min_zoom) {\n        vec2 offset_2d = a_offset + u_line_width * a_extrusion;\n\n        mat4 rotation_matrix = rotationZMatrix(radians(u_map_bearing));\n        mat4 map_stretch_matrix = scalingMatrix(u_offset_scale, u_offset_scale / u_map_aspect, 1.);\n        offset = map_stretch_matrix * rotation_matrix * vec4(offset_2d, 0., 0.);\n    }\n\n    gl_Position = center_pos + offset;\n    v_tex_coord = a_tex_coord;\n}"}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.m=t,n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.u=t=>t+".autumnplot-gl.js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");r.length&&(t=r[r.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.b=document.baseURI||self.location.href;var r={};return(()=>{"use strict";n.r(r),n.d(r,{Barbs:()=>$n,ColorMap:()=>K,Contour:()=>H,ContourFill:()=>Fn,Grid:()=>Sr,Hodographs:()=>hr,LambertGrid:()=>Ir,MultiPlotLayer:()=>br,Paintball:()=>qn,PlateCarreeGrid:()=>Gr,PlateCarreeRotatedGrid:()=>Br,PlotComponent:()=>I,PlotLayer:()=>pr,Raster:()=>Cn,RawProfileField:()=>Pr,RawScalarField:()=>Mr,RawVectorField:()=>Or,colormaps:()=>Lr,makeColorBar:()=>gr,makePaintballKey:()=>yr});const t=Symbol("Comlink.proxy"),e=Symbol("Comlink.endpoint"),o=Symbol("Comlink.releaseProxy"),i=Symbol("Comlink.thrown"),a=t=>"object"==typeof t&&null!==t||"function"==typeof t,c=new Map([["proxy",{canHandle:e=>a(e)&&e[t],serialize(t){const{port1:e,port2:n}=new MessageChannel;return l(t,e),[n,[n]]},deserialize:t=>(t.start(),u(t))}],["throw",{canHandle:t=>a(t)&&i in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function l(e,n=self){n.addEventListener("message",(function r(o){if(!o||!o.data)return;const{id:a,type:c,path:u}=Object.assign({path:[]},o.data),f=(o.data.argumentList||[]).map(b);let h;try{const n=u.slice(0,-1).reduce(((t,e)=>t[e]),e),r=u.reduce(((t,e)=>t[e]),e);switch(c){case"GET":h=r;break;case"SET":n[u.slice(-1)[0]]=b(o.data.value),h=!0;break;case"APPLY":h=r.apply(n,f);break;case"CONSTRUCT":h=function(e){return Object.assign(e,{[t]:!0})}(new r(...f));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;l(e,n),h=function(t,e){return d.set(t,e),t}(t,[t])}break;case"RELEASE":h=void 0;break;default:return}}catch(t){h={value:t,[i]:0}}Promise.resolve(h).catch((t=>({value:t,[i]:0}))).then((t=>{const[e,o]=p(t);n.postMessage(Object.assign(Object.assign({},e),{id:a}),o),"RELEASE"===c&&(n.removeEventListener("message",r),s(n))}))})),n.start&&n.start()}function s(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function u(t,e){return h(t,[],e)}function f(t){if(t)throw new Error("Proxy has been released and is not useable")}function h(t,n=[],r=function(){}){let i=!1;const a=new Proxy(r,{get(e,r){if(f(i),r===o)return()=>v(t,{type:"RELEASE",path:n.map((t=>t.toString()))}).then((()=>{s(t),i=!0}));if("then"===r){if(0===n.length)return{then:()=>a};const e=v(t,{type:"GET",path:n.map((t=>t.toString()))}).then(b);return e.then.bind(e)}return h(t,[...n,r])},set(e,r,o){f(i);const[a,c]=p(o);return v(t,{type:"SET",path:[...n,r].map((t=>t.toString())),value:a},c).then(b)},apply(r,o,a){f(i);const c=n[n.length-1];if(c===e)return v(t,{type:"ENDPOINT"}).then(b);if("bind"===c)return h(t,n.slice(0,-1));const[l,s]=_(a);return v(t,{type:"APPLY",path:n.map((t=>t.toString())),argumentList:l},s).then(b)},construct(e,r){f(i);const[o,a]=_(r);return v(t,{type:"CONSTRUCT",path:n.map((t=>t.toString())),argumentList:o},a).then(b)}});return a}function _(t){const e=t.map(p);return[e.map((t=>t[0])),(n=e.map((t=>t[1])),Array.prototype.concat.apply([],n))];var n}const d=new WeakMap;function p(t){for(const[e,n]of c)if(n.canHandle(t)){const[r,o]=n.serialize(t);return[{type:"HANDLER",name:e,value:r},o]}return[{type:"RAW",value:t},d.get(t)||[]]}function b(t){switch(t.type){case"HANDLER":return c.get(t.name).deserialize(t.value);case"RAW":return t.value}}function v(t,e,n){return new Promise((r=>{const o=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");t.addEventListener("message",(function e(n){n.data&&n.data.id&&n.data.id===o&&(t.removeEventListener("message",e),r(n.data))})),t.start&&t.start(),t.postMessage(Object.assign({id:o},e),n)}))}var m=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},g=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},y=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},w=function(t,e){e=void 0===e?"float":e;var n=t.match(/#([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?/i);if(null===n)throw"Got '".concat(t,"' in hex2rgba, which does not look like a hex color");var r=n.slice(1).filter((function(t){return void 0!==t})).map((function(t){return parseInt(t,16)}));return"float"==e&&(r=r.map((function(t){return t/255}))),void 0===r[3]?[r[0],r[1],r[2],1]:[r[0],r[1],r[2],r[3]]},x=function(t,e){var n=g(w(t,e),4),r=n[0],o=n[1],i=n[2];return n[3],[r,o,i]},E=function(t,e){var n=g(t,3);return function(t,e){var n=t;return"float"==(e=void 0===e?"float":e)&&(n=n.map((function(t){return Math.round(255*t)}))),"#"+n.map((function(t){return t.toString(16).padStart(2,"0").toUpperCase()})).join("")}([n[0],n[1],n[2],0],e).slice(0,-2)},T=function(t){var e,n=g(t,3),r=n[0],o=n[1],i=n[2],a=Math.max(r,o,i),c=a-Math.min(r,o,i);return 0==c?e=0:a==r?e=(o-i)/c*60%6:a==o?e=60*((i-r)/c+2):a==i&&(e=60*((r-o)/c+4)),[e,0==a?0:c/a,a]},R=function(t){var e,n,r,o=g(t,3),i=o[0],a=o[1],c=o[2],l=c*a,s=l*(1-Math.abs(i/60%2-1)),u=c-l;return 0<=i&&i<60?(e=l,n=s,r=0):60<=i&&i<120?(e=s,n=l,r=0):120<=i&&i<180?(e=0,n=l,r=s):180<=i&&i<240?(e=0,n=s,r=l):240<=i&&i<300?(e=s,n=0,r=l):300<=i&&i<360&&(e=l,n=0,r=s),[e+u,n+u,r+u]};function A(t,e,n){for(var r=1,o=n;t%o!=0||e%o!=0;)r+=1,o/=2;return r}function S(){var t,e,n,r=[];for(t=0;t<arguments.length;t++)r[t]=arguments[t];return m(this,(function(t){switch(t.label){case 0:e=r.map((function(t){return t[Symbol.iterator]()})),t.label=1;case 1:return(n=e.map((function(t){return t.next()}))).some((function(t){return t.done}))?[3,3]:[4,n.map((function(t){return t.value}))];case 2:return t.sent(),[3,1];case 3:return[2]}}))}var G=function(){function t(t){this.cached_value=null,this.compute_value=t}return t.prototype.getValue=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return null===this.cached_value&&(this.cached_value=this.compute_value.apply(this,y([],g(t),!1))),this.cached_value},t}(),B=u(new Worker(new URL(n.p+n.u(110),n.b))),I=function(){};function N(t,e){var n,r,o,i,a,c,l,s=function(t){return t.getParameter(t.VERSION).includes("WebGL 2.0")}(t);if(e){var u=t.getExtension("OES_texture_half_float"),f=t.getExtension("OES_texture_half_float_linear");if(!s&&null===u||!s&&null===f)throw"Float16 data are not supported on this hardware. Try Float32 data instead.";n=s?t.R16F:t.LUMINANCE,r=s?t.HALF_FLOAT:u.HALF_FLOAT_OES,o=2}else{if(u=t.getExtension("OES_texture_float"),f=t.getExtension("OES_texture_float_linear"),!s&&null===u||!s&&null===f||"iOS"===(i=window.navigator.userAgent,a=window.navigator.platform,l=null,-1!==(c=["Macintosh","MacIntel","MacPPC","Mac68K"]).indexOf(a)&&navigator.maxTouchPoints<=1?l="Mac OS":-1!==["iPhone","iPad","iPod"].indexOf(a)||-1!==c.indexOf(a)&&navigator.maxTouchPoints>1?l="iOS":-1!==["Win32","Win64","Windows","WinCE"].indexOf(a)?l="Windows":/Android/.test(i)?l="Android":/Linux/.test(a)&&(l="Linux"),l))throw"Float32 data are not supported on this hardware. Try Float16 data instead.";n=s?t.R32F:t.LUMINANCE,r=t.FLOAT,o=4}return{format:n,type:r,row_alignment:o}}class M{constructor(t,e,n,r){const o={Float32Array:t.FLOAT,Uint8Array:t.UNSIGNED_BYTE};this.gl=t,this.n_coords_per_vert=n,this.dtype=o[e.constructor.name],this.n_verts=e.length/n,this.draw_mode=r;const i=t.createBuffer();if(null===i)throw"Could not create WebGL buffer";this.buffer=i,t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)}bindToProgram(t){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer),this.gl.enableVertexAttribArray(t),this.gl.vertexAttribPointer(t,this.n_coords_per_vert,this.dtype,!1,0,0)}}class O{constructor(t,e){this.gl=t;const n=t.createTexture();if(null===n)throw"Could not create WebGL texture";this.texture=n,this.tex_num=null,this.setImageData(e);const r=void 0===e.mag_filter?t.LINEAR:e.mag_filter;t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,r)}setImageData(t){const e=this.gl;e.bindTexture(e.TEXTURE_2D,this.texture);const n=function(t){return t.getParameter(t.VERSION).includes("WebGL 2.0")}(e)?function(t,e,n){switch(n){case t.UNSIGNED_BYTE:switch(e){case t.RGBA8:case t.RGB5_A1:case t.RGBA4:case t.SRGB8_ALPHA8:return t.RGBA;case t.RGBA8UI:return t.RGBA_INTEGER;case t.RGB8:case t.RGB565:case t.SRGB8:return t.RGB;case t.RGB8UI:return t.RGB_INTEGER;case t.RG8:return t.RG;case t.RG8UI:return t.RG_INTEGER;case t.R8:return t.RED;case t.R8UI:return t.RED_INTEGER;case t.RGBA:return t.RGBA;case t.RGB:return t.RGB;case t.LUMINANCE_ALPHA:return t.LUMINANCE_ALPHA;case t.LUMINANCE:return t.LUMINANCE;case t.ALPHA:return t.ALPHA}break;case t.BYTE:switch(e){case t.RGBA8_SNORM:return t.RGBA;case t.RGBA8I:return t.RGBA_INTEGER;case t.RGB8_SNORM:return t.RGB;case t.RGB8I:return t.RGB_INTEGER;case t.RG8_SNORM:return t.RG;case t.RG8I:return t.RG_INTEGER;case t.R8_SNORM:return t.RED;case t.R8I:return t.RED_INTEGER}break;case t.UNSIGNED_SHORT_4_4_4_4:switch(e){case t.RGBA4:case t.RGBA:return t.RGBA}break;case t.UNSIGNED_SHORT_5_5_5_1:switch(e){case t.RGB5_A1:case t.RGBA:return t.RGBA}break;case t.UNSIGNED_INT_2_10_10_10_REV:switch(e){case t.RGB10_A2:case t.RGB5_A1:return t.RGBA;case t.RGB10_A2UI:return t.RGBA_INTEGER}break;case t.HALF_FLOAT:switch(e){case t.RGBA16F:return t.RGBA;case t.RGB16F:case t.R11F_G11F_B10F:case t.RGB9_E5:return t.RGB;case t.RG16F:return t.RG;case t.R16F:return t.RED}break;case t.FLOAT:switch(e){case t.RGBA32F:case t.RGBA16F:return t.RGBA;case t.RGB32F:case t.RGB16F:case t.R11F_G11F_B10F:case t.RGB9_E5:return t.RGB;case t.RG32F:case t.RG16F:return t.RG;case t.R32F:case t.R16F:return t.RED;case t.DEPTH_COMPONENT32F:return t.DEPTH_COMPONENT}break;case t.UNSIGNED_SHORT:switch(e){case t.RGBA16UI:return t.RGBA_INTEGER;case t.RGB16UI:return t.RGB_INTEGER;case t.RG16UI:return t.RG_INTEGER;case t.R16UI:return t.RED_INTEGER;case t.DEPTH_COMPONENT16:return t.DEPTH_COMPONENT}break;case t.SHORT:switch(e){case t.RGBA16I:return t.RGBA_INTEGER;case t.RGB16I:return t.RGB_INTEGER;case t.RG16I:return t.RG_INTEGER;case t.R16I:return t.RED_INTEGER}break;case t.UNSIGNED_INT:switch(e){case t.RGBA32UI:return t.RGBA_INTEGER;case t.RGB32UI:return t.RGB_INTEGER;case t.RG32UI:return t.RG_INTEGER;case t.R32UI:return t.RED_INTEGER;case t.DEPTH_COMPONENT24:case t.DEPTH_COMPONENT16:return t.DEPTH_COMPONENT}break;case t.INT:switch(e){case t.RGBA32I:return t.RGBA_INTEGER;case t.RGB32I:return t.RGB_INTEGER;case t.RG32I:return t.RG_INTEGER;case t.R32I:return t.RED_INTEGER}break;case t.UNSIGNED_SHORT_5_6_5:switch(e){case t.RGB565:case t.RGB:return t.RGB}break;case t.UNSIGNED_INT_10F_11F_11F_REV:if(e===t.R11F_G11F_B10F)return t.RGB;break;case t.UNSIGNED_INT_5_9_9_9_REV:if(e===t.RGB9_E5)return t.RGB;break;case t.UNSIGNED_INT_24_8:if(e===t.DEPTH24_STENCIL8)return t.DEPTH_STENCIL;break;case t.FLOAT_32_UNSIGNED_INT_24_8_REV:if(e===t.DEPTH32F_STENCIL8)return t.DEPTH_STENCIL;break;default:throw"Unknown format in getWebGL2InternalFormat"}throw"Invalid combination of internal format and data type"}(e,t.format,t.type):t.format,r=void 0===t.row_alignment?4:t.row_alignment;e.pixelStorei(e.UNPACK_ALIGNMENT,r),void 0!==t.width&&void 0!==t.height?e.texImage2D(e.TEXTURE_2D,0,t.format,t.width,t.height,0,n,t.type,t.image):e.texImage2D(e.TEXTURE_2D,0,t.format,n,t.type,t.image)}bindToProgram(t,e){this.activate(e),this.gl.uniform1i(t,e)}activate(t){this.tex_num=t,this.gl.activeTexture(this.gl.TEXTURE0+this.tex_num),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture)}deactivate(){null!==this.tex_num&&(this.gl.activeTexture(this.gl.TEXTURE0+this.tex_num),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.tex_num=null)}delete(){this.gl.deleteTexture(this.texture),this.tex_num=null}}class P{constructor(t,e,n){this.gl=t,this.prog=((t,e,n)=>{const r=t.createShader(t.VERTEX_SHADER);if(null===r)throw"Could not create vertex shader";if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){const e=t.getShaderInfoLog(r);console.log("Vertex shader compiler log: "+e)}const o=t.createShader(t.FRAGMENT_SHADER);if(null===o)throw"Could not create fragment shader";if(t.shaderSource(o,n),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS)){const e=t.getShaderInfoLog(o);console.log("Fragment shader compiler log: "+e)}const i=t.createProgram();if(null===i)throw"Could not create shader program";if(t.attachShader(i,r),t.attachShader(i,o),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS)){const e=t.getProgramInfoLog(i);console.log("Linker log: "+e)}return i})(t,e,n),this.attributes={},this.uniforms={},this.n_verts=null,this.draw_mode=null;const r=t=>{const e=t.indexOf("//");return e>=0&&(t=t.slice(0,e)),t};e=e.split("\n").map(r).join("\n"),n=n.split("\n").map(r).join("\n");for(const n of e.matchAll(/attribute +([\w ]+?) +([\w_]+);[\s]*$/gm)){const[e,r,o]=n;this.attributes[o]={type:r,location:t.getAttribLocation(this.prog,o)}}for(const n of e.matchAll(/uniform +([\w ]+?) +([\w_]+)(?:[\s]*\[.*\])?;[\s]*$/gm)){const[e,r,o]=n,i=r.split(" "),a=t.getUniformLocation(this.prog,o);if(null===a)throw`Could not get vertex shader uniform location for '${o}'`;this.uniforms[o]={type:i[i.length-1],location:a}}for(const e of n.matchAll(/uniform +([\w ]+?) +([\w_]+)(?:[\s]*\[.*\])?;[\s]*$/gm)){const[n,r,o]=e,i=r.split(" "),a=t.getUniformLocation(this.prog,o);if(null===a)throw`Could not get fragment shader uniform location for '${o}'`;this.uniforms[o]={type:i[i.length-1],location:a}}}use(t,e,n){this.gl.useProgram(this.prog),this.draw_mode=null,this.n_verts=null,void 0!==t&&this.bindAttributes(t),void 0!==e&&this.setUniforms(e),void 0!==n&&this.bindTextures(n)}bindAttributes(t){Object.entries(t).forEach((([t,e])=>{if(void 0===this.attributes[t])return void console.warn(`Skipping attribute buffer provided for '${t}' because the attribute was not found in the program.`);if(this.n_verts=null===this.n_verts?e.n_verts:this.n_verts,this.draw_mode=null===this.draw_mode?e.draw_mode:this.draw_mode,this.draw_mode!=e.draw_mode)throw`Unexpected draw mode for attribute buffer ${t} (expected ${this.draw_mode}, got ${e.draw_mode}).`;if(this.n_verts!=e.n_verts)throw`Unexpected number of vertices for attribute buffer ${t} (expected ${this.n_verts}, got ${e.n_verts}).`;const{type:n,location:r}=this.attributes[t];e.bindToProgram(r)}))}setUniforms(t){Object.entries(t).forEach((([t,e])=>{if(void 0===this.uniforms[t])return void console.warn(`Skipping uniform value provided for '${t}' because the uniform was not found in the program.`);const{type:n,location:r}=this.uniforms[t];if("int"===n&&"number"==typeof e)this.gl.uniform1i(r,e);else if("float"===n&&"number"==typeof e)this.gl.uniform1f(r,e);else if("float"===n&&e instanceof Array)this.gl.uniform1fv(r,e);else if("vec2"===n&&e instanceof Array)this.gl.uniform2fv(r,e);else if("vec3"===n&&e instanceof Array)this.gl.uniform3fv(r,e);else if("vec4"===n&&e instanceof Array)this.gl.uniform4fv(r,e);else{if(!("mat4"===n&&e instanceof Array))throw`Could not figure out uniform function for type '${n}' and value '${String(e)}'`;this.gl.uniformMatrix4fv(r,!1,e)}}))}bindTextures(t){Object.entries(t).forEach((([t,e],n)=>{if(void 0===this.uniforms[t])return void console.warn(`Skipping texture provided for sampler '${t}' because the sampler was not found in the program.`);const{type:r,location:o}=this.uniforms[t];e.bindToProgram(o,n)}))}draw(){if(null===this.draw_mode||null===this.n_verts)throw"Cannot draw without binding attribute buffers";this.gl.drawArrays(this.draw_mode,0,this.n_verts)}}class L{constructor(t,e){this.gl=t,this.framebuffer=e}clear(t){const e=this.gl;if(null===e)throw"Register WebGL drawing context using registerGLContext() first";e.clearColor(...t),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),e.clear(e.COLOR_BUFFER_BIT)}renderTo(t,e,n,r){const o=this.gl;if(null===o)throw"Register WebGL drawing context using registerGLContext() first";o.bindFramebuffer(o.FRAMEBUFFER,this.framebuffer),o.viewport(t,e,n,r)}copyToTexture(t,e,n,r,o){const i=this.gl;if(null===i)throw"Register WebGL drawing context using registerGLContext() first";i.bindFramebuffer(i.FRAMEBUFFER,this.framebuffer),t.activate(0),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,e,n,r,o,0)}}new class extends L{constructor(){super(null,null)}registerGLContext(t){this.gl=t}};var j,D=(j=function(t,e){return j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},j(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}j(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),C=function(){return C=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},C.apply(this,arguments)},F=n(192),k=n(884),U=new G((function(t){return new P(t,F,k)}));const H=function(t){function e(e,n){var r=t.call(this)||this;r.field=e,r.interval=n.interval||1,r.levels=n.levels||[];var o=w(n.color||"#000000");return r.color=[o[0],o[1],o[2]],r.thinner=n.thinner||function(){return 1},r.gl_elems=null,r}return D(e,t),e.prototype.onAdd=function(t,e){return n=this,r=void 0,i=function(){var n,r,o,i,a,c,l,s,u,f,h,_,d,p;return function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(b){switch(b.label){case 0:return e.getExtension("OES_standard_derivatives"),n=U.getValue(e),[4,this.field.grid.getWGLBuffers(e)];case 1:return r=b.sent(),o=r.vertices,i=r.texcoords,a=r.cellsize,c=o,l=i,s=a,u=N(e,this.field.isFloat16()),f=u.format,h=u.type,_=u.row_alignment,d={format:f,type:h,width:this.field.grid.ni,height:this.field.grid.nj,image:this.field.getTextureData(),mag_filter:e.LINEAR,row_alignment:_},p=new O(e,d),this.gl_elems={map:t,program:n,vertices:c,texcoords:l,grid_cell_size:s,fill_texture:p},[2]}}))},new((o=void 0)||(o=Promise))((function(t,e){function a(t){try{l(i.next(t))}catch(t){e(t)}}function c(t){try{l(i.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(a,c)}l((i=i.apply(n,r||[])).next())}));var n,r,o,i},e.prototype.render=function(t,e){if(null!==this.gl_elems){var n=this.gl_elems,r=n.map.getZoom(),o=this.thinner(r)*this.interval,i=.3/o,a=[1/this.field.grid.ni,1/this.field.grid.nj],c=Math.pow(2,r),l={u_contour_interval:o,u_line_cutoff:i,u_color:this.color,u_step_size:a,u_zoom_fac:c,u_matrix:e,u_num_contours:0,u_contour_levels:[0]};this.levels.length>0&&(l=C(C({},l),{u_num_contours:this.levels.length,u_contour_levels:this.levels})),n.program.use({a_pos:n.vertices,a_grid_cell_size:n.grid_cell_size,a_tex_coord:n.texcoords},l,{u_fill_sampler:n.fill_texture}),t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),n.program.draw()}},e}(I),z=JSON.parse('{"g":[20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140],"O":["#e6f4ff","#dbf0fe","#d1ebfe","#c6e7fd","#bce3fd","#b1dffc","#a7dbfc","#9cd6fb","#92d2fb","#87cefa","#84c2f6","#81b7f1","#7eabed","#7ba0e8","#7994e4","#7688df","#737ddb","#7071d6","#6d66d2","#6a5acd","#7660cf","#8366d0","#8f6cd2","#9c72d3","#a878d5","#b47ed6","#c184d8","#cd8ad9","#da90db","#e696dc","#e390d9","#e08ad6","#dd84d3","#da7ed0","#d778cd","#d472ca","#d16cc7","#ce66c4","#cb60c1","#c85abe","#c453ba","#c04cb6","#bc45b2","#b83eae","#b437aa","#b030a6","#ac29a2","#a8229e","#a41b9a","#a01496","#a41080","#a80e75","#ac0e75","#b00c6a","#b4085f","#b80649","#bc043e","#c00233","#c80028","#c80028","#ca042a","#cc082c","#d00c2c","#d21432","#d41834","#d41834","#d61c36","#da243a","#dc283c","#de2c3e","#e03040","#e23442","#e43844","#e63c46","#e84048","#ea444a","#ec484c","#ee4c4e","#f05050","#f16052","#f27054","#f38056","#f49058","#f5a05a","#f6b05c","#f7c05e","#f8d060","#f9e062","#faf064","#f7eb61","#f4e65e","#f1e15b","#eedc58","#ebd755","#e8d252","#e5cd4f","#e2c84c","#dfc349","#dcbe46","#d9b943","#d6b440","#d3af3d","#d0aa3a","#cda537","#caa034","#c79b31","#c4962e","#c1912b","#be8c28","#bb8725","#b88222","#b57d1f","#b2781c","#af7319","#ac6e16","#a96913","#a66410","#a35f0d","#a05a0a","#a05a0a"]}'),W=JSON.parse('{"g":[20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80],"O":["#f0f8ff","#dbf0fe","#c6e7fd","#b1dffc","#9cd6fb","#87cefa","#81b7f1","#7ba0e8","#7688df","#7071d6","#6a5acd","#8366d0","#9c72d3","#b47ed6","#cd8ad9","#e696dc","#e08ad6","#da7ed0","#d472ca","#ce66c4","#c85abe","#c04cb6","#b83eae","#b030a6","#a8229e","#a01496","#a81080","#b00c6a","#b8043e","#c80028","#c80028","#d01030","#d41834","#d82038","#dc283c","#e03040","#e43844","#e84048","#ec484c","#f05050","#f27054","#f49058","#f6b05c","#f8d060","#faf064","#f4e65e","#eedc58","#e8d252","#e2c84c","#dcbe46","#d6b440","#d0aa3a","#caa034","#c4962e","#be8c28","#b88222","#b2781c","#ac6e16","#a66410","#a05a0a"]}'),X=JSON.parse('{"g":[0,100,200,300,400,500,600,700,800,900,1000,1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,3100,3200,3300,3400,3500,3600,3700,3800,3900,4000,4100,4200,4300,4400,4500,4600,4700,4800,4900,5000,5100,5200,5300,5400,5500,5600,5700,5800,5900,6000,6500,7000,7500,8000,8500,9000,9500,10000],"O":["#ffffff","#f0f0f0","#e1e1e1","#d2d2d2","#c3c3c3","#a5a5a5","#969696","#878787","#787878","#696969","#37536a","#436075","#506d80","#5c7a8b","#698796","#7594a2","#82a1ad","#8eaeb8","#9bbbc3","#a7c8ce","#e9dd96","#e8d186","#e7c575","#e6b865","#e5ac54","#e5a044","#e49433","#e38723","#e27b12","#e16f02","#dc4110","#d33b17","#ca351e","#c12e25","#b8282c","#af2234","#a61c3b","#9d1542","#940f49","#8b0950","#73088a","#7e1894","#8a289f","#9538a9","#a148b3","#ac59be","#b869c8","#c379d2","#cf89dd","#da99e7","#e9bec3","#e3b0b7","#dda3ac","#d795a0","#d18894","#ca7a89","#c46d7d","#be5f71","#b85266","#b2445a","#893d48","#8f4752","#96525b","#9c5c65","#a2676f","#a97178","#af7c82","#b6868b"]}'),V=JSON.parse('{"g":[-60,-59,-58,-57,-56,-55,-54,-53,-52,-51,-50,-49,-48,-47,-46,-45,-44,-43,-42,-41,-40,-39,-38,-37,-36,-35,-34,-33,-32,-31,-30,-29,-28,-27,-26,-25,-24,-23,-22,-21,-20,-19,-18,-17,-16,-15,-14,-13,-12,-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120],"O":["#235877","#2a5f7c","#316782","#396e87","#40768c","#477d91","#4e8497","#558c9c","#5d93a1","#649ba6","#6ba2ac","#72a9b1","#79b1b6","#81b8bb","#88c0c1","#8fc7c6","#96cecb","#9dd6d0","#a5ddd6","#ace5db","#b3ece0","#b3ece0","#b1e7df","#b0e1dd","#aedcdc","#add7da","#abd2d9","#aaccd8","#a8c7d6","#a7c2d5","#a5bcd4","#a4b7d2","#a2b2d1","#9fa7ce","#9ea2cd","#9c9dcb","#9c9dcb","#9b97ca","#9992c8","#988dc7","#9688c6","#9582c4","#9278c2","#9073c0","#8f6dbf","#8d68bd","#8c63bc","#8a5dbb","#8958b9","#8753b8","#864eb6","#8448b5","#8343b4","#813eb2","#8038b1","#7e33b0","#7d33ae","#7b29ad","#7a23ab","#781eaa","#a037af","#a443b3","#a74fb7","#ab5cbb","#af68bf","#b374c3","#b680c7","#ba8dcc","#be99d0","#c1a5d4","#c5b1d8","#c9bddc","#cdcae0","#d0d6e4","#d4e2e8","#deecf2","#d1e2ee","#c5d9ea","#b8cfe6","#acc5e3","#9fbbdf","#92b2db","#86a8d7","#799ed3","#6c94cf","#608bcb","#5381c7","#4777c4","#3a6dc0","#2d64bc","#215ab8","#1450b4","#0f4455","#1c4e5a","#2a585f","#376363","#456d68","#52776d","#5f8172","#6d8c77","#7a967c","#88a080","#95aa85","#a3b58a","#b0bf8f","#bdc994","#cbd399","#d8de9d","#e6e8a2","#f3f2a7","#f8eea2","#f0e199","#e8d591","#e1c888","#d9bc80","#d1af77","#c9a36f","#c19666","#ba8a5e","#b27d55","#aa714d","#a26444","#9b583c","#8b3f2b","#833222","#7b261a","#7b261a","#741911","#6c0d09","#640000","#5f0000","#630507","#670a0e","#6c0f15","#70141c","#741824","#781d2b","#7d2232","#812739","#852c40","#73372d","#7a4036","#80493f","#875349","#8e5c52","#94655b","#9b6e64","#a88177","#af8a80","#b69389","#bd9c92","#c3a69c","#caafa5","#d1b8ae","#d7c1b7","#decac0","#e5d4ca","#ebddd3","#f2e6dc","#e8dfd6","#e0d7cf","#d8d0c8","#d0c8c0","#c8c0b9","#c0b9b2","#b7b1ab","#afa9a4","#a7a29c","#9f9a95","#97938e","#8f8b87","#878380","#7f7c78","#777471","#6f6c6a","#666563","#5e5d5c","#565554","#4e4e4d","#464646"]}'),$=JSON.parse('{"g":[-40,-39,-38,-37,-36,-35,-34,-33,-32,-31,-30,-29,-28,-27,-26,-25,-24,-23,-22,-21,-20,-19,-18,-17,-16,-15,-14,-13,-12,-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90],"O":["#986d4d","#966c4c","#946b4c","#926a4b","#90694b","#8e684a","#8c664a","#8a6549","#886448","#866348","#846247","#826147","#806046","#7e5f46","#7c5e45","#7a5d44","#785b44","#765a43","#745943","#725842","#715742","#6f5641","#6d5540","#6b5440","#69533f","#67523f","#65503e","#634f3d","#614e3d","#5f4d3c","#5d4c3c","#5b4b3b","#594a3b","#57493a","#554839","#534739","#514538","#4f4438","#4d4337","#4b4237","#494136","#4d4334","#514738","#564c3c","#5a5041","#5e5545","#625949","#675e4d","#6b6251","#6f6755","#746b5a","#78705e","#7c7462","#807966","#857d6a","#89826f","#8d8673","#928b77","#968f7b","#9a947f","#9e9883","#a39d88","#a7a18c","#aba690","#afaa94","#b8b39c","#b8b39c","#bcb8a1","#c1bca5","#c9c5ad","#c9cab1","#d2ceb6","#d2ceb6","#d6d3ba","#dfdcc2","#e3e0c6","#e7e5ca","#ebe9cf","#f0eed3","#f4f2d7","#e6f5e6","#d7f0d7","#c8eac8","#b9e5b9","#aadfaa","#9bda9b","#8cd48c","#7dcf7d","#6ec96e","#5fc45f","#30ae30","#2ca32c","#279927","#238e23","#1e831e","#1a791a","#156e15","#116311","#0c590c","#084e08","#61a3af","#5896a0","#508992","#477b83","#3e6e74","#366166","#2d5457","#244648","#1c393a","#132c2b","#66669a","#605e94","#59568e","#534e88","#4d4682","#463e7c","#403676","#3a2e70","#33266a","#2d1e64","#724071","#784573","#7d4b75","#835076","#885678","#8e5b7a","#93617c","#99667d","#9e6c7f","#a47181"]}'),Y=JSON.parse('{"g":[-15,-14.53608247,-14.07216495,-13.60824742,-13.1443299,-12.68041237,-12.21649485,-11.75257732,-11.28865979,-10.82474227,-10.36082474,-9.89690722,-9.43298969,-8.96907216,-8.50515464,-8.04123711,-7.57731959,-7.11340206,-6.64948454,-6.18556701,-5.72164948,-5.25773196,-4.79381443,-4.32989691,-3.86597938,-3.40206186,-2.93814433,-2.4742268,-2.01030928,-1.54639175,-1.08247423,-0.6185567,-0.15463918,0.30927835,0.77319588,1.2371134,1.70103093,2.16494845,2.62886598,3.09278351,3.55670103,4.02061856,4.48453608,4.94845361,5.41237113,5.87628866,6.34020619,6.80412371,7.26804124,7.73195876,8.19587629,8.65979381,9.12371134,9.58762887,10.05154639,10.51546392,10.97938144,11.44329897,11.90721649,12.37113402,12.83505155,13.29896907,13.7628866,14.22680412,14.69072165,15.15463918,15.6185567,16.08247423,16.54639175,17.01030928,17.4742268,17.93814433,18.40206186,18.86597938,19.32989691,19.79381443,20.25773196,20.72164948,21.18556701,21.64948454,22.11340206,22.57731959,23.04123711,23.50515464,23.96907216,24.43298969,24.89690722,25.36082474,25.82474227,26.28865979,26.75257732,27.21649485,27.68041237,28.1443299,28.60824742,29.07216495,29.53608247,30,30.46391753,30.92783505,31.39175258,31.8556701,32.31958763,32.78350515,33.24742268,33.71134021,34.17525773,34.63917526,35.10309278,35.56701031,36.03092784,36.49484536,36.95876289,37.42268041,37.88659794,38.35051546,38.81443299,39.27835052,39.74226804,40.20618557,40.67010309,41.13402062,41.59793814,42.06185567,42.5257732,42.98969072,43.45360825,43.91752577,44.3814433,44.84536082,45.30927835,45.77319588,46.2371134,46.70103093,47.16494845,47.62886598,48.09278351,48.55670103,49.02061856,49.48453608,49.94845361,50.41237113,50.87628866,51.34020619,51.80412371,52.26804124,52.73195876,53.19587629,53.65979381,54.12371134,54.58762887,55.05154639,55.51546392,55.97938144,56.44329897,56.90721649,57.37113402,57.83505155,58.29896907,58.7628866,59.22680412,59.69072165,60.15463918,60.6185567,61.08247423,61.54639175,62.01030928,62.4742268,62.93814433,63.40206186,63.86597938,64.32989691,64.79381443,65.25773196,65.72164948,66.18556701,66.64948454,67.11340206,67.57731959,68.04123711,68.50515464,68.96907216,69.43298969,69.89690722,70.36082474,70.82474227,71.28865979,71.75257732,72.21649485,72.68041237,73.1443299,73.60824742,74.07216495,74.53608247,75],"O":["#959052","#979356","#9c9a60","#a09c64","#a3a067","#a8a570","#aaa875","#acac79","#b1b182","#b5b587","#b6b88c","#bcbd93","#bfc199","#c1c39c","#c1c39c","#c6caa5","#cacdaa","#cccfaf","#cfd1b3","#cccfb3","#c8ccb3","#c6c8b3","#bfc3b3","#bfc3b3","#bcc1b3","#b8bdb3","#b5bab3","#afb5b3","#acb3b3","#aaafb3","#a7aeb3","#a3aab3","#a0a8b3","#9ca5b3","#9aa1b3","#97a0b3","#939cb3","#909ab3","#939ab5","#8c95b3","#8791b1","#838eb1","#808caf","#7c89af","#7785ae","#7482ac","#7080aa","#6b7caa","#6275a8","#5e72a7","#5e72a7","#5b70a5","#566da3","#5269a3","#4f67a1","#4b64a1","#4660a0","#425d9e","#4260a1","#4467a5","#486eaa","#4975ae","#4d7cb1","#4f83b5","#508aba","#5491bf","#5699c3","#599ec6","#5ba5ca","#5daccf","#60b3d4","#62bad8","#64c1db","#67c8df","#69cfe4","#6ed6e8","#67d6d6","#60d6c4","#59d6b3","#52d6a1","#4bd690","#42d67e","#3bd66d","#34d65b","#11d418","#11d116","#0fcd16","#0fc816","#0fc316","#0fbf15","#0fbc15","#0fb613","#0eb313","#0eaf13","#0eaa13","#0ca511","#0ca111","#0c9e11","#0c9911","#0c950f","#0c900f","#0a8c0f","#0a870f","#0a830e","#0a800e","#0a7c0c","#0a770c","#08720c","#086e0c","#086b0a","#08660a","#08620a","#085d08","#1c6708","#317208","#467c08","#5b8707","#6e9107","#839c05","#97a805","#acb105","#c1bc05","#d6c603","#e9d103","#ffe200","#ffd800","#ffd300","#ffc800","#ffc300","#ffba00","#ffb500","#ffb000","#ffac00","#ffa700","#ff9e00","#ff9900","#ff9300","#ff8900","#ff8500","#ff7f00","#ff0000","#f70000","#f00000","#e90000","#e20000","#db0000","#d40000","#cd0000","#c60000","#bf0000","#b80000","#b10000","#aa0000","#a30000","#9a0000","#930000","#8c0000","#850000","#7e0000","#770000","#700000","#ffffff","#fff4ff","#ffe9ff","#ffdfff","#ffd4ff","#ffc8ff","#ffbdff","#ffb3ff","#ffa8ff","#ff9cff","#ff91ff","#ff75ff","#fb6bfd","#f960f9","#f656f6","#f24bf4","#ef3ff0","#ed36ef","#e92aeb","#e61fe8","#e416e6","#e10ae2","#b100ff","#ac00fb","#a300f6","#9a00f4","#9300ef","#8700e9","#8200e8","#7900e2","#7200dd","#6900db","#6200d6"]}');var Z=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},K=function(){function t(t,e){if(t.length!=e.length+1)throw"Mismatch between number of levels (".concat(t.length,") and number of colors (").concat(e.length,"; expected ").concat(t.length-1,")");this.levels=t,this.colors=e.map((function(t){return"object"==typeof(e=t)&&"color"in e&&"opacity"in e?t:{color:t,opacity:1};var e}))}return t.prototype.getColors=function(){return this.colors.map((function(t){return t.color}))},t.prototype.getOpacities=function(){return this.colors.map((function(t){return t.opacity}))},t.prototype.withOpacity=function(e){for(var n=[],r=[],o=0;o<this.colors.length;o++){var i=this.colors[o],a=this.levels[o],c=this.levels[o+1],l={color:i.color,opacity:e(a,c)};l.opacity>0&&(r[r.length-1]!=a&&r.push(a),r.push(c),n.push(l))}return new t(r,n)},t.diverging=function(e,n,r,o,i){for(var a,c,l=[],s=[],u=(o-r)/(i-1),f=(o+r)/2,h=[0,0,.9],_=T(x(e)),d=T(x(n)),p=0;p<i;p++){var b=r+p*u,v=void 0,m=void 0,g=void 0,y=void 0;b<f?(y=(f-b)/(f-r),v=(a=Z([_[0],h[1]+(_[1]-h[1])*y,h[2]+(_[2]-h[2])*y],3))[0],m=a[1],g=a[2]):b>=f&&(y=(b-f)/(o-f),v=(c=Z([d[0],h[1]+(d[1]-h[1])*y,h[2]+(d[2]-h[2])*y],3))[0],m=c[1],g=c[2]);var w=E(R([v,m,g]));l.push({color:w,opacity:Math.min(2*y,1)})}for(var A=0;A<=i;A++){var S=(o-r)/i;s.push(r+A*S)}return new t(s,l)},t}(),J=new K(z.g,z.O).withOpacity((function(t,e){return Math.min((e-20)/10,1)})),q=new K(W.g,W.O).withOpacity((function(t,e){return Math.min((e-20)/10,1)})),Q=new K(X.g,X.O).withOpacity((function(t,e){return Math.min(e/1e3,1)})),tt=new K(V.g,V.O),et=new K($.g,$.O),nt=new K(Y.g,Y.O);const rt="This constructor is not a subclass of Float16Array",ot="The constructor property value is not an object",it="Attempting to access detached ArrayBuffer",at="Cannot convert undefined or null to object",ct="Cannot mix BigInt and other types, use explicit conversions",lt="@@iterator property is not callable",st="Reduce of empty array with no initial value",ut="Offset is out of bounds";function ft(t){return(e,...n)=>_t(t,e,n)}function ht(t,e){return ft(vt(t,e).get)}const{apply:_t,construct:dt,defineProperty:pt,get:bt,getOwnPropertyDescriptor:vt,getPrototypeOf:mt,has:gt,ownKeys:yt,set:wt,setPrototypeOf:xt}=Reflect,Et=Proxy,{EPSILON:Tt,MAX_SAFE_INTEGER:Rt,isFinite:At,isNaN:St}=Number,{iterator:Gt,species:Bt,toStringTag:It,for:Nt}=Symbol,Mt=Object,{create:Ot,defineProperty:Pt,freeze:Lt,is:jt}=Mt,Dt=Mt.prototype,Ct=Dt.__lookupGetter__?ft(Dt.__lookupGetter__):(t,e)=>{if(null==t)throw Ne(at);let n=Mt(t);do{const t=vt(n,e);if(void 0!==t)return Ft(t,"get")?t.get:void 0}while(null!==(n=mt(n)))},Ft=Mt.hasOwn||ft(Dt.hasOwnProperty),kt=Array,Ut=kt.isArray,Ht=kt.prototype,zt=ft(Ht.join),Wt=ft(Ht.push),Xt=ft(Ht.toLocaleString),Vt=Ht[Gt],$t=ft(Vt),{abs:Yt,trunc:Zt}=Math,Kt=ArrayBuffer,Jt=Kt.isView,qt=Kt.prototype,Qt=ft(qt.slice),te=ht(qt,"byteLength"),ee="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:null,ne=ee&&ht(ee.prototype,"byteLength"),re=mt(Uint8Array),oe=re.from,ie=re.prototype,ae=ie[Gt],ce=ft(ie.keys),le=ft(ie.values),se=ft(ie.entries),ue=ft(ie.set),fe=ft(ie.reverse),he=ft(ie.fill),_e=ft(ie.copyWithin),de=ft(ie.sort),pe=ft(ie.slice),be=ft(ie.subarray),ve=ht(ie,"buffer"),me=ht(ie,"byteOffset"),ge=ht(ie,"length"),ye=ht(ie,It),we=Uint8Array,xe=Uint16Array,Ee=(...t)=>_t(oe,xe,t),Te=Uint32Array,Re=Float32Array,Ae=mt([][Gt]()),Se=ft(Ae.next),Ge=ft(function*(){}().next),Be=mt(Ae),Ie=DataView.prototype,Ne=(ft(Ie.getUint16),ft(Ie.setUint16),TypeError),Me=RangeError,Oe=WeakSet,Pe=Oe.prototype,Le=ft(Pe.add),je=ft(Pe.has),De=WeakMap,Ce=De.prototype,Fe=ft(Ce.get),ke=ft(Ce.has),Ue=ft(Ce.set),He=new De,ze=Ot(null,{next:{value:function(){const t=Fe(He,this);return Se(t)}},[Gt]:{value:function(){return this}}});function We(t){if(t[Gt]===Vt&&Ae.next===Se)return t;const e=Ot(ze);return Ue(He,e,$t(t)),e}const Xe=new De,Ve=Ot(Be,{next:{value:function(){const t=Fe(Xe,this);return Ge(t)},writable:!0,configurable:!0}});for(const t of yt(Ae))"next"!==t&&Pt(Ve,t,vt(Ae,t));function $e(t){const e=Ot(Ve);return Ue(Xe,e,t),e}function Ye(t){return null!==t&&"object"==typeof t||"function"==typeof t}function Ze(t){return null!==t&&"object"==typeof t}function Ke(t){return void 0!==ye(t)}function Je(t){const e=ye(t);return"BigInt64Array"===e||"BigUint64Array"===e}function qe(t){if(null===ee)return!1;try{return ne(t),!0}catch(t){return!1}}function Qe(t){return!!Ut(t)&&t[Gt]===Vt&&Ae.next===Se}function tn(t){if("string"!=typeof t)return!1;const e=+t;return t===e+""&&!!At(e)&&e===Zt(e)}const en=Nt("__Float16Array__"),nn=1/Tt,rn=5.960464477539063e-8,on=.0009765625*nn;const an=new Kt(4),cn=new Re(an),ln=new Te(an),sn=new xe(512),un=new we(512);for(let t=0;t<256;++t){const e=t-127;e<-27?(sn[t]=0,sn[256|t]=32768,un[t]=24,un[256|t]=24):e<-14?(sn[t]=1024>>-e-14,sn[256|t]=1024>>-e-14|32768,un[t]=-e-1,un[256|t]=-e-1):e<=15?(sn[t]=e+15<<10,sn[256|t]=e+15<<10|32768,un[t]=13,un[256|t]=13):e<128?(sn[t]=31744,sn[256|t]=64512,un[t]=24,un[256|t]=24):(sn[t]=31744,sn[256|t]=64512,un[t]=13,un[256|t]=13)}function fn(t){cn[0]=function(t){const e=+t;if(!At(e)||0===e)return e;const n=e>0?1:-1,r=Yt(e);if(r<6103515625e-14)return n*function(t){return t+nn-nn}(r/rn)*rn;const o=(1+on)*r,i=o-(o-r);return i>65504||St(i)?n*(1/0):n*i}(t);const e=ln[0],n=e>>23&511;return sn[n]+((8388607&e)>>un[n])}const hn=new Te(2048);for(let t=1;t<1024;++t){let e=t<<13,n=0;for(;0==(8388608&e);)e<<=1,n-=8388608;e&=-8388609,n+=947912704,hn[t]=e|n}for(let t=1024;t<2048;++t)hn[t]=939524096+(t-1024<<13);const _n=new Te(64);for(let t=1;t<31;++t)_n[t]=t<<23;_n[31]=1199570944,_n[32]=2147483648;for(let t=33;t<63;++t)_n[t]=2147483648+(t-32<<23);_n[63]=3347054592;const dn=new xe(64);for(let t=1;t<64;++t)32!==t&&(dn[t]=1024);function pn(t){const e=t>>10;return ln[0]=hn[dn[e]+(1023&t)]+_n[e],cn[0]}function bn(t){const e=+t;return St(e)||0===e?0:Zt(e)}function vn(t){const e=bn(t);return e<0?0:e<Rt?e:Rt}function mn(t,e){if(!Ye(t))throw Ne("This is not an object");const n=t.constructor;if(void 0===n)return e;if(!Ye(n))throw Ne(ot);const r=n[Bt];return null==r?e:r}function gn(t){if(qe(t))return!1;try{return Qt(t,0,0),!1}catch(t){}return!0}function yn(t,e){const n=St(t),r=St(e);if(n&&r)return 0;if(n)return 1;if(r)return-1;if(t<e)return-1;if(t>e)return 1;if(0===t&&0===e){const n=jt(t,0),r=jt(e,0);if(!n&&r)return-1;if(n&&!r)return 1}return 0}const wn=new De;function xn(t){return ke(wn,t)||!Jt(t)&&function(t){if(!Ze(t))return!1;const e=mt(t);if(!Ze(e))return!1;const n=e.constructor;if(void 0===n)return!1;if(!Ye(n))throw Ne(ot);return gt(n,en)}(t)}function En(t){if(!xn(t))throw Ne("This is not a Float16Array object")}function Tn(t,e){const n=xn(t),r=Ke(t);if(!n&&!r)throw Ne("Species constructor didn't return TypedArray object");if("number"==typeof e){let r;if(n){const e=Rn(t);r=ge(e)}else r=ge(t);if(r<e)throw Ne("Derived constructor created TypedArray object which was too small length")}if(Je(t))throw Ne(ct)}function Rn(t){const e=Fe(wn,t);if(void 0!==e){if(gn(ve(e)))throw Ne(it);return e}const n=t.buffer;if(gn(n))throw Ne(it);const r=dt(Bn,[n,t.byteOffset,t.length],t.constructor);return Fe(wn,r)}function An(t){const e=ge(t),n=[];for(let r=0;r<e;++r)n[r]=pn(t[r]);return n}const Sn=new Oe;for(const t of yt(ie)){if(t===It)continue;const e=vt(ie,t);Ft(e,"get")&&"function"==typeof e.get&&Le(Sn,e.get)}const Gn=Lt({get:(t,e,n)=>tn(e)&&Ft(t,e)?pn(bt(t,e)):je(Sn,Ct(t,e))?bt(t,e):bt(t,e,n),set:(t,e,n,r)=>tn(e)&&Ft(t,e)?wt(t,e,fn(n)):wt(t,e,n,r),getOwnPropertyDescriptor(t,e){if(tn(e)&&Ft(t,e)){const n=vt(t,e);return n.value=pn(n.value),n}return vt(t,e)},defineProperty:(t,e,n)=>tn(e)&&Ft(t,e)&&Ft(n,"value")?(n.value=fn(n.value),pt(t,e,n)):pt(t,e,n)});class Bn{constructor(t,e,n){let r;if(xn(t))r=dt(xe,[Rn(t)],new.target);else if(!Ye(t)||(function(t){try{return te(t),!0}catch(t){return!1}}(o=t)||qe(o)))r=dt(xe,arguments,new.target);else{let e,n;if(Ke(t)){if(e=t,n=ge(t),gn(ve(t)))throw Ne(it);if(Je(t))throw Ne(ct);const o=new Kt(2*n);r=dt(xe,[o],new.target)}else{const o=t[Gt];if(null!=o&&"function"!=typeof o)throw Ne(lt);null!=o?Qe(t)?(e=t,n=t.length):(e=[...t],n=e.length):(e=t,n=vn(e.length)),r=dt(xe,[n],new.target)}for(let t=0;t<n;++t)r[t]=fn(e[t])}var o;const i=new Et(r,Gn);return Ue(wn,i,r),i}static from(t,...e){const n=this;if(!gt(n,en))throw Ne(rt);if(n===Bn){if(xn(t)&&0===e.length){const e=Rn(t),n=new xe(ve(e),me(e),ge(e));return new Bn(ve(pe(n)))}if(0===e.length)return new Bn(ve(Ee(t,fn)));const n=e[0],r=e[1];return new Bn(ve(Ee(t,(function(t,...e){return fn(_t(n,this,[t,...We(e)]))}),r)))}let r,o;const i=t[Gt];if(null!=i&&"function"!=typeof i)throw Ne(lt);if(null!=i)Qe(t)?(r=t,o=t.length):Ke(a=t)&&a[Gt]===ae&&Ae.next===Se?(r=t,o=ge(t)):(r=[...t],o=r.length);else{if(null==t)throw Ne(at);r=Mt(t),o=vn(r.length)}var a;const c=new n(o);if(0===e.length)for(let t=0;t<o;++t)c[t]=r[t];else{const t=e[0],n=e[1];for(let e=0;e<o;++e)c[e]=_t(t,n,[r[e],e])}return c}static of(...t){const e=this;if(!gt(e,en))throw Ne(rt);const n=t.length;if(e===Bn){const e=new Bn(n),r=Rn(e);for(let e=0;e<n;++e)r[e]=fn(t[e]);return e}const r=new e(n);for(let e=0;e<n;++e)r[e]=t[e];return r}keys(){En(this);const t=Rn(this);return ce(t)}values(){En(this);const t=Rn(this);return $e(function*(){for(const e of le(t))yield pn(e)}())}entries(){En(this);const t=Rn(this);return $e(function*(){for(const[e,n]of se(t))yield[e,pn(n)]}())}at(t){En(this);const e=Rn(this),n=ge(e),r=bn(t),o=r>=0?r:n+r;if(!(o<0||o>=n))return pn(e[o])}with(t,e){En(this);const n=Rn(this),r=ge(n),o=bn(t),i=o>=0?o:r+o,a=+e;if(i<0||i>=r)throw Me(ut);const c=new xe(ve(n),me(n),ge(n)),l=new Bn(ve(pe(c)));return Rn(l)[i]=fn(a),l}map(t,...e){En(this);const n=Rn(this),r=ge(n),o=e[0],i=mn(n,Bn);if(i===Bn){const e=new Bn(r),i=Rn(e);for(let e=0;e<r;++e){const r=pn(n[e]);i[e]=fn(_t(t,o,[r,e,this]))}return e}const a=new i(r);Tn(a,r);for(let e=0;e<r;++e){const r=pn(n[e]);a[e]=_t(t,o,[r,e,this])}return a}filter(t,...e){En(this);const n=Rn(this),r=ge(n),o=e[0],i=[];for(let e=0;e<r;++e){const r=pn(n[e]);_t(t,o,[r,e,this])&&Wt(i,r)}const a=new(mn(n,Bn))(i);return Tn(a),a}reduce(t,...e){En(this);const n=Rn(this),r=ge(n);if(0===r&&0===e.length)throw Ne(st);let o,i;0===e.length?(o=pn(n[0]),i=1):(o=e[0],i=0);for(let e=i;e<r;++e)o=t(o,pn(n[e]),e,this);return o}reduceRight(t,...e){En(this);const n=Rn(this),r=ge(n);if(0===r&&0===e.length)throw Ne(st);let o,i;0===e.length?(o=pn(n[r-1]),i=r-2):(o=e[0],i=r-1);for(let e=i;e>=0;--e)o=t(o,pn(n[e]),e,this);return o}forEach(t,...e){En(this);const n=Rn(this),r=ge(n),o=e[0];for(let e=0;e<r;++e)_t(t,o,[pn(n[e]),e,this])}find(t,...e){En(this);const n=Rn(this),r=ge(n),o=e[0];for(let e=0;e<r;++e){const r=pn(n[e]);if(_t(t,o,[r,e,this]))return r}}findIndex(t,...e){En(this);const n=Rn(this),r=ge(n),o=e[0];for(let e=0;e<r;++e){const r=pn(n[e]);if(_t(t,o,[r,e,this]))return e}return-1}findLast(t,...e){En(this);const n=Rn(this),r=ge(n),o=e[0];for(let e=r-1;e>=0;--e){const r=pn(n[e]);if(_t(t,o,[r,e,this]))return r}}findLastIndex(t,...e){En(this);const n=Rn(this),r=ge(n),o=e[0];for(let e=r-1;e>=0;--e){const r=pn(n[e]);if(_t(t,o,[r,e,this]))return e}return-1}every(t,...e){En(this);const n=Rn(this),r=ge(n),o=e[0];for(let e=0;e<r;++e)if(!_t(t,o,[pn(n[e]),e,this]))return!1;return!0}some(t,...e){En(this);const n=Rn(this),r=ge(n),o=e[0];for(let e=0;e<r;++e)if(_t(t,o,[pn(n[e]),e,this]))return!0;return!1}set(t,...e){En(this);const n=Rn(this),r=bn(e[0]);if(r<0)throw Me(ut);if(null==t)throw Ne(at);if(Je(t))throw Ne(ct);if(xn(t))return ue(Rn(this),Rn(t),r);if(Ke(t)&&gn(ve(t)))throw Ne(it);const o=ge(n),i=Mt(t),a=vn(i.length);if(r===1/0||a+r>o)throw Me(ut);for(let t=0;t<a;++t)n[t+r]=fn(i[t])}reverse(){En(this);const t=Rn(this);return fe(t),this}toReversed(){En(this);const t=Rn(this),e=new xe(ve(t),me(t),ge(t)),n=new Bn(ve(pe(e))),r=Rn(n);return fe(r),n}fill(t,...e){En(this);const n=Rn(this);return he(n,fn(t),...We(e)),this}copyWithin(t,e,...n){En(this);const r=Rn(this);return _e(r,t,e,...We(n)),this}sort(t){En(this);const e=Rn(this),n=void 0!==t?t:yn;return de(e,((t,e)=>n(pn(t),pn(e)))),this}toSorted(t){En(this);const e=Rn(this);if(void 0!==t&&"function"!=typeof t)throw new Ne("The comparison function must be either a function or undefined");const n=void 0!==t?t:yn,r=new xe(ve(e),me(e),ge(e)),o=new Bn(ve(pe(r))),i=Rn(o);return de(i,((t,e)=>n(pn(t),pn(e)))),o}slice(t,e){En(this);const n=Rn(this),r=mn(n,Bn);if(r===Bn){const r=new xe(ve(n),me(n),ge(n));return new Bn(ve(pe(r,t,e)))}const o=ge(n),i=bn(t),a=void 0===e?o:bn(e);let c,l;c=i===-1/0?0:i<0?o+i>0?o+i:0:o<i?o:i,l=a===-1/0?0:a<0?o+a>0?o+a:0:o<a?o:a;const s=l-c>0?l-c:0,u=new r(s);if(Tn(u,s),0===s)return u;if(gn(ve(n)))throw Ne(it);let f=0;for(;c<l;)u[f]=pn(n[c]),++c,++f;return u}subarray(t,e){En(this);const n=Rn(this),r=mn(n,Bn),o=new xe(ve(n),me(n),ge(n)),i=be(o,t,e),a=new r(ve(i),me(i),ge(i));return Tn(a),a}indexOf(t,...e){En(this);const n=Rn(this),r=ge(n);let o=bn(e[0]);if(o===1/0)return-1;o<0&&(o+=r,o<0&&(o=0));for(let e=o;e<r;++e)if(Ft(n,e)&&pn(n[e])===t)return e;return-1}lastIndexOf(t,...e){En(this);const n=Rn(this),r=ge(n);let o=e.length>=1?bn(e[0]):r-1;if(o===-1/0)return-1;o>=0?o=o<r-1?o:r-1:o+=r;for(let e=o;e>=0;--e)if(Ft(n,e)&&pn(n[e])===t)return e;return-1}includes(t,...e){En(this);const n=Rn(this),r=ge(n);let o=bn(e[0]);if(o===1/0)return!1;o<0&&(o+=r,o<0&&(o=0));const i=St(t);for(let e=o;e<r;++e){const r=pn(n[e]);if(i&&St(r))return!0;if(r===t)return!0}return!1}join(t){En(this);const e=An(Rn(this));return zt(e,t)}toLocaleString(...t){En(this);const e=An(Rn(this));return Xt(e,...We(t))}get[It](){if(xn(this))return"Float16Array"}}Pt(Bn,"BYTES_PER_ELEMENT",{value:2}),Pt(Bn,en,{}),xt(Bn,re);const In=Bn.prototype;Pt(In,"BYTES_PER_ELEMENT",{value:2}),Pt(In,Gt,{value:In.values,writable:!0,configurable:!0}),xt(In,ie);var Nn=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mn=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{l(r.next(t))}catch(t){i(t)}}function c(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}l((r=r.apply(t,e||[])).next())}))},On=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},Pn=n(370),Ln=n(824),jn=new G((function(t){return new P(t,Pn,Ln)})),Dn=function(t){function e(e,n){var r=t.call(this)||this;r.field=e,r.cmap=n.cmap,r.opacity=n.opacity||1,r.cmap_image=function(t){var e=document.createElement("canvas");e.width=t.colors.length,e.height=1;var n=e.getContext("2d");return t.colors.forEach((function(t,e){if(null===n)throw"Could not get rendering context for colormap image canvas";n.fillStyle=t.color+Math.round(255*t.opacity).toString(16),n.fillRect(e,0,1,1)})),e}(r.cmap);for(var o=r.cmap.levels,i=o.length-1,a=[],c=0;c<101;c++)a.push(c/100);var l=o.map((function(t,e){return e/i})),s=o.map((function(t){return(t-o[0])/(o[i]-o[0])})),u=a.map((function(t){var e;for(e=0;!(s[e]<=t&&t<=s[e+1]);e++);var n=(t-s[e])/(s[e+1]-s[e]);return l[e]*(1-n)+l[e+1]*n}));return r.index_map=new Bn(u),r.gl_elems=null,r.image_mag_filter=null,r.cmap_mag_filter=null,r}return Nn(e,t),e.prototype.onAdd=function(t,e){return Mn(this,void 0,void 0,(function(){var t,n,r,o,i,a,c,l,s,u,f,h,_,d,p,b,v,m,g,y;return On(this,(function(w){switch(w.label){case 0:if(null===this.image_mag_filter||null===this.cmap_mag_filter)throw"Implement magnification filtes in a subclass";return t=jn.getValue(e),[4,this.field.grid.getWGLBuffers(e)];case 1:return n=w.sent(),r=n.vertices,o=n.texcoords,i=r,a=o,c=N(e,this.field.isFloat16()),l=c.format,s=c.type,u=c.row_alignment,f={format:l,type:s,width:this.field.grid.ni,height:this.field.grid.nj,image:this.field.getTextureData(),mag_filter:this.image_mag_filter,row_alignment:u},h=new O(e,f),_={format:e.RGBA,type:e.UNSIGNED_BYTE,image:this.cmap_image,mag_filter:this.cmap_mag_filter},d=new O(e,_),p=N(e,!0),b=p.format,v=p.type,m=p.row_alignment,g={format:b,type:v,width:this.index_map.length,height:1,image:new Uint16Array(this.index_map.buffer),mag_filter:e.LINEAR,row_alignment:m},y=new O(e,g),this.gl_elems={program:t,vertices:i,texcoords:a,fill_texture:h,cmap_texture:d,cmap_nonlin_texture:y},[2]}}))}))},e.prototype.render=function(t,e){if(null!==this.gl_elems){var n=this.gl_elems;n.program.use({a_pos:n.vertices,a_tex_coord:n.texcoords},{u_cmap_min:this.cmap.levels[0],u_cmap_max:this.cmap.levels[this.cmap.levels.length-1],u_matrix:e,u_opacity:this.opacity,u_n_index:this.index_map.length},{u_fill_sampler:n.fill_texture,u_cmap_sampler:n.cmap_texture,u_cmap_nonlin_sampler:n.cmap_nonlin_texture}),t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),n.program.draw()}},e}(I),Cn=function(t){function e(e,n){return t.call(this,e,n)||this}return Nn(e,t),e.prototype.onAdd=function(e,n){return Mn(this,void 0,void 0,(function(){return On(this,(function(r){return this.image_mag_filter=n.NEAREST,this.cmap_mag_filter=n.LINEAR,t.prototype.onAdd.call(this,e,n),[2]}))}))},e.prototype.render=function(e,n){t.prototype.render.call(this,e,n)},e}(Dn),Fn=function(t){function e(e,n){return t.call(this,e,n)||this}return Nn(e,t),e.prototype.onAdd=function(e,n){return Mn(this,void 0,void 0,(function(){return On(this,(function(r){return this.image_mag_filter=n.LINEAR,this.cmap_mag_filter=n.NEAREST,t.prototype.onAdd.call(this,e,n),[2]}))}))},e.prototype.render=function(e,n){t.prototype.render.call(this,e,n)},e}(Dn),kn=n(955),Un=n(49),Hn=new G((function(t){return new P(t,kn,Un)})),zn=function(){function t(t,e,n,r,o,i,a,c){this.spec=i,this.color=a,this.size_multiplier=c,this.program=Hn.getValue(t),this.vertices=null,this.texcoords=null;var l,s,u,f,h=Math.log2(n),_=Math.max(h+1-r,0),d=Math.pow(2,_),p=e.getThinnedField(d,d).toEarthRelative(),b=p.u,v=p.v;l=this,s=void 0,f=function(){var e,o,i;return function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(a){switch(a.label){case 0:return[4,p.grid.getWGLBillboardBuffers(t,n/d,r)];case 1:return e=a.sent(),o=e.vertices,i=e.texcoords,this.vertices=o,this.texcoords=i,[2]}}))},new((u=void 0)||(u=Promise))((function(t,e){function n(t){try{o(f.next(t))}catch(t){e(t)}}function r(t){try{o(f.throw(t))}catch(t){e(t)}}function o(e){var o;e.done?t(e.value):(o=e.value,o instanceof u?o:new u((function(t){t(o)}))).then(n,r)}o((f=f.apply(l,s||[])).next())}));var m=N(t,b.isFloat16()),g=m.format,y=m.type,w=m.row_alignment,x={format:g,type:y,width:b.grid.ni,height:b.grid.nj,image:b.getTextureData(),mag_filter:t.NEAREST,row_alignment:w},E={format:g,type:y,width:v.grid.ni,height:v.grid.nj,image:v.getTextureData(),mag_filter:t.NEAREST,row_alignment:w};this.texture=new O(t,o),this.u_texture=new O(t,x),this.v_texture=new O(t,E)}return t.prototype.render=function(t,e,n,r,o,i){var a=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(n,2),c=a[0],l=a[1];if(null!==this.vertices&&null!==this.texcoords){var s=this.spec.BB_HEIGHT*(l/c)*this.size_multiplier,u=this.spec.BB_WIDTH/this.spec.BB_TEX_WIDTH,f=this.spec.BB_HEIGHT/this.spec.BB_TEX_HEIGHT;this.program.use({a_pos:this.vertices,a_tex_coord:this.texcoords},{u_bb_size:s,u_bb_width:u,u_bb_height:f,u_bb_mag_bin_size:this.spec.BB_MAG_BIN_SIZE,u_bb_mag_wrap:this.spec.BB_MAG_WRAP,u_bb_color:this.color,u_matrix:e,u_map_aspect:l/c,u_zoom:r,u_map_bearing:o},{u_sampler:this.texture,u_u_sampler:this.u_texture,u_v_sampler:this.v_texture}),t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),this.program.draw()}},t}(),Wn=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xn={BB_WIDTH:85,BB_HEIGHT:256,BB_TEX_WIDTH:1024,BB_TEX_HEIGHT:1024,BB_MAG_MAX:235,BB_MAG_WRAP:60,BB_MAG_BIN_SIZE:5},Vn=null;const $n=function(t){function e(e,n){var r=t.call(this)||this;r.fields=e;var o=w(n.color||"#000000");return r.color=[o[0],o[1],o[2]],r.thin_fac=n.thin_fac||1,r.gl_elems=null,r}return Wn(e,t),e.prototype.onAdd=function(t,e){return n=this,r=void 0,i=function(){var n,r,o;return function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(i){return e.getExtension("OES_texture_float"),e.getExtension("OES_texture_float_linear"),n=t.getMaxZoom(),null===Vn&&(Vn=function(){var t=document.createElement("canvas");function e(t,e,n,r){var o=Xn.BB_WIDTH/2-4,i=o/2;if(r<2.5)t.beginPath(),t.arc(e,n,o/2,0,2*Math.PI),t.stroke();else{var a=0,c=r,l=0,s=Math.floor((c+2.5)/50);l+=s*o/2+i+(s-1)*i/2,c-=50*s;var u=Math.floor((c+2.5)/10);l+=u*i,c-=10*u,l+=Math.floor((c+2.5)/5)*i,r<7.5&&(l+=i),l=Math.max(120,l),t.beginPath(),t.moveTo(e,n),t.lineTo(e,n+l),c=r,a=n+l;for(var f=!1,h=!0;c>47.5;)f&&(a+=i/2),h||t.moveTo(e,a),t.lineTo(e-o,a),t.lineTo(e,a-o/2),a-=o/2+i,c-=50,f=!0,h=!1;for(;c>7.5;)h||t.moveTo(e,a),t.lineTo(e-o,a+o/2),a-=i,c-=10,h=!1;for(r<7.5&&(a-=i);c>2.5;)t.moveTo(e,a),t.lineTo(e-o/2,a+o/4),c-=5;t.stroke()}}t.width=Xn.BB_TEX_WIDTH,t.height=Xn.BB_TEX_HEIGHT;var n=t.getContext("2d");if(null===n)throw"Could not get rendering context for the wind barb canvas";n.lineWidth=8,n.miterLimit=4;for(var r=0;r<=Xn.BB_MAG_MAX;r+=Xn.BB_MAG_BIN_SIZE)e(n,r%Xn.BB_MAG_WRAP/Xn.BB_MAG_BIN_SIZE*Xn.BB_WIDTH+Xn.BB_WIDTH/2,Math.floor(r/Xn.BB_MAG_WRAP)*Xn.BB_HEIGHT+Xn.BB_WIDTH/2,r);return t}()),r={format:e.RGBA,type:e.UNSIGNED_BYTE,image:Vn,mag_filter:e.NEAREST},o=new zn(e,this.fields,this.thin_fac,n,r,Xn,this.color,.1),this.gl_elems={map:t,barb_billboards:o},[2]}))},new((o=void 0)||(o=Promise))((function(t,e){function a(t){try{l(i.next(t))}catch(t){e(t)}}function c(t){try{l(i.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(a,c)}l((i=i.apply(n,r||[])).next())}));var n,r,o,i},e.prototype.render=function(t,e){if(null!==this.gl_elems){var n=this.gl_elems,r=n.map.getZoom(),o=n.map.getCanvas().width,i=n.map.getCanvas().height,a=n.map.getBearing(),c=n.map.getPitch();n.barb_billboards.render(t,e,[o,i],r,a,c)}},e}(I);var Yn=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Zn=n(431),Kn=n(714),Jn=new G((function(t){return new P(t,Zn,Kn)}));const qn=function(t){function e(e,n){var r=t.call(this)||this;r.field=e;var o=void 0!==(n=void 0!==n?n:{}).colors?function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(n.colors),!1):["#000000"];return r.colors=o.reverse().map((function(t){return w(t)})).flat(),r.opacity=void 0!==n.opacity?n.opacity:1,r.gl_elems=null,r}return Yn(e,t),e.prototype.onAdd=function(t,e){return n=this,r=void 0,i=function(){var t,n,r,o,i,a,c,l,s,u,f,h;return function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(_){switch(_.label){case 0:return e.getExtension("OES_texture_float"),t=Jn.getValue(e),[4,this.field.grid.getWGLBuffers(e)];case 1:return n=_.sent(),r=n.vertices,o=n.texcoords,i=r,a=o,e.pixelStorei(e.UNPACK_ALIGNMENT,2),c=N(e,this.field.isFloat16()),l=c.format,s=c.type,u=c.row_alignment,f={format:l,type:s,width:this.field.grid.ni,height:this.field.grid.nj,image:this.field.getTextureData(),mag_filter:e.NEAREST,row_alignment:u},h=new O(e,f),this.gl_elems={program:t,vertices:i,fill_texture:h,texcoords:a},[2]}}))},new((o=void 0)||(o=Promise))((function(t,e){function a(t){try{l(i.next(t))}catch(t){e(t)}}function c(t){try{l(i.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(a,c)}l((i=i.apply(n,r||[])).next())}));var n,r,o,i},e.prototype.render=function(t,e){if(null!==this.gl_elems){var n=this.gl_elems;n.program.use({a_pos:n.vertices,a_tex_coord:n.texcoords},{u_matrix:e,u_opacity:this.opacity,u_colors:this.colors,u_num_colors:this.colors.length/4},{u_fill_sampler:n.fill_texture}),t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),n.program.draw()}},e}(I);var Qn=n(319),tr=n(559),er=new G((function(t){return new P(t,Qn,tr)})),nr=function(){function t(t,e,n,r,o){this.width=r,this.scale=o,this.program=er.getValue(t),this.origin=new M(t,e.origin,2,t.TRIANGLE_STRIP),this.offset=new M(t,e.verts,2,t.TRIANGLE_STRIP),this.extrusion=new M(t,e.extrusion,2,t.TRIANGLE_STRIP),this.min_zoom=new M(t,e.zoom,1,t.TRIANGLE_STRIP),this.texture=new O(t,n),this.texcoords=new M(t,e.texcoords,2,t.TRIANGLE_STRIP)}return t.prototype.render=function(t,e,n,r,o,i){var a=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(n,2),c=a[0],l=a[1];this.program.use({a_pos:this.origin,a_offset:this.offset,a_extrusion:this.extrusion,a_min_zoom:this.min_zoom,a_tex_coord:this.texcoords},{u_offset_scale:this.scale*(l/c),u_line_width:this.width,u_matrix:e,u_map_aspect:l/c,u_zoom:r,u_map_bearing:o},{u_sampler:this.texture}),t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),this.program.draw()},t}();function rr(t){var e,n,r=function(t){var e=Math.sin(t);return Math.tan(Math.PI/4-t/2)*Math.pow((1+a*e)/(1-a*e),a/2)},o=function(t){var e=Math.sin(t);return Math.cos(t)/Math.sqrt(1-a*a*e*e)},i=6378137,a=Math.sqrt(.006694379990197619),c=Math.PI/180,l=t.lon_0,s=t.lat_0,u=t.lat_std;u=Array.isArray(u)&&u[0]==u[1]?u[0]:u,l*=c;var f=r(s*=c);if(Array.isArray(u)){var h=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(u,2),_=h[0],d=h[1];d*=c;var p=r(_*=c),b=r(d),v=o(_),m=o(d);n=Math.log(v/m)/Math.log(p/b),e=v/(n*Math.pow(p,n))}else _=u,p=r(_*=c),v=o(_),n=Math.sin(_),e=v/(n*Math.pow(p,n));var g=i*e*Math.pow(f,n),y=a*a,w=y*y,x=w*y,E=x*y,T=y/2+5*w/24+3*x/120-73*E/2016,R=7*w/24+29*x/120+233*E/6720,A=7*x/30+81*E/280,S=4729*E/20160;return function(t,o,a){return(a=void 0===a?{inverse:!1}:a).inverse?(s=t,u=o,f=Math.atan2(s,g-u)/n+l,h=Math.hypot(s,g-u)*Math.sign(n),_=Math.pow(h/(i*e),1/n),d=Math.PI/2-2*Math.atan(_),p=Math.sin(2*d),b=Math.cos(2*d),[f/c,(d+p*(T+b*(R+b*(A+S*b))))/c]):function(t,o){t*=c;var a=r(o*=c),s=i*e*Math.pow(a,n),u=n*(t-l);return[s*Math.sin(u),g-s*Math.cos(u)]}(t,o);var s,u,f,h,_,d,p,b}}var or=function(){function t(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: (".concat(t,", ").concat(e,")"));if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return t.prototype.toMercatorCoord=function(){return{x:(e=this.lng,(180+e)/360),y:(t=this.lat,(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360)};var t,e},t}(),ir=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ar=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},cr=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},lr={BB_WIDTH:256,BB_HEIGHT:256,BB_TEX_WIDTH:256,BB_TEX_HEIGHT:256,BB_MAG_MAX:1e3,BB_MAG_WRAP:1e3,BB_MAG_BIN_SIZE:1e3},sr=null,ur=[{bounds:[0,1],color:"#ffffcc"},{bounds:[1,3],color:"#a1dab4"},{bounds:[3,6],color:"#41b6c4"},{bounds:[6,9],color:"#225ea8"}],fr=null;const hr=function(t){function e(e,n){var r=t.call(this)||this;n=n||{},r.profile_field=e;var o=w(n.bgcolor||"#000000");return r.bgcolor=[o[0],o[1],o[2]],r.thin_fac=n.thin_fac||1,r.gl_elems=null,r}return ir(e,t),e.prototype.onAdd=function(t,e){return n=this,r=void 0,i=function(){var n,r,o,i,a,c,l,s,u,f,h,_,d=this;return function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(p){switch(p.label){case 0:return n=(lr.BB_TEX_WIDTH-2)/(40*lr.BB_TEX_WIDTH),r=140,null===sr&&(sr=function(){var t=document.createElement("canvas");t.width=lr.BB_TEX_WIDTH,t.height=lr.BB_TEX_HEIGHT;var e=t.getContext("2d");if(null===e)throw"Could not get rendering context for the hodograph background canvas";e.lineWidth=4;for(var n=lr.BB_TEX_WIDTH/4;n<=lr.BB_TEX_WIDTH/2;n+=lr.BB_TEX_WIDTH/4)e.beginPath(),e.arc(lr.BB_TEX_WIDTH/2,lr.BB_TEX_WIDTH/2,n-2,0,2*Math.PI),e.stroke();var r=lr.BB_TEX_WIDTH/2,o=lr.BB_TEX_WIDTH/2;return e.beginPath(),e.moveTo(r,o),e.lineTo(r+10,o+20),e.lineTo(r-10,o+20),e.lineTo(r,o),e.fill(),t}()),o={format:e.RGBA,type:e.UNSIGNED_BYTE,image:sr,mag_filter:e.NEAREST},i=t.getMaxZoom(),a=new zn(e,this.profile_field.getStormMotionGrid(),this.thin_fac,i,o,lr,this.bgcolor,.004*r),[4,B.makePolyLines(this.profile_field.profiles.map((function(t){var e=new or(t.lon,t.lat).toMercatorCoord(),n=A(t.jlat,t.ilon,d.thin_fac),r=Math.max.apply(Math,cr([],ar(ur.map((function(t){return Math.max.apply(Math,cr([],ar(t.bounds),!1))}))),!1));return{verts:cr([],ar(t.u),!1).map((function(e,n){return[e-t.smu,t.v[n]-t.smv]})),origin:[e.x,e.y],zoom:n,texcoords:cr([],ar(t.z),!1).map((function(t){return[t/r,.5]}))}})))];case 1:return c=p.sent(),null===fr&&(fr=function(){var t=document.createElement("canvas");t.width=Math.max.apply(Math,cr([],ar(ur.map((function(t){return Math.max.apply(Math,cr([],ar(t.bounds),!1))}))),!1)),t.height=1;var e=t.getContext("2d");return ur.forEach((function(t){if(null===e)throw"Could not get rendering context for the hodograph height texture canvas";var n=ar(t.bounds,2),r=n[0],o=n[1];e.fillStyle=t.color,e.fillRect(r,0,o-r,1)})),t}()),l={format:e.RGBA,type:e.UNSIGNED_BYTE,image:fr,mag_filter:e.NEAREST},s=new nr(e,c,l,1.5,n*r),[4,B.makePolyLines(this.profile_field.profiles.map((function(t){var e=new or(t.lon,t.lat).toMercatorCoord(),n=A(t.jlat,t.ilon,d.thin_fac),r=Math.hypot(t.smu,t.smv),o=Math.PI/2-Math.atan2(-t.smv,-t.smu);return{verts:[[2*Math.sin(o),2*Math.cos(o)],[r*Math.sin(o),r*Math.cos(o)]],origin:[e.x,e.y],zoom:n,texcoords:[[.5,.5],[.5,.5]]}})))];case 2:return u=p.sent(),(f=this.bgcolor.map((function(t){return 255*t}))).push(255),h={format:e.RGBA,type:e.UNSIGNED_BYTE,width:1,height:1,image:new Uint8Array(f),mag_filter:e.NEAREST},_=new nr(e,u,h,1,n*r),this.gl_elems={map:t,bg_billboard:a,hodo_line:s,sm_line:_},[2]}}))},new((o=void 0)||(o=Promise))((function(t,e){function a(t){try{l(i.next(t))}catch(t){e(t)}}function c(t){try{l(i.throw(t))}catch(t){e(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(a,c)}l((i=i.apply(n,r||[])).next())}));var n,r,o,i},e.prototype.render=function(t,e){if(null!==this.gl_elems){var n=this.gl_elems,r=n.map.getZoom(),o=n.map.getCanvas().width,i=n.map.getCanvas().height,a=n.map.getBearing(),c=n.map.getPitch();n.hodo_line.render(t,e,[o,i],r,a,c),n.sm_line.render(t,e,[o,i],r,a,a),n.bg_billboard.render(t,e,[o,i],r,a,c)}},e}(I);var _r=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dr=function(t){this.type="custom",this.id=t},pr=function(t){function e(e,n){var r=t.call(this,e)||this;return r.field=n,r}return _r(e,t),e.prototype.onAdd=function(t,e){this.field.onAdd(t,e)},e.prototype.render=function(t,e){this.field.render(t,e)},e}(dr),br=function(t){function e(e){var n=t.call(this,e)||this;return n.fields={},n.field_key=null,n.map=null,n.gl=null,n}return _r(e,t),e.prototype.onAdd=function(t,e){var n=this;this.map=t,this.gl=e,Object.values(this.fields).forEach((function(r){r.onAdd(t,e).then((function(t){n.repaintIfNecessary(null)}))})),this.repaintIfNecessary(null)},e.prototype.render=function(t,e){null!==this.map&&null!==this.gl&&null!==this.field_key&&this.fields.hasOwnProperty(this.field_key)&&null!==this.fields[this.field_key]&&this.fields[this.field_key].render(t,e)},e.prototype.setActiveKey=function(t){var e=this.field_key;this.field_key=t,this.repaintIfNecessary(e)},e.prototype.getKeys=function(){return Object.keys(this.fields)},e.prototype.addField=function(t,e){var n=this;this.field_key,null!==this.map&&null!==this.gl&&null!==t&&t.onAdd(this.map,this.gl).then((function(t){n.repaintIfNecessary(null)})),this.fields[e]=t,null===this.field_key&&(this.field_key=e)},e.prototype.repaintIfNecessary=function(t){null!==this.map&&t!==this.field_key&&this.map.triggerRepaint()},e}(dr),vr=function(){return vr=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},vr.apply(this,arguments)},mr=function(t,e,n){var r=document.createElementNS("http://www.w3.org/2000/svg",t);return void 0!==e&&Object.entries(e).forEach((function(t){var e=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(t,2),n=e[0],o=e[1];r.setAttribute(n,o.toString())})),void 0!==n&&n.appendChild(r),r};function gr(t,e){var n=e.label||"",r=e.ticks||t.levels,o=e.orientation||"vertical",i=e.fontface||"sans-serif",a=e.ticklabelsize||12,c=e.tick_direction||("vertical"==o?"left":"bottom");if("vertical"==o&&("top"==c||"bottom"==c)||"horizontal"==o&&("left"==c||"right"==c))throw"tick_direction of '".concat(c," doesn't match an orientation of ").concat(o);var l,s,u,f,h,_,d=function(t){return t.toString().length},p=d(r[0]),b=d(r[r.length-1]),v=600,m=v/9,g="horizontal"==o?6*Math.max(p,b):8;"vertical"==o?(l=v,s=m,u="left"==c?53.66666666666667:3,f=g,h=10,_=v-2*g):(s=v,l=m-6,u=g,f="bottom"==c?3:47.66666666666667,_=10,h=v-2*g);var y,w=t.colors.length,x=mr("svg",{width:s,height:l}),E=mr("g",{},x);y="vertical"==o?"left"==c?{"text-anchor":"end",transform:"translate(".concat(u,", ").concat(f,")")}:{transform:"translate(".concat(u+h,", ").concat(f,")")}:"bottom"==c?{"text-anchor":"middle",transform:"translate(".concat(u,", ").concat(f+_,")")}:{"text-anchor":"middle",transform:"translate(".concat(u,", ").concat(f,")")};var T=mr("g",y,x);t.colors.forEach((function(t,e){mr("rect",vr(vr({},"vertical"==o?{x:u,y:f+_*(1-(e+1)/w),width:h,height:_/w}:{x:u+h*e/w,y:f,width:h/w,height:_}),{fill:t.color,opacity:t.opacity}),E)}));var R,A=t.levels[0],S=t.levels[t.levels.length-1];return r.filter((function(t){return A<=t&&t<=S})).forEach((function(e){var n=t.levels.map((function(t){return Math.abs(t-e)})),r=n.indexOf(n.reduce((function(t,e){return Math.min(t,e)})));e<=t.levels[r]&&r>0&&(r-=1),r+=(e-t.levels[r])/(t.levels[r+1]-t.levels[r]);var l="vertical"==o?{transform:"translate(0, ".concat(_*(1-r/w),")")}:{transform:"translate(".concat(h*r/w,", 0)")},s=mr("g",l,T);mr("line",vr(vr({},"vertical"==o?"left"==c?{x2:-6}:{x2:6}:"bottom"==c?{y2:6}:{y2:-6}),{stroke:"#000000","stroke-width":1.5}),s),mr("text",vr(vr({},"vertical"==o?"left"==c?{x:-9,dy:"0.32em"}:{x:9,dy:"0.32em"}:"bottom"==c?{y:9,dy:"0.8em"}:{y:-9,dy:"0em"}),{fill:"#000000",style:"font-family: ".concat(i,"; font-size: ").concat(a,"pt")}),s).textContent=e.toString()})),mr("rect",{x:u,y:f,width:h,height:_,stroke:"#000000","stroke-width":1.5,fill:"none"},x),R="vertical"==o?"left"==c?{transform:"translate(15, ".concat(l/2,") rotate(-90)")}:{transform:"translate(".concat(s-6,", ").concat(l/2,") rotate(-90)")}:"bottom"==c?{transform:"translate(".concat(s/2,", ").concat(l-5,")")}:{transform:"translate(".concat(s/2,", 15)")},mr("text",vr(vr({},R),{fill:"#000000","text-anchor":"middle",style:"font-family: ".concat(i,";")}),x).textContent=n,x}function yr(t,e,n){if(t.length!=e.length)throw"Mismatch between the number of colors (".concat(t.length,") and the number of labels (").concat(e.length,")");var r=void 0===(n=void 0===n?{}:n).n_cols?1:n.n_cols,o=void 0===n.fontface?"sans-serif":n.fontface,i=Math.ceil(t.length/r),a=mr("svg",{width:123*r+5*(r+1),height:20*i+5*(i+1)}),c=mr("g",{},a);return t.forEach((function(t,n){var r=e[n],a=n%i,l=Math.floor(n/i),s=1;"string"!=typeof t&&(s=t.opacity,t=t.color);var u=5+128*l,f=5+25*a;mr("rect",{x:u,y:f,fill:t,opacity:s,width:20,height:20},c),mr("text",vr(vr({},{x:u+20+3,y:f+10,dy:"0.32em"}),{fill:"#000000",style:"font-size: 0.8em; font-family: ".concat(o,";")}),c).textContent=r})),a}var wr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xr=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{l(r.next(t))}catch(t){i(t)}}function c(t){try{l(r.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}l((r=r.apply(t,e||[])).next())}))},Er=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(t){c=[6,t],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},Tr=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Rr=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ar=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},Sr=function(){function t(t,e,n,r){var o=this;this.type=t,this.is_conformal=e,this.ni=n,this.nj=r,this.buffer_cache=new G((function(t){var e=Math.max(Math.floor(o.ni/50),20),n=Math.max(Math.floor(o.nj/50),20);return function(t,e,n){return xr(this,void 0,void 0,(function(){var r,o,i,a,c,l,s,u,f,h,_;return Er(this,(function(d){switch(d.label){case 0:return r=1/(2*(n=void 0!==n?n:e).ni),o=1/(2*n.nj),i=e.ni*e.nj/(n.ni*n.nj),a=e.getCoords(),c=a.lats,l=a.lons,[4,B.makeDomainVerticesAndTexCoords(c,l,e.ni,e.nj,r,o)];case 1:for(s=d.sent(),u=0;u<s.grid_cell_size.length;u++)s.grid_cell_size[u]*=i;return f=new M(t,s.vertices,2,t.TRIANGLE_STRIP),h=new M(t,s.tex_coords,2,t.TRIANGLE_STRIP),_=new M(t,s.grid_cell_size,1,t.TRIANGLE_STRIP),[2,{vertices:f,texcoords:h,cellsize:_}]}}))}))}(t,o.copy({ni:e,nj:n}),o)})),this.billboard_buffer_cache=new G((function(t,e,n){return function(t,e,n,r){return xr(this,void 0,void 0,(function(){var o,i,a,c,l,s;return Er(this,(function(u){switch(u.label){case 0:return o=e.getCoords(),i=o.lats,a=o.lons,[4,B.makeBBElements(i,a,e.ni,e.nj,n,r)];case 1:return c=u.sent(),l=new M(t,c.pts,3,t.TRIANGLE_STRIP),s=new M(t,c.tex_coords,2,t.TRIANGLE_STRIP),[2,{vertices:l,texcoords:s}]}}))}))}(t,o,e,n)}))}return t.prototype.getWGLBuffers=function(t){return xr(this,void 0,void 0,(function(){return Er(this,(function(e){switch(e.label){case 0:return[4,this.buffer_cache.getValue(t)];case 1:return[2,e.sent()]}}))}))},t.prototype.getWGLBillboardBuffers=function(t,e,n){return xr(this,void 0,void 0,(function(){return Er(this,(function(r){switch(r.label){case 0:return[4,this.billboard_buffer_cache.getValue(t,e,n)];case 1:return[2,r.sent()]}}))}))},t}(),Gr=function(t){function e(e,n,r,o,i,a){var c=t.call(this,"latlon",!0,e,n)||this;return c.ll_lon=r,c.ll_lat=o,c.ur_lon=i,c.ur_lat=a,c.ll_cache=new G((function(){for(var t=(c.ur_lon-c.ll_lon)/(c.ni-1),e=(c.ur_lat-c.ll_lat)/(c.nj-1),n=new Float32Array(c.ni*c.nj),r=new Float32Array(c.ni*c.nj),o=0;o<c.ni;o++)for(var i=0;i<c.nj;i++){var a=o+i*c.ni;n[a]=c.ll_lon+o*t,r[a]=c.ll_lat+i*e}return{lons:n,lats:r}})),c}return wr(e,t),e.prototype.copy=function(t){return new e(void 0!==(t=void 0!==t?t:{}).ni?t.ni:this.ni,void 0!==t.nj?t.nj:this.nj,void 0!==t.ll_lon?t.ll_lon:this.ll_lon,void 0!==t.ll_lat?t.ll_lat:this.ll_lat,void 0!==t.ur_lon?t.ur_lon:this.ur_lon,void 0!==t.ur_lat?t.ur_lat:this.ur_lat)},e.prototype.getCoords=function(){return this.ll_cache.getValue()},e.prototype.transform=function(t,e,n){return[t,e]},e.prototype.getThinnedGrid=function(t,n){var r=(this.ur_lon-this.ll_lon)/this.ni,o=(this.ur_lat-this.ll_lat)/this.nj,i=Math.ceil(this.ni/t),a=Math.ceil(this.nj/n),c=(this.ni-1)%t,l=(this.nj-1)%n;return new e(i,a,this.ll_lon,this.ll_lat,this.ur_lon-c*r,this.ur_lat-l*o)},e}(Sr),Br=function(t){function e(e,n,r,o,i,a,c,l,s){var u=t.call(this,"latlonrot",!0,e,n)||this;return u.np_lon=r,u.np_lat=o,u.lon_shift=i,u.ll_lon=a,u.ll_lat=c,u.ur_lon=l,u.ur_lat=s,u.llrot=function(t){var e=Math.PI/180,n=t.np_lat*e,r=t.np_lon*e,o=t.lon_shift*e,i=Math.sin(n),a=Math.cos(n);return function(t,n,c){return(c=void 0===c?{inverse:!1}:c).inverse?function(t,n){t*=e,n*=e;var c=Math.sin(n),l=Math.cos(n),s=Math.sin(t-r),u=Math.cos(t-r),f=Math.asin(i*c+a*l*u),h=o+Math.atan2(l*s,i*l*u-a*c);return t>Math.PI&&(t-=2*Math.PI),[h/e,f/e]}(t,n):function(t,n){t*=e,n*=e;var c=Math.sin(n),l=Math.cos(n),s=Math.sin(t-o),u=Math.cos(t-o),f=Math.asin(i*c-a*l*u),h=r+Math.atan2(l*s,i*l*u+a*c);return h>Math.PI&&(h-=2*Math.PI),[h/e,f/e]}(t,n)}}({np_lon:r,np_lat:o,lon_shift:i}),u.ll_cache=new G((function(){for(var t=new Float32Array(u.ni*u.nj),e=new Float32Array(u.ni*u.nj),n=0;n<u.ni;n++)for(var r=u.ll_lon+(u.ur_lon-u.ll_lon)*n/(u.ni-1),o=0;o<u.nj;o++){var i=u.ll_lat+(u.ur_lat-u.ll_lat)*o/(u.nj-1),a=Tr(u.llrot(r,i),2),c=a[0],l=a[1],s=n+o*u.ni;t[s]=c,e[s]=l}return{lons:t,lats:e}})),u}return wr(e,t),e.prototype.copy=function(t){var n=void 0!==(t=void 0!==t?t:{}).ni?t.ni:this.ni,r=void 0!==t.nj?t.nj:this.nj,o=void 0!==t.ll_lon?t.ll_lon:this.ll_lon,i=void 0!==t.ll_lat?t.ll_lat:this.ll_lat,a=void 0!==t.ur_lon?t.ur_lon:this.ur_lon,c=void 0!==t.ur_lat?t.ur_lat:this.ur_lat;return new e(n,r,this.np_lon,this.np_lat,this.lon_shift,o,i,a,c)},e.prototype.getCoords=function(){return this.ll_cache.getValue()},e.prototype.transform=function(t,e,n){var r="inverse"in(n=void 0===n?{}:n)&&n.inverse;return this.llrot(t,e,{inverse:!r})},e.prototype.getThinnedGrid=function(t,n){var r=(this.ur_lon-this.ll_lon)/this.ni,o=(this.ur_lat-this.ll_lat)/this.nj,i=Math.ceil(this.ni/t),a=Math.ceil(this.nj/n),c=(this.ni-1)%t,l=(this.nj-1)%n,s=this.ll_lon,u=this.ll_lat,f=this.ur_lon-c*r,h=this.ur_lat-l*o;return new e(i,a,this.np_lon,this.np_lat,this.lon_shift,s,u,f,h)},e}(Sr),Ir=function(t){function e(e,n,r,o,i,a,c,l,s){var u=t.call(this,"lcc",!0,e,n)||this;return u.lon_0=r,u.lat_0=o,u.lat_std=i,u.ll_x=a,u.ll_y=c,u.ur_x=l,u.ur_y=s,u.lcc=rr({lon_0:r,lat_0:o,lat_std:i}),u.ll_cache=new G((function(){for(var t=new Float32Array(u.ni*u.nj),e=new Float32Array(u.ni*u.nj),n=0;n<u.ni;n++)for(var r=u.ll_x+(u.ur_x-u.ll_x)*n/(u.ni-1),o=0;o<u.nj;o++){var i=u.ll_y+(u.ur_y-u.ll_y)*o/(u.nj-1),a=Tr(u.lcc(r,i,{inverse:!0}),2),c=a[0],l=a[1],s=n+o*u.ni;t[s]=c,e[s]=l}return{lons:t,lats:e}})),u}return wr(e,t),e.prototype.copy=function(t){var n=void 0!==(t=void 0!==t?t:{}).ni?t.ni:this.ni,r=void 0!==t.nj?t.nj:this.nj,o=void 0!==t.ll_x?t.ll_x:this.ll_x,i=void 0!==t.ll_y?t.ll_y:this.ll_y,a=void 0!==t.ur_x?t.ur_x:this.ur_x,c=void 0!==t.ur_y?t.ur_y:this.ur_y;return new e(n,r,this.lon_0,this.lat_0,this.lat_std,o,i,a,c)},e.prototype.getCoords=function(){return this.ll_cache.getValue()},e.prototype.transform=function(t,e,n){var r="inverse"in(n=void 0===n?{}:n)&&n.inverse;return this.lcc(t,e,{inverse:r})},e.prototype.getThinnedGrid=function(t,n){var r=(this.ur_x-this.ll_x)/this.ni,o=(this.ur_y-this.ll_y)/this.nj,i=Math.ceil(this.ni/t),a=Math.ceil(this.nj/n),c=(this.ni-1)%t,l=(this.nj-1)%n,s=this.ll_x,u=this.ll_y,f=this.ur_x-c*r,h=this.ur_y-l*o;return new e(i,a,this.lon_0,this.lat_0,this.lat_std,s,u,f,h)},e}(Sr);function Nr(t){return t.constructor}var Mr=function(){function t(t,e){if(this.grid=t,this.data=e,t.ni*t.nj!=e.length)throw"Data size (".concat(e.length,") doesn't match the grid dimensions (").concat(t.ni," x ").concat(t.nj,"; expected ").concat(t.ni*t.nj," points)")}return t.prototype.getTextureData=function(){return this.data instanceof Float32Array?this.data:new Uint16Array(this.data.buffer)},t.prototype.isFloat16=function(){return!(this.data instanceof Float32Array)},t.prototype.getThinnedField=function(e,n){for(var r=Nr(this.data),o=this.grid.getThinnedGrid(e,n),i=new r(o.ni*o.nj),a=0;a<o.ni;a++)for(var c=0;c<o.nj;c++){var l=a*e+this.grid.ni*c*n;i[a+o.ni*c]=this.data[l]}return new t(o,i)},t.aggregateFields=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];function o(t,e){var n,r,o,i,a,c;return Er(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,7]),n=Rr(t),r=n.next(),l.label=1;case 1:return r.done?[3,4]:(o=r.value,[4,e(o)]);case 2:l.sent(),l.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return i=l.sent(),a={error:i},[3,7];case 6:try{r&&!r.done&&(c=n.return)&&c.call(n)}finally{if(a)throw a.error}return[7];case 7:return[2]}}))}var i=Nr(n[0].data),a=S.apply(void 0,Ar([],Tr(n.map((function(t){return t.data}))),!1)),c=new i(o(a,(function(t){return e.apply(void 0,Ar([],Tr(t),!1))})));return new t(n[0].grid,c)},t}(),Or=function(){function t(t,e,n,r){var o=this;r=void 0===r?{}:r;var i=Nr(e);this.u=new Mr(t,e),this.v=new Mr(t,n),this.relative_to=void 0===r.relative_to?"grid":r.relative_to,this.rotate_cache=new G((function(){for(var t=o.u.grid,e=t.getCoords(),n=new i(e.lats.length),r=new i(e.lats.length),a=0;a<e.lats.length;a++){var c=e.lons[a],l=e.lats[a],s=o.u.data[a],u=o.v.data[a],f=Tr(t.transform(c,l),2),h=f[0],_=f[1],d=Tr(t.transform(c+.01,l),2),p=d[0],b=d[1],v=Math.hypot(h-p,_-b),m=(p-h)/v,g=(b-_)/v,y=void 0,w=void 0;if(t.is_conformal)y=-g,w=m;else{var x=Tr(t.transform(c,l+.01),2),E=x[0],T=x[1],R=Math.hypot(h-E,_-T);y=(E-h)/R,w=(T-_)/R}n[a]=m*s+g*u,r[a]=y*s+w*u}return{u:new Mr(t,n),v:new Mr(t,r)}}))}return t.prototype.getThinnedField=function(e,n){var r=this.u.getThinnedField(e,n),o=this.v.getThinnedField(e,n);return new t(r.grid,r.data,o.data,{relative_to:this.relative_to})},Object.defineProperty(t.prototype,"grid",{get:function(){return this.u.grid},enumerable:!1,configurable:!0}),t.prototype.toEarthRelative=function(){var e,n;if("earth"==this.relative_to)e=this.u,n=this.v;else{var r=this.rotate_cache.getValue();e=r.u,n=r.v}return new t(e.grid,e.data,n.data,{relative_to:"earth"})},t}(),Pr=function(){function t(t,e){this.profiles=e,this.grid=t}return t.prototype.getStormMotionGrid=function(){var t=this,e=new Bn(this.grid.ni*this.grid.nj),n=new Bn(this.grid.ni*this.grid.nj);return this.profiles.forEach((function(r){var o=r.ilon+t.grid.ni*r.jlat;e[o]=r.smu,n[o]=r.smv})),new Or(this.grid,e,n,{relative_to:"grid"})},t}(),Lr={bluered:function(t,e,n){return K.diverging("#0000ff","#ff0000",t,e,n)},redblue:function(t,e,n){return K.diverging("#ff0000","#0000ff",t,e,n)},pw_speed500mb:J,pw_speed850mb:q,pw_cape:Q,pw_t2m:tt,pw_td2m:et,nws_storm_clear_refl:nt}})(),r})()));
//# sourceMappingURL=autumnplot-gl.js.map
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.apgl=t():e.apgl=t()}(this,()=>(()=>{"use strict";const e=Symbol("Comlink.proxy"),t=Symbol("Comlink.endpoint"),r=Symbol("Comlink.releaseProxy"),n=Symbol("Comlink.thrown"),o=e=>"object"==typeof e&&null!==e||"function"==typeof e,s=new Map([["proxy",{canHandle:t=>o(t)&&t[e],serialize(e){const{port1:t,port2:r}=new MessageChannel;return a(e,t),[r,[r]]},deserialize:e=>(e.start(),f(e,[],undefined))}],["throw",{canHandle:e=>o(e)&&n in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function a(t,r=self){r.addEventListener("message",function o(s){if(!s||!s.data)return;const{id:c,type:f,path:u}=Object.assign({path:[]},s.data),p=(s.data.argumentList||[]).map(d);let h;try{const r=u.slice(0,-1).reduce((e,t)=>e[t],t),n=u.reduce((e,t)=>e[t],t);switch(f){case"GET":h=n;break;case"SET":r[u.slice(-1)[0]]=d(s.data.value),h=!0;break;case"APPLY":h=n.apply(r,p);break;case"CONSTRUCT":h=function(t){return Object.assign(t,{[e]:!0})}(new n(...p));break;case"ENDPOINT":{const{port1:e,port2:r}=new MessageChannel;a(t,r),h=function(e,t){return l.set(e,t),e}(e,[e])}break;case"RELEASE":h=void 0;break;default:return}}catch(e){h={value:e,[n]:0}}Promise.resolve(h).catch(e=>({value:e,[n]:0})).then(e=>{const[t,n]=v(e);r.postMessage(Object.assign(Object.assign({},t),{id:c}),n),"RELEASE"===f&&(r.removeEventListener("message",o),i(r))})}),r.start&&r.start()}function i(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function c(e){if(e)throw new Error("Proxy has been released and is not useable")}function f(e,n=[],o=function(){}){let s=!1;const a=new Proxy(o,{get(t,o){if(c(s),o===r)return()=>p(e,{type:"RELEASE",path:n.map(e=>e.toString())}).then(()=>{i(e),s=!0});if("then"===o){if(0===n.length)return{then:()=>a};const t=p(e,{type:"GET",path:n.map(e=>e.toString())}).then(d);return t.then.bind(t)}return f(e,[...n,o])},set(t,r,o){c(s);const[a,i]=v(o);return p(e,{type:"SET",path:[...n,r].map(e=>e.toString()),value:a},i).then(d)},apply(r,o,a){c(s);const i=n[n.length-1];if(i===t)return p(e,{type:"ENDPOINT"}).then(d);if("bind"===i)return f(e,n.slice(0,-1));const[l,v]=u(a);return p(e,{type:"APPLY",path:n.map(e=>e.toString()),argumentList:l},v).then(d)},construct(t,r){c(s);const[o,a]=u(r);return p(e,{type:"CONSTRUCT",path:n.map(e=>e.toString()),argumentList:o},a).then(d)}});return a}function u(e){const t=e.map(v);return[t.map(e=>e[0]),(r=t.map(e=>e[1]),Array.prototype.concat.apply([],r))];var r}const l=new WeakMap;function v(e){for(const[t,r]of s)if(r.canHandle(e)){const[n,o]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},o]}return[{type:"RAW",value:e},l.get(e)||[]]}function d(e){switch(e.type){case"HANDLER":return s.get(e.name).deserialize(e.value);case"RAW":return e.value}}function p(e,t,r){return new Promise(n=>{const o=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");e.addEventListener("message",function t(r){r.data&&r.data.id&&r.data.id===o&&(e.removeEventListener("message",t),n(r.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:o},t),r)})}var h=function(){function e(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: (".concat(e,", ").concat(t,")"));if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return e.prototype.toMercatorCoord=function(){return{x:(n=this.lng,(180+n)/360),y:(e=this.lat,t=Math.sin(e*Math.PI/180),r=(180-90/Math.PI*Math.log((1+t)/(1-t)))/360,Math.min(1.5,Math.max(-.5,r)))};var e,t,r,n},e.fromMercatorCoord=function(t,r){return new e(function(e){return 360*e-180}(t),function(e){return 180*Math.atan(Math.sinh((180-360*e)*Math.PI/180))/Math.PI}(r))},e}(),m=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(o)throw o.error}}return a};return a({makeBBElements:function(e,t,r,n,o,s){for(var a=r.filter(function(e){return e<=s}).length,i=2*a,c=new Float32Array(2*a),f=new Float32Array(i),u=0,l=0,v=0;v<o;v++)for(var d=0;d<n;d++){var p=v*n+d,m=e[p],y=t[p],g=r[p];if(!(g>s||void 0===y||void 0===m)){var x=new h(y,m).toMercatorCoord();c[u+0]=x.x,c[u+1]=x.y,f[l+0]=Math.min(d/(n-1),.99999)+g,f[l+1]=v/(o-1),u+=2,l+=2}}return{pts:c,tex_coords:f}},makeDomainVerticesAndTexCoords:function(e,t,r,n,o,s){for(var a=new Float32Array(4*(r-1)*(n+1)).fill(0),i=new Float32Array(4*(r-1)*(n+1)).fill(0),c=0,f=0,u=0;u<r-1;u++)for(var l=0;l<n;l++){var v=u+l*r,d=new h(t[v],e[v]).toMercatorCoord(),p=new h(t[v+1],e[v+1]).toMercatorCoord(),m=u/(r-1)*(1-2*o)+o,y=(u+1)/(r-1)*(1-2*o)+o,g=l/(n-1)*(1-2*s)+s;0==l&&(a[c]=d.x,a[c+1]=d.y,c+=2,i[f]=m,i[f+1]=g,f+=2),a[c]=d.x,a[c+1]=d.y,a[c+2]=p.x,a[c+3]=p.y,c+=4,i[f]=m,i[f+1]=g,i[f+2]=y,i[f+3]=g,f+=4,l==n-1&&(a[c]=p.x,a[c+1]=p.y,c+=2,i[f]=y,i[f+1]=g,f+=2)}return{vertices:a,tex_coords:i}},makePolyLines:function(e){if(0==e.length||0==e[0].vertices.length)return{vertices:new Float32Array([]),extrusion:new Float32Array([])};var t=Object.fromEntries(Object.entries(e[0]).map(function(e){var t=m(e,2),r=t[0],n=t[1];return[r,"number"==typeof n||"number"==typeof n[0]?1:n[0].length]}));t.extrusion=2,t.vertices+=1;var r=4*e.map(function(e){return e.vertices.length}).reduce(function(e,t){return e+t})-2*e.length,n=Object.fromEntries(Object.entries(t).map(function(e){var t=m(e,2),n=t[0],o=t[1];return[n,r*o]})),o={vertices:new Float32Array(n.vertices),extrusion:new Float32Array(n.extrusion)};"offsets"in e[0]&&(o.offsets=new Float32Array(n.offsets)),"data"in e[0]&&(o.data=new Float32Array(n.data)),"zoom"in e[0]&&(o.zoom=new Float32Array(n.zoom));var s=Object.fromEntries(Object.keys(n).map(function(e){return[e,0]})),a=function(e,t,r){var n=t[0]-e[0],o=t[1]-e[1],s=Math.hypot(n,o),a=-n/s;return[o/s,r?-a:a]};return e.forEach(function(e){var t,r=e.vertices.map(function(e){var t=(new(h.bind.apply(h,function(e,t,r){if(r||2===arguments.length)for(var n,o=0,s=t.length;o<s;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}([void 0],m(e),!1)))).toMercatorCoord();return[t.x,t.y]});if(0!=e.vertices.length){var n,i,c,f=void 0!==e.offsets,u=void 0!==e.offsets?e.offsets:r,l=r[0],v=(r[1],u[0]),d=u[1],p=1e-4,y=m(a(v,d,!f),2),g=y[0],x=y[1];o.vertices[s.vertices++]=l[0],o.vertices[s.vertices++]=l[1],o.vertices[s.vertices++]=p,o.extrusion[s.extrusion++]=g,o.extrusion[s.extrusion++]=x;for(var b=1;b<r.length;b++)l=r[b],n=r[b-1],v=u[b],i=u[b-1],g=(t=m(a(i,v,!f),2))[0],x=t[1],c=p,p+=Math.hypot(r[b-1][0]-r[b][0],r[b-1][1]-r[b][1]),o.vertices[s.vertices++]=n[0],o.vertices[s.vertices++]=n[1],o.vertices[s.vertices++]=-c,o.vertices[s.vertices++]=n[0],o.vertices[s.vertices++]=n[1],o.vertices[s.vertices++]=c,o.vertices[s.vertices++]=l[0],o.vertices[s.vertices++]=l[1],o.vertices[s.vertices++]=-p,o.vertices[s.vertices++]=l[0],o.vertices[s.vertices++]=l[1],o.vertices[s.vertices++]=p,o.extrusion[s.extrusion++]=g,o.extrusion[s.extrusion++]=x,o.extrusion[s.extrusion++]=-g,o.extrusion[s.extrusion++]=-x,o.extrusion[s.extrusion++]=g,o.extrusion[s.extrusion++]=x,o.extrusion[s.extrusion++]=-g,o.extrusion[s.extrusion++]=-x;if(o.vertices[s.vertices++]=l[0],o.vertices[s.vertices++]=l[1],o.vertices[s.vertices++]=p,o.extrusion[s.extrusion++]=-g,o.extrusion[s.extrusion++]=-x,void 0!==o.offsets&&void 0!==e.offsets){var w=e.offsets,E=void 0,M=w[0];for(o.offsets[s.offsets++]=M[0],o.offsets[s.offsets++]=M[1],b=1;b<w.length;b++)M=w[b],E=w[b-1],o.offsets[s.offsets++]=E[0],o.offsets[s.offsets++]=E[1],o.offsets[s.offsets++]=E[0],o.offsets[s.offsets++]=E[1],o.offsets[s.offsets++]=M[0],o.offsets[s.offsets++]=M[1],o.offsets[s.offsets++]=M[0],o.offsets[s.offsets++]=M[1];o.offsets[s.offsets++]=M[0],o.offsets[s.offsets++]=M[1]}if(void 0!==o.data&&void 0!==e.data){var A=e.data,S=void 0,L=A[0];for(o.data[s.data++]=L,b=1;b<A.length;b++)L=A[b],S=A[b-1],o.data[s.data++]=S,o.data[s.data++]=S,o.data[s.data++]=L,o.data[s.data++]=L;o.data[s.data++]=L}if(void 0!==o.zoom&&void 0!==e.zoom)for(b=0;b<4*r.length-2;b++)o.zoom[s.zoom++]=e.zoom}}),o}}),{}})());
//# sourceMappingURL=983.autumnplot-gl.js.map